<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;base&nbsp;href=&quot;http://fiji.sc/bugzilla/&quot;&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;&lt;a&nbsp;class=&quot;bz_bug_link&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bz_status_NEW&nbsp;&quot;<br>
&nbsp;&nbsp;&nbsp;title=&quot;NEW&nbsp;-&nbsp;Mac&nbsp;OS&nbsp;out&nbsp;of&nbsp;memory&quot;<br>
&nbsp;&nbsp;&nbsp;href=&quot;http://fiji.sc/bugzilla/show_bug.cgi?id=990#c3&quot;&gt;Comment&nbsp;#&nbsp;3&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;&lt;a&nbsp;class=&quot;bz_bug_link&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bz_status_NEW&nbsp;&quot;<br>
&nbsp;&nbsp;&nbsp;title=&quot;NEW&nbsp;-&nbsp;Mac&nbsp;OS&nbsp;out&nbsp;of&nbsp;memory&quot;<br>
&nbsp;&nbsp;&nbsp;href=&quot;http://fiji.sc/bugzilla/show_bug.cgi?id=990&quot;&gt;bug&nbsp;990&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;&lt;span&nbsp;class=&quot;vcard&quot;&gt;&lt;a&nbsp;class=&quot;email&quot;&nbsp;href=&quot;mailto:wsr&#64;nih.gov&quot;&nbsp;title=&quot;Wayne&nbsp;Rasband&nbsp;&lt;wsr&#64;nih.gov&gt;&quot;&gt;&nbsp;&lt;span&nbsp;class=&quot;fn&quot;&gt;Wayne&nbsp;Rasband&lt;/span&gt;&lt;/a&gt;<br>
&lt;/span&gt;&lt;/b&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&gt;Hi&nbsp;Glen,<br>
<br>
I&nbsp;am&nbsp;not&nbsp;able&nbsp;to&nbsp;consistently&nbsp;reproduce&nbsp;this&nbsp;problem.&nbsp;Yesterday,&nbsp;when&nbsp;testing<br>
your&nbsp;macro,&nbsp;I&nbsp;noticed&nbsp;that&nbsp;sometimes&nbsp;not&nbsp;all&nbsp;memory&nbsp;was&nbsp;reclaimed&nbsp;after&nbsp;the<br>
macro&nbsp;finished&nbsp;and&nbsp;I&nbsp;ran&nbsp;the&nbsp;garbage&nbsp;collector&nbsp;by&nbsp;clicking&nbsp;on&nbsp;the&nbsp;status&nbsp;bar&nbsp;or<br>
&quot;Memory&quot;&nbsp;window.&nbsp;Today,&nbsp;however,&nbsp;the&nbsp;memory&nbsp;is&nbsp;always&nbsp;reclaimed&nbsp;after&nbsp;running<br>
the&nbsp;macro&nbsp;and&nbsp;clicking&nbsp;in&nbsp;the&nbsp;&quot;Memory&quot;&nbsp;window.<br>
<br>
The&nbsp;following&nbsp;version&nbsp;of&nbsp;your&nbsp;macro&nbsp;displays&nbsp;the&nbsp;&quot;Memory&quot;&nbsp;window&nbsp;and&nbsp;creates&nbsp;10<br>
montages.&nbsp;The&nbsp;&quot;Make&nbsp;Montage&quot;&nbsp;macro&nbsp;is&nbsp;first&nbsp;so&nbsp;you&nbsp;can&nbsp;run&nbsp;it&nbsp;by&nbsp;clicking&nbsp;on<br>
&quot;Run&quot;&nbsp;in&nbsp;Fiji's&nbsp;script&nbsp;editor.&nbsp;Watch&nbsp;the&nbsp;&quot;Memory&quot;&nbsp;window&nbsp;as&nbsp;the&nbsp;macro&nbsp;runs&nbsp;and<br>
you&nbsp;will&nbsp;see&nbsp;that&nbsp;memory&nbsp;is&nbsp;reclaimed&nbsp;as&nbsp;needed&nbsp;or&nbsp;you&nbsp;click&nbsp;in&nbsp;the&nbsp;&quot;Memory&quot;<br>
window.&nbsp;This&nbsp;version&nbsp;of&nbsp;the&nbsp;macro&nbsp;also&nbsp;fixes&nbsp;a&nbsp;few&nbsp;problems&nbsp;with&nbsp;passing<br>
variables&nbsp;and&nbsp;it&nbsp;removes&nbsp;the&nbsp;'grayopt'&nbsp;string,&nbsp;which&nbsp;was&nbsp;not&nbsp;seen&nbsp;by&nbsp;the&nbsp;Insert<br>
command&nbsp;because&nbsp;it&nbsp;was&nbsp;not&nbsp;passed&nbsp;correctly.<br>
<br>
<br>
&nbsp;&nbsp;macro&nbsp;&quot;Make&nbsp;Montage&nbsp;[1]&quot;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dir=getDirectory(&quot;Source&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;=&nbsp;10;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list=getFileList(dir);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i=0;&nbsp;i&lt;n;&nbsp;i++)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;montage&nbsp;=&nbsp;&quot;Montage-&quot;+(i+1)+&quot;/&quot;+n;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newImage(montage,&nbsp;&quot;16-bit&nbsp;composite-mode&quot;,&nbsp;2048,2048,3,100,1);&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doCommand(&quot;Monitor&nbsp;Memory...&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x=0;&nbsp;y=0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(f=0;&nbsp;f&lt;list.length;&nbsp;f++)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fpath=dir+list[f];<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//open(fpath);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;run(&quot;Bio-Formats&nbsp;Windowless&nbsp;Importer&quot;,&nbsp;&quot;open=&amp;fpath&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rename(&quot;Source&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;run(&quot;Insert...&quot;,&nbsp;&quot;source=Source&nbsp;destination=&amp;montage&nbsp;x=&amp;x&nbsp;y=&amp;y&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;+=&nbsp;1024;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(x==2048)&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;+=&nbsp;1024;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;macro&nbsp;&quot;Make&nbsp;Stacks&nbsp;[2]&quot;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target=getDirectory(&quot;Choose&nbsp;Directory&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;newImage(&quot;HyperStack&quot;,&nbsp;&quot;16-bit&nbsp;ramp&quot;,&nbsp;1024,&nbsp;1024,&nbsp;3,100,1);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(s=0;s&lt;4;s++)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saveAs(&quot;Tiff&quot;,target+&quot;Stack000&quot;+s);<br>
&nbsp;&nbsp;}&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;hr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&gt;You&nbsp;are&nbsp;receiving&nbsp;this&nbsp;mail&nbsp;because:&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;You&nbsp;are&nbsp;the&nbsp;assignee&nbsp;for&nbsp;the&nbsp;bug.&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
