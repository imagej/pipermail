<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;base&nbsp;href=&quot;http://fiji.sc/bugzilla/&quot;&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;&lt;span&nbsp;class=&quot;vcard&quot;&gt;&lt;a&nbsp;class=&quot;email&quot;&nbsp;href=&quot;mailto:ctrueden&#64;wisc.edu&quot;&nbsp;title=&quot;Curtis&nbsp;Rueden&nbsp;&lt;ctrueden&#64;wisc.edu&gt;&quot;&gt;&nbsp;&lt;span&nbsp;class=&quot;fn&quot;&gt;Curtis&nbsp;Rueden&lt;/span&gt;&lt;/a&gt;<br>
&lt;/span&gt;&nbsp;changed<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;bz_bug_link&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bz_status_RESOLVED&nbsp;&nbsp;bz_closed&quot;<br>
&nbsp;&nbsp;&nbsp;title=&quot;RESOLVED&nbsp;WONTFIX&nbsp;-&nbsp;Multithreading&nbsp;problem&nbsp;in&nbsp;javascript&nbsp;macro&quot;<br>
&nbsp;&nbsp;&nbsp;href=&quot;http://fiji.sc/bugzilla/show_bug.cgi?id=854&quot;&gt;bug&nbsp;854&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&nbsp;border=&quot;1&quot;&nbsp;cellspacing=&quot;0&quot;&nbsp;cellpadding=&quot;8&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;What&lt;/th&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Removed&lt;/th&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Added&lt;/th&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;style=&quot;text-align:right;&quot;&gt;Status&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;NEEDSINFO<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;RESOLVED<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;style=&quot;text-align:right;&quot;&gt;CC&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;ctrueden&#64;wisc.edu<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;style=&quot;text-align:right;&quot;&gt;Resolution&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;---<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;WONTFIX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;&lt;/table&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;&lt;a&nbsp;class=&quot;bz_bug_link&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bz_status_RESOLVED&nbsp;&nbsp;bz_closed&quot;<br>
&nbsp;&nbsp;&nbsp;title=&quot;RESOLVED&nbsp;WONTFIX&nbsp;-&nbsp;Multithreading&nbsp;problem&nbsp;in&nbsp;javascript&nbsp;macro&quot;<br>
&nbsp;&nbsp;&nbsp;href=&quot;http://fiji.sc/bugzilla/show_bug.cgi?id=854#c5&quot;&gt;Comment&nbsp;#&nbsp;5&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;&lt;a&nbsp;class=&quot;bz_bug_link&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bz_status_RESOLVED&nbsp;&nbsp;bz_closed&quot;<br>
&nbsp;&nbsp;&nbsp;title=&quot;RESOLVED&nbsp;WONTFIX&nbsp;-&nbsp;Multithreading&nbsp;problem&nbsp;in&nbsp;javascript&nbsp;macro&quot;<br>
&nbsp;&nbsp;&nbsp;href=&quot;http://fiji.sc/bugzilla/show_bug.cgi?id=854&quot;&gt;bug&nbsp;854&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;&lt;span&nbsp;class=&quot;vcard&quot;&gt;&lt;a&nbsp;class=&quot;email&quot;&nbsp;href=&quot;mailto:ctrueden&#64;wisc.edu&quot;&nbsp;title=&quot;Curtis&nbsp;Rueden&nbsp;&lt;ctrueden&#64;wisc.edu&gt;&quot;&gt;&nbsp;&lt;span&nbsp;class=&quot;fn&quot;&gt;Curtis&nbsp;Rueden&lt;/span&gt;&lt;/a&gt;<br>
&lt;/span&gt;&lt;/b&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&gt;I&nbsp;downloaded&nbsp;your&nbsp;script&nbsp;and&nbsp;your&nbsp;TIFF,&nbsp;and&nbsp;was&nbsp;able&nbsp;to&nbsp;reproduce&nbsp;the&nbsp;problem<br>
on&nbsp;my&nbsp;OS&nbsp;X&nbsp;machine.&nbsp;Impressive&nbsp;script,&nbsp;Thomas!<br>
<br>
Unfortunately,&nbsp;debugging&nbsp;concurrency&nbsp;issues&nbsp;is&nbsp;one&nbsp;of&nbsp;the&nbsp;more&nbsp;difficult&nbsp;and<br>
time&nbsp;consuming&nbsp;programming&nbsp;tasks.&nbsp;And&nbsp;ImageJ&nbsp;1.x&nbsp;is&nbsp;rife&nbsp;with&nbsp;concurrency<br>
problems&nbsp;lurking&nbsp;under&nbsp;the&nbsp;hood,&nbsp;which&nbsp;most&nbsp;people&nbsp;rarely&nbsp;encounter,&nbsp;but&nbsp;which<br>
advanced&nbsp;script&nbsp;writers&nbsp;such&nbsp;as&nbsp;yourself&nbsp;sometimes&nbsp;bump&nbsp;into.<br>
<br>
I&nbsp;really&nbsp;appreciate&nbsp;that&nbsp;you&nbsp;would&nbsp;love&nbsp;some&nbsp;help&nbsp;debugging&nbsp;your&nbsp;code,&nbsp;but<br>
given&nbsp;the&nbsp;complexity&nbsp;of&nbsp;the&nbsp;script,&nbsp;in&nbsp;this&nbsp;case&nbsp;I&nbsp;think&nbsp;there&nbsp;is&nbsp;no&nbsp;option&nbsp;but<br>
for&nbsp;you,&nbsp;or&nbsp;someone&nbsp;else&nbsp;in&nbsp;your&nbsp;group,&nbsp;to&nbsp;dig&nbsp;in&nbsp;more&nbsp;deeply&nbsp;and&nbsp;identify&nbsp;the<br>
root&nbsp;cause&nbsp;of&nbsp;the&nbsp;issue.&nbsp;Ultimately,&nbsp;you&nbsp;have&nbsp;a&nbsp;large&nbsp;function&nbsp;being&nbsp;called&nbsp;by<br>
many&nbsp;threads&nbsp;at&nbsp;once&nbsp;into&nbsp;IJ1&nbsp;data&nbsp;structures&nbsp;which&nbsp;are&nbsp;probably&nbsp;not<br>
thread-safe,&nbsp;so&nbsp;some&nbsp;synchronized&nbsp;blocks&nbsp;may&nbsp;be&nbsp;in&nbsp;order&nbsp;(and&nbsp;I'm&nbsp;not&nbsp;sure&nbsp;how<br>
you&nbsp;do&nbsp;that&nbsp;in&nbsp;JavaScript).<br>
<br>
Two&nbsp;parting&nbsp;suggestions:<br>
<br>
1)&nbsp;You&nbsp;could&nbsp;recast&nbsp;your&nbsp;code&nbsp;as&nbsp;a&nbsp;Java&nbsp;plugin&nbsp;and&nbsp;use&nbsp;an&nbsp;IDE&nbsp;with&nbsp;a&nbsp;dedicated<br>
debugger,&nbsp;memory&nbsp;profiler,&nbsp;and&nbsp;many&nbsp;other&nbsp;goodies.&nbsp;Debugging&nbsp;concurrency&nbsp;issues<br>
from&nbsp;Eclipse&nbsp;(by&nbsp;attaching&nbsp;to&nbsp;a&nbsp;running&nbsp;Fiji&nbsp;as&nbsp;a&nbsp;remote&nbsp;debugger;&nbsp;see<br>
&lt;a&nbsp;href=&quot;http://fiji.sc/Debugging_intro#Attaching_to_ImageJ_instances&quot;&gt;http://fiji.sc/Debugging_intro#Attaching_to_ImageJ_instances&lt;/a&gt;)&nbsp;will&nbsp;be&nbsp;easier<br>
than&nbsp;debugging&nbsp;things&nbsp;from&nbsp;the&nbsp;ImageJ&nbsp;Script&nbsp;Editor&nbsp;in&nbsp;JavaScript&nbsp;with&nbsp;no&nbsp;such<br>
tools.<br>
<br>
2)&nbsp;You&nbsp;could&nbsp;post&nbsp;a&nbsp;Minimal,&nbsp;Complete&nbsp;and&nbsp;Verifiable&nbsp;example&nbsp;on&nbsp;StackOverflow<br>
(&lt;a&nbsp;href=&quot;http://stackoverflow.com/help/mcve&quot;&gt;http://stackoverflow.com/help/mcve&lt;/a&gt;)&nbsp;and&nbsp;hope&nbsp;that&nbsp;someone&nbsp;from&nbsp;the&nbsp;larger<br>
community&nbsp;of&nbsp;developers&nbsp;there&nbsp;has&nbsp;additional&nbsp;suggestions&nbsp;or&nbsp;insight.<br>
<br>
I&nbsp;wish&nbsp;you&nbsp;the&nbsp;best&nbsp;of&nbsp;luck&nbsp;with&nbsp;it.&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;hr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&gt;You&nbsp;are&nbsp;receiving&nbsp;this&nbsp;mail&nbsp;because:&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;You&nbsp;are&nbsp;the&nbsp;assignee&nbsp;for&nbsp;the&nbsp;bug.&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
