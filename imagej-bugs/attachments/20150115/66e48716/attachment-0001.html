<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;base&nbsp;href=&quot;http://fiji.sc/bugzilla/&quot;&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;&lt;a&nbsp;class=&quot;bz_bug_link&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bz_status_NEW&nbsp;&quot;<br>
&nbsp;&nbsp;&nbsp;title=&quot;NEW&nbsp;-&nbsp;saveAs(&quot;Results&quot;,&nbsp;&quot;...&quot;)&nbsp;does&nbsp;not&nbsp;work&quot;<br>
&nbsp;&nbsp;&nbsp;href=&quot;http://fiji.sc/bugzilla/show_bug.cgi?id=987#c4&quot;&gt;Comment&nbsp;#&nbsp;4&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;&lt;a&nbsp;class=&quot;bz_bug_link&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bz_status_NEW&nbsp;&quot;<br>
&nbsp;&nbsp;&nbsp;title=&quot;NEW&nbsp;-&nbsp;saveAs(&quot;Results&quot;,&nbsp;&quot;...&quot;)&nbsp;does&nbsp;not&nbsp;work&quot;<br>
&nbsp;&nbsp;&nbsp;href=&quot;http://fiji.sc/bugzilla/show_bug.cgi?id=987&quot;&gt;bug&nbsp;987&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;&lt;span&nbsp;class=&quot;vcard&quot;&gt;&lt;a&nbsp;class=&quot;email&quot;&nbsp;href=&quot;mailto:tokamoto&#64;biosearchtech.com&quot;&nbsp;title=&quot;tokamoto&#64;biosearchtech.com&quot;&gt;tokamoto&#64;biosearchtech.com&lt;/a&gt;<br>
&lt;/span&gt;&lt;/b&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&gt;I've&nbsp;re-created&nbsp;the&nbsp;issue&nbsp;in&nbsp;a&nbsp;macro&nbsp;that&nbsp;emulates&nbsp;my&nbsp;macro,&nbsp;and&nbsp;the&nbsp;steps&nbsp;that<br>
it&nbsp;takes&nbsp;through&nbsp;functions&nbsp;and&nbsp;saving&nbsp;to&nbsp;the&nbsp;tables.&nbsp;&nbsp;<br>
<br>
In&nbsp;my&nbsp;macro,&nbsp;I'm&nbsp;running&nbsp;the&nbsp;Measure&nbsp;tool&nbsp;on&nbsp;three&nbsp;separate&nbsp;selections&nbsp;on&nbsp;an<br>
image&nbsp;(emulated&nbsp;here&nbsp;by&nbsp;creating&nbsp;some&nbsp;random&nbsp;data)&nbsp;and&nbsp;then&nbsp;doing&nbsp;some<br>
calculations&nbsp;based&nbsp;on&nbsp;the&nbsp;results&nbsp;(emulated&nbsp;here&nbsp;by&nbsp;calculating&nbsp;the&nbsp;ratio&nbsp;and<br>
half&nbsp;ratio).&nbsp;&nbsp;The&nbsp;results&nbsp;are&nbsp;saved&nbsp;on&nbsp;the&nbsp;first&nbsp;row&nbsp;in&nbsp;their&nbsp;own&nbsp;column,&nbsp;and<br>
then&nbsp;all&nbsp;three&nbsp;rows&nbsp;are&nbsp;printed&nbsp;to&nbsp;the&nbsp;Points&nbsp;table,&nbsp;replacing&nbsp;the&nbsp;space<br>
between&nbsp;data&nbsp;with&nbsp;commas.&nbsp;&nbsp;Since&nbsp;I&nbsp;still&nbsp;have&nbsp;the&nbsp;ratios&nbsp;stored&nbsp;in&nbsp;variables,&nbsp;I<br>
print&nbsp;just&nbsp;the&nbsp;results&nbsp;to&nbsp;another&nbsp;table&nbsp;that&nbsp;excludes&nbsp;the&nbsp;raw&nbsp;measure&nbsp;data&nbsp;from<br>
earlier.&nbsp;&nbsp;After&nbsp;it&nbsp;runs&nbsp;on&nbsp;all&nbsp;images&nbsp;in&nbsp;a&nbsp;directory(emulated&nbsp;here&nbsp;by&nbsp;just<br>
running&nbsp;it&nbsp;ten&nbsp;times)&nbsp;it&nbsp;selects&nbsp;the&nbsp;tables,&nbsp;saves&nbsp;them,&nbsp;and&nbsp;then&nbsp;closes&nbsp;them.<br>
<br>
The&nbsp;macro&nbsp;below&nbsp;works&nbsp;on&nbsp;1.49m,&nbsp;but&nbsp;not&nbsp;1.49n.&nbsp;&nbsp;If&nbsp;you&nbsp;comment&nbsp;out&nbsp;the&nbsp;close<br>
commands&nbsp;after&nbsp;the&nbsp;saveAs&nbsp;commands,&nbsp;you&nbsp;can&nbsp;see&nbsp;the&nbsp;tables&nbsp;have&nbsp;data&nbsp;in&nbsp;them.<br>
<br>
setBatchMode(true);<br>
setOption(&quot;ShowRowNumbers&quot;,&nbsp;false);<br>
requires(&quot;1.49m&quot;);<br>
run(&quot;Set&nbsp;Measurements...&quot;,&nbsp;&quot;area&nbsp;mean&nbsp;standard&nbsp;min&nbsp;median&nbsp;redirect=None<br>
decimal=3&quot;);<br>
run(&quot;Input/Output...&quot;,&nbsp;&quot;jpeg=85&nbsp;gif=-1&nbsp;file=.csv&nbsp;save_column&quot;);<br>
print(&quot;\\Clear&quot;);<br>
run(&quot;Clear&nbsp;Results&quot;);<br>
ratiovalue&nbsp;=&nbsp;0;<br>
half&nbsp;=&nbsp;0;<br>
<br>
//Initialize&nbsp;Tables<br>
run(&quot;Table...&quot;,&nbsp;&quot;name=Points&nbsp;width=400&nbsp;height=200&quot;);<br>
run(&quot;Table...&quot;,&nbsp;&quot;name=Condensed&nbsp;width=400&nbsp;height=200&quot;);<br>
print(&quot;[Points]&quot;,&nbsp;&quot;Double,&nbsp;Value,&nbsp;Ratio,&nbsp;Ratio2&quot;);<br>
print(&quot;[Condensed]&quot;,&nbsp;&quot;Number,&nbsp;Ratio,&nbsp;Ratio2&quot;);<br>
<br>
//Run&nbsp;main&nbsp;function<br>
testfunction();<br>
<br>
updateResults;<br>
//Save&nbsp;Tables<br>
selectWindow(&quot;Points&quot;);<br>
saveAs(&quot;Results&quot;,&nbsp;&quot;C:\\Users\\tokamoto\\Desktop\\Results_Points.csv&quot;);<br>
run(&quot;Close&quot;);<br>
selectWindow(&quot;Condensed&quot;);<br>
saveAs(&quot;Results&quot;,&nbsp;&quot;C:\\Users\\tokamoto\\Desktop\\Results_Condensed.csv&quot;);<br>
run(&quot;Close&quot;);<br>
<br>
function&nbsp;testfunction()&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;10;&nbsp;i++)&nbsp;{&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(n&nbsp;=&nbsp;0;&nbsp;n&nbsp;&lt;&nbsp;3;&nbsp;n++)&nbsp;{&nbsp;//Create&nbsp;three&nbsp;sets&nbsp;of&nbsp;random&nbsp;data<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setResult(&quot;Double&quot;,&nbsp;n,&nbsp;(n+1)*2);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;setResult(&quot;Value&quot;,&nbsp;n,&nbsp;random&nbsp;*&nbsp;10);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;updateResults();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//Run&nbsp;the&nbsp;ratio&nbsp;function&nbsp;which&nbsp;separates&nbsp;the&nbsp;data&nbsp;and&nbsp;condenses&nbsp;it&nbsp;into<br>
the&nbsp;two&nbsp;tables<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ratio();<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
<br>
function&nbsp;ratio()&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;//Calculate&nbsp;ratio<br>
&nbsp;&nbsp;&nbsp;&nbsp;ratiovalue&nbsp;=&nbsp;getResult(&quot;Double&quot;,&nbsp;nResults&nbsp;-&nbsp;3)&nbsp;/&nbsp;getResult(&quot;Value&quot;,<br>
nResults&nbsp;-&nbsp;3);<br>
&nbsp;&nbsp;&nbsp;&nbsp;half&nbsp;=&nbsp;ratiovalue&nbsp;/&nbsp;2;<br>
&nbsp;&nbsp;&nbsp;&nbsp;//Set&nbsp;Results<br>
&nbsp;&nbsp;&nbsp;&nbsp;setResult(&quot;Ratio&quot;,&nbsp;0,&nbsp;ratiovalue);<br>
&nbsp;&nbsp;&nbsp;&nbsp;setResult(&quot;Ratio2&quot;,&nbsp;0,&nbsp;half);<br>
&nbsp;&nbsp;&nbsp;&nbsp;updateResults();<br>
&nbsp;&nbsp;&nbsp;&nbsp;//String&nbsp;manipulation&nbsp;and&nbsp;writing&nbsp;to&nbsp;table<br>
&nbsp;&nbsp;&nbsp;&nbsp;String.resetBuffer;<br>
&nbsp;&nbsp;&nbsp;&nbsp;String.copyResults;<br>
&nbsp;&nbsp;&nbsp;&nbsp;String.append(String.paste);<br>
&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;[Points]&quot;,&nbsp;replace(String.buffer,&nbsp;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&quot;,&nbsp;&quot;,&nbsp;&quot;));<br>
&nbsp;&nbsp;&nbsp;&nbsp;run(&quot;Clear&nbsp;Results&quot;);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;//Save&nbsp;Condensed&nbsp;results&nbsp;(Just&nbsp;the&nbsp;ratio)<br>
&nbsp;&nbsp;&nbsp;&nbsp;setResult(&quot;Number&quot;,&nbsp;nResults,&nbsp;i);<br>
&nbsp;&nbsp;&nbsp;&nbsp;setResult(&quot;Ratio&quot;,&nbsp;0,&nbsp;ratiovalue);<br>
&nbsp;&nbsp;&nbsp;&nbsp;setResult(&quot;Ratio2&quot;,&nbsp;0,&nbsp;half);<br>
&nbsp;&nbsp;&nbsp;&nbsp;updateResults();<br>
&nbsp;&nbsp;&nbsp;&nbsp;String.resetBuffer;<br>
&nbsp;&nbsp;&nbsp;&nbsp;String.copyResults;<br>
&nbsp;&nbsp;&nbsp;&nbsp;String.append(String.paste);<br>
&nbsp;&nbsp;&nbsp;&nbsp;print(&quot;[Condensed]&quot;,&nbsp;replace(String.buffer,&nbsp;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&quot;,&nbsp;&quot;,&nbsp;&quot;));<br>
&nbsp;&nbsp;&nbsp;&nbsp;run(&quot;Clear&nbsp;Results&quot;);<br>
}&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;hr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&gt;You&nbsp;are&nbsp;receiving&nbsp;this&nbsp;mail&nbsp;because:&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;You&nbsp;are&nbsp;the&nbsp;assignee&nbsp;for&nbsp;the&nbsp;bug.&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
