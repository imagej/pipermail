<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;base&nbsp;href=&quot;http://fiji.sc/bugzilla/&quot;&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;&lt;a&nbsp;class=&quot;bz_bug_link&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bz_status_NEEDSINFO&nbsp;&quot;<br>
&nbsp;&nbsp;&nbsp;title=&quot;NEEDSINFO&nbsp;-&nbsp;memory&nbsp;leak&nbsp;with&nbsp;python&nbsp;script&quot;<br>
&nbsp;&nbsp;&nbsp;href=&quot;http://fiji.sc/bugzilla/show_bug.cgi?id=1203#c3&quot;&gt;Comment&nbsp;#&nbsp;3&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;&lt;a&nbsp;class=&quot;bz_bug_link&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bz_status_NEEDSINFO&nbsp;&quot;<br>
&nbsp;&nbsp;&nbsp;title=&quot;NEEDSINFO&nbsp;-&nbsp;memory&nbsp;leak&nbsp;with&nbsp;python&nbsp;script&quot;<br>
&nbsp;&nbsp;&nbsp;href=&quot;http://fiji.sc/bugzilla/show_bug.cgi?id=1203&quot;&gt;bug&nbsp;1203&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;&lt;span&nbsp;class=&quot;vcard&quot;&gt;&lt;a&nbsp;class=&quot;email&quot;&nbsp;href=&quot;mailto:aryeh&#64;cc.huji.ac.il&quot;&nbsp;title=&quot;Aryeh&nbsp;Weiss&nbsp;&lt;aryeh&#64;cc.huji.ac.il&gt;&quot;&gt;&nbsp;&lt;span&nbsp;class=&quot;fn&quot;&gt;Aryeh&nbsp;Weiss&lt;/span&gt;&lt;/a&gt;<br>
&lt;/span&gt;&lt;/b&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&gt;Concerning&nbsp;the&nbsp;python.jar:<br>
This&nbsp;was&nbsp;added&nbsp;whenI&nbsp;needed&nbsp;to&nbsp;evaluate&nbsp;a&nbsp;python&nbsp;script&nbsp;from&nbsp;a&nbsp;plugin&nbsp;-&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;eval(&quot;python&quot;,&nbsp;script);<br>
When&nbsp;I&nbsp;did&nbsp;this,&nbsp;it&nbsp;prompted&nbsp;me&nbsp;that&nbsp;I&nbsp;to&nbsp;install&nbsp;Jython.jar,&nbsp;and&nbsp;it&nbsp;even&nbsp;was<br>
kind&nbsp;enough&nbsp;to&nbsp;do&nbsp;it&nbsp;for&nbsp;me.<br>
<br>
Motivated&nbsp;by&nbsp;Mark's&nbsp;comment,&nbsp;I&nbsp;renamed&nbsp;that&nbsp;jython&nbsp;to&nbsp;python.old,&nbsp;and&nbsp;copied<br>
the&nbsp;Jython&nbsp;snapshot&nbsp;file&nbsp;(which&nbsp;was&nbsp;in&nbsp;jars)&nbsp;to&nbsp;the&nbsp;plugin/jars&nbsp;directory&nbsp;(and<br>
renamed&nbsp;that&nbsp;one&nbsp;to&nbsp;jython.jar).&nbsp;The&nbsp;results&nbsp;are&nbsp;the&nbsp;same&nbsp;for&nbsp;my&nbsp;minimal&nbsp;script<br>
<br>
I&nbsp;modified&nbsp;my&nbsp;minimal&nbsp;script&nbsp;to&nbsp;run&nbsp;the&nbsp;gc,&nbsp;and&nbsp;then&nbsp;close&nbsp;the&nbsp;image&nbsp;and&nbsp;runthe<br>
gc&nbsp;again&nbsp;(twice).&nbsp;<br>
<br>
So&nbsp;here&nbsp;is&nbsp;the&nbsp;new&nbsp;script:<br>
from&nbsp;ij&nbsp;import&nbsp;IJ,&nbsp;Prefs,&nbsp;ImagePlus<br>
from&nbsp;ij.io&nbsp;import&nbsp;DirectoryChooser,&nbsp;&nbsp;OpenDialog<br>
from&nbsp;ij.process&nbsp;import&nbsp;ImageConverter,&nbsp;ByteProcessor,&nbsp;BinaryProcessor<br>
import&nbsp;time,&nbsp;gc<br>
<br>
def&nbsp;forceGc():<br>
&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;memory&nbsp;before&nbsp;gc&nbsp;=&nbsp;&quot;,&nbsp;IJ.currentMemory()<br>
&nbsp;&nbsp;&nbsp;&nbsp;gc.collect()<br>
&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;memory&nbsp;after&nbsp;gc&nbsp;=&nbsp;&quot;,&nbsp;IJ.currentMemory()<br>
<br>
<br>
op&nbsp;=&nbsp;OpenDialog(&quot;Choose&nbsp;input&nbsp;image...&quot;,&nbsp;&quot;&quot;)<br>
path&nbsp;=&nbsp;op.getDirectory()+&nbsp;op.getFileName()<br>
inputName&nbsp;=&nbsp;op.getFileName()<br>
inputDir&nbsp;=&nbsp;op.getDirectory()<br>
inputPath&nbsp;=&nbsp;inputDir&nbsp;+&nbsp;inputName<br>
<br>
if&nbsp;inputName[-4]&nbsp;==&nbsp;&quot;.&quot;:<br>
&nbsp;&nbsp;&nbsp;&nbsp;inputPrefix&nbsp;=&nbsp;inputName[:-4]&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;assumes&nbsp;that&nbsp;a&nbsp;suffix&nbsp;exists<br>
else:<br>
&nbsp;&nbsp;&nbsp;&nbsp;inputPrefix&nbsp;=&nbsp;inputName<br>
<br>
<br>
inputImp&nbsp;=&nbsp;ImagePlus(inputPath)<br>
inputImp.show()<br>
ImageConverter(inputImp).convertToGray8()<br>
<br>
#&nbsp;The&nbsp;following&nbsp;line&nbsp;makes&nbsp;all&nbsp;the&nbsp;difference.<br>
inputIp&nbsp;=&nbsp;inputImp.getProcessor()<br>
forceGc()<br>
<br>
inputImp.close()<br>
forceGc()<br>
forceGc()<br>
<br>
<br>
and&nbsp;here&nbsp;is&nbsp;the&nbsp;output&nbsp;with&nbsp;an&nbsp;image&nbsp;of&nbsp;about&nbsp;1&nbsp;GB:<br>
<br>
Started&nbsp;minimal.py&nbsp;at&nbsp;Wed&nbsp;Dec&nbsp;09&nbsp;07:06:54&nbsp;IST&nbsp;2015<br>
memory&nbsp;before&nbsp;gc&nbsp;=&nbsp;&nbsp;1037433016L<br>
memory&nbsp;after&nbsp;gc&nbsp;=&nbsp;&nbsp;1042983208L<br>
memory&nbsp;before&nbsp;gc&nbsp;=&nbsp;&nbsp;1058432336L<br>
memory&nbsp;after&nbsp;gc&nbsp;=&nbsp;&nbsp;1044836632L<br>
memory&nbsp;before&nbsp;gc&nbsp;=&nbsp;&nbsp;1044836632L<br>
memory&nbsp;after&nbsp;gc&nbsp;=&nbsp;&nbsp;1041655776L<br>
<br>
##&nbsp;end&nbsp;offers&nbsp;run&nbsp;on&nbsp;&quot;fresh&quot;&nbsp;Fiji&nbsp;<br>
<br>
Started&nbsp;minimal.py&nbsp;at&nbsp;Wed&nbsp;Dec&nbsp;09&nbsp;07:07:12&nbsp;IST&nbsp;2015<br>
memory&nbsp;before&nbsp;gc&nbsp;=&nbsp;&nbsp;2055344376L<br>
memory&nbsp;after&nbsp;gc&nbsp;=&nbsp;&nbsp;1044025032L<br>
memory&nbsp;before&nbsp;gc&nbsp;=&nbsp;&nbsp;1056477256L<br>
memory&nbsp;after&nbsp;gc&nbsp;=&nbsp;&nbsp;1042805472L<br>
memory&nbsp;before&nbsp;gc&nbsp;=&nbsp;&nbsp;1042971816L<br>
memory&nbsp;after&nbsp;gc&nbsp;=&nbsp;&nbsp;1036835368L<br>
<br>
##&nbsp;end&nbsp;of&nbsp;second&nbsp;run&nbsp;--&nbsp;nothing&nbsp;open<br>
<br>
Wayne&nbsp;--&nbsp;can&nbsp;you&nbsp;run&nbsp;this&nbsp;script&nbsp;and&nbsp;post&nbsp;the&nbsp;result?&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;hr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&gt;You&nbsp;are&nbsp;receiving&nbsp;this&nbsp;mail&nbsp;because:&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;You&nbsp;are&nbsp;the&nbsp;assignee&nbsp;for&nbsp;the&nbsp;bug.&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
