<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;base&nbsp;href=&quot;http://fiji.sc/bugzilla/&quot;&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;&lt;a&nbsp;class=&quot;bz_bug_link&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bz_status_NEEDSINFO&nbsp;&quot;<br>
&nbsp;&nbsp;&nbsp;title=&quot;NEEDSINFO&nbsp;-&nbsp;memory&nbsp;leak&nbsp;with&nbsp;python&nbsp;script&quot;<br>
&nbsp;&nbsp;&nbsp;href=&quot;http://fiji.sc/bugzilla/show_bug.cgi?id=1203#c5&quot;&gt;Comment&nbsp;#&nbsp;5&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;&lt;a&nbsp;class=&quot;bz_bug_link&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bz_status_NEEDSINFO&nbsp;&quot;<br>
&nbsp;&nbsp;&nbsp;title=&quot;NEEDSINFO&nbsp;-&nbsp;memory&nbsp;leak&nbsp;with&nbsp;python&nbsp;script&quot;<br>
&nbsp;&nbsp;&nbsp;href=&quot;http://fiji.sc/bugzilla/show_bug.cgi?id=1203&quot;&gt;bug&nbsp;1203&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;&lt;span&nbsp;class=&quot;vcard&quot;&gt;&lt;a&nbsp;class=&quot;email&quot;&nbsp;href=&quot;mailto:aryeh&#64;cc.huji.ac.il&quot;&nbsp;title=&quot;Aryeh&nbsp;Weiss&nbsp;&lt;aryeh&#64;cc.huji.ac.il&gt;&quot;&gt;&nbsp;&lt;span&nbsp;class=&quot;fn&quot;&gt;Aryeh&nbsp;Weiss&lt;/span&gt;&lt;/a&gt;<br>
&lt;/span&gt;&lt;/b&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&gt;There&nbsp;is&nbsp;something&nbsp;about&nbsp;getProcessor()<br>
In&nbsp;my&nbsp;script&nbsp;I&nbsp;had&nbsp;two&nbsp;getProcessor()&nbsp;calls&nbsp;which&nbsp;I&nbsp;could&nbsp;remove<br>
<br>
resultDupIp&nbsp;=&nbsp;resultDupImp.getProcessor()&nbsp;#&nbsp;(at&nbsp;about&nbsp;line&nbsp;250)<br>
and&nbsp;<br>
maskIp&nbsp;=&nbsp;maskImp.getProcessor()&nbsp;&nbsp;#&nbsp;(at&nbsp;about&nbsp;line&nbsp;313)<br>
<br>
Removing&nbsp;these&nbsp;called&nbsp;reduced&nbsp;the&nbsp;amount&nbsp;of&nbsp;&quot;stuck&quot;&nbsp;memory&nbsp;from<br>
5.8GB&nbsp;to&nbsp;about&nbsp;2.9GB<br>
<br>
I&nbsp;have&nbsp;two&nbsp;there&nbsp;places&nbsp;that&nbsp;I&nbsp;use&nbsp;the&nbsp;Ip<br>
<br>
inputIp&nbsp;=&nbsp;inputImp.getProcessor()<br>
inputImp.setTitle(inputPrefix+&quot;_mono&quot;)<br>
monoTitle&nbsp;=&nbsp;inputImp.getTitle()<br>
<br>
rf&nbsp;=&nbsp;RankFilters()<br>
rf.rank(inputIp,&nbsp;1,&nbsp;RankFilters.MEDIAN)<br>
<br>
<br>
I&nbsp;tried&nbsp;replacing&nbsp;this&nbsp;with:&nbsp;<br>
IJ.run(inputImp,&nbsp;&quot;Median...&quot;,&nbsp;&quot;radius=1&quot;);<br>
or&nbsp;even&nbsp;<br>
IJ.run(inputImp,&nbsp;&quot;Mean...&quot;,&nbsp;&quot;radius=1&quot;);&nbsp;<br>
<br>
but&nbsp;this&nbsp;did&nbsp;not&nbsp;change&nbsp;anything.&nbsp;Apparently,&nbsp;the&nbsp;call&nbsp;using&nbsp;the&nbsp;static<br>
method&nbsp;also&nbsp;gets&nbsp;an&nbsp;Ip.<br>
<br>
Same&nbsp;thing&nbsp;with:<br>
<br>
bgIp&nbsp;=&nbsp;bgImp.getProcessor()<br>
radius&nbsp;=&nbsp;100.0<br>
accuracy&nbsp;=&nbsp;0.01<br>
GaussianBlur().blurGaussian(&nbsp;bgIp,&nbsp;radius,&nbsp;radius,&nbsp;accuracy)<br>
<br>
which&nbsp;I&nbsp;tried&nbsp;to&nbsp;replace&nbsp;with&nbsp;either<br>
IJ.run(bgImp,&nbsp;&quot;Gaussian&nbsp;Blur...&quot;,&nbsp;&quot;sigma=&quot;+str(radius));<br>
<br>
or&nbsp;<br>
<br>
IJ.run(bgImp,&nbsp;&quot;Mean...&quot;,&nbsp;&quot;radius=&quot;+str(radius));&nbsp;&nbsp;&nbsp;#&nbsp;really&nbsp;slow...<br>
<br>
<br>
but&nbsp;again,&nbsp;no&nbsp;change.<br>
<br>
So&nbsp;getProcessor()&nbsp;apparently&nbsp;creates&nbsp;this&nbsp;hard&nbsp;reference...&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;hr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&gt;You&nbsp;are&nbsp;receiving&nbsp;this&nbsp;mail&nbsp;because:&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;You&nbsp;are&nbsp;the&nbsp;assignee&nbsp;for&nbsp;the&nbsp;bug.&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
