<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;base&nbsp;href=&quot;http://fiji.sc/bugzilla/&quot;&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;&lt;span&nbsp;class=&quot;vcard&quot;&gt;&lt;a&nbsp;class=&quot;email&quot;&nbsp;href=&quot;mailto:jan.eglinger&#64;gmail.com&quot;&nbsp;title=&quot;Jan&nbsp;Eglinger&nbsp;&lt;jan.eglinger&#64;gmail.com&gt;&quot;&gt;&nbsp;&lt;span&nbsp;class=&quot;fn&quot;&gt;Jan&nbsp;Eglinger&lt;/span&gt;&lt;/a&gt;<br>
&lt;/span&gt;&nbsp;changed<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;bz_bug_link&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bz_status_NEW&nbsp;&quot;<br>
&nbsp;&nbsp;&nbsp;title=&quot;NEW&nbsp;-&nbsp;Local&nbsp;Thickness&nbsp;fails&nbsp;to&nbsp;produce&nbsp;final&nbsp;output&quot;<br>
&nbsp;&nbsp;&nbsp;href=&quot;http://fiji.sc/bugzilla/show_bug.cgi?id=1231&quot;&gt;bug&nbsp;1231&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&nbsp;border=&quot;1&quot;&nbsp;cellspacing=&quot;0&quot;&nbsp;cellpadding=&quot;8&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;What&lt;/th&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Removed&lt;/th&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Added&lt;/th&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;style=&quot;text-align:right;&quot;&gt;CC&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;jan.eglinger&#64;gmail.com<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;&lt;/table&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;&lt;a&nbsp;class=&quot;bz_bug_link&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bz_status_NEW&nbsp;&quot;<br>
&nbsp;&nbsp;&nbsp;title=&quot;NEW&nbsp;-&nbsp;Local&nbsp;Thickness&nbsp;fails&nbsp;to&nbsp;produce&nbsp;final&nbsp;output&quot;<br>
&nbsp;&nbsp;&nbsp;href=&quot;http://fiji.sc/bugzilla/show_bug.cgi?id=1231#c1&quot;&gt;Comment&nbsp;#&nbsp;1&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;&lt;a&nbsp;class=&quot;bz_bug_link&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bz_status_NEW&nbsp;&quot;<br>
&nbsp;&nbsp;&nbsp;title=&quot;NEW&nbsp;-&nbsp;Local&nbsp;Thickness&nbsp;fails&nbsp;to&nbsp;produce&nbsp;final&nbsp;output&quot;<br>
&nbsp;&nbsp;&nbsp;href=&quot;http://fiji.sc/bugzilla/show_bug.cgi?id=1231&quot;&gt;bug&nbsp;1231&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;&lt;span&nbsp;class=&quot;vcard&quot;&gt;&lt;a&nbsp;class=&quot;email&quot;&nbsp;href=&quot;mailto:jan.eglinger&#64;gmail.com&quot;&nbsp;title=&quot;Jan&nbsp;Eglinger&nbsp;&lt;jan.eglinger&#64;gmail.com&gt;&quot;&gt;&nbsp;&lt;span&nbsp;class=&quot;fn&quot;&gt;Jan&nbsp;Eglinger&lt;/span&gt;&lt;/a&gt;<br>
&lt;/span&gt;&lt;/b&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&gt;This&nbsp;appears&nbsp;to&nbsp;be&nbsp;a&nbsp;race&nbsp;condition,&nbsp;caused&nbsp;by&nbsp;the&nbsp;LocalThickness&nbsp;plugin<br>
calling&nbsp;WindowManager.getCurrentImage()&nbsp;(instead&nbsp;of&nbsp;handing&nbsp;over&nbsp;a&nbsp;proper<br>
reference&nbsp;to&nbsp;the&nbsp;result&nbsp;image)&nbsp;several&nbsp;times&nbsp;in&nbsp;the&nbsp;source&nbsp;code:<br>
<br>
&lt;a&nbsp;href=&quot;https://github.com/fiji/LocalThickness/blob/master/src/main/java/sc/fiji/localThickness/Local_Thickness_Driver.java#L90-L101&quot;&gt;https://github.com/fiji/LocalThickness/blob/master/src/main/java/sc/fiji/localThickness/Local_Thickness_Driver.java#L90-L101&lt;/a&gt;<br>
<br>
To&nbsp;work&nbsp;around&nbsp;this,&nbsp;you&nbsp;can&nbsp;run&nbsp;the&nbsp;plugin&nbsp;in&nbsp;batch&nbsp;mode.&nbsp;The&nbsp;following&nbsp;macro<br>
worked&nbsp;for&nbsp;me:<br>
<br>
for&nbsp;(y=0;y&lt;8;y++)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;run(&quot;Leaf&nbsp;(36K)&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;run(&quot;Duplicate...&quot;,&nbsp;&quot;&nbsp;&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;selectWindow(&quot;leaf-1.jpg&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;run(&quot;8-bit&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;setBatchMode(true);<br>
&nbsp;&nbsp;&nbsp;&nbsp;run(&quot;Local&nbsp;Thickness&nbsp;(complete&nbsp;process)&quot;,&nbsp;&quot;threshold=100&nbsp;inverse&quot;);<br>
&nbsp;&nbsp;&nbsp;&nbsp;setBatchMode(false);<br>
&nbsp;&nbsp;&nbsp;&nbsp;wait(100);<br>
&nbsp;&nbsp;&nbsp;&nbsp;close();<br>
&nbsp;&nbsp;&nbsp;&nbsp;close();<br>
&nbsp;&nbsp;&nbsp;&nbsp;close();<br>
}<br>
<br>
This&nbsp;is&nbsp;just&nbsp;for&nbsp;illustration&nbsp;purpose.&nbsp;Obviously,&nbsp;depending&nbsp;on&nbsp;what&nbsp;you<br>
actually&nbsp;want&nbsp;to&nbsp;do,&nbsp;you&nbsp;should&nbsp;run&nbsp;the&nbsp;whole&nbsp;loop&nbsp;in&nbsp;batch&nbsp;mode&nbsp;instead&nbsp;of<br>
switching&nbsp;on&nbsp;and&nbsp;off&nbsp;in&nbsp;every&nbsp;iteration.&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;hr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&gt;You&nbsp;are&nbsp;receiving&nbsp;this&nbsp;mail&nbsp;because:&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;You&nbsp;are&nbsp;the&nbsp;assignee&nbsp;for&nbsp;the&nbsp;bug.&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
