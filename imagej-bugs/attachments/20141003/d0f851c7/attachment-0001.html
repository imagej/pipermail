<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;base&nbsp;href=&quot;http://fiji.sc/bugzilla/&quot;&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;&lt;span&nbsp;class=&quot;vcard&quot;&gt;&lt;a&nbsp;class=&quot;email&quot;&nbsp;href=&quot;mailto:ctrueden&#64;wisc.edu&quot;&nbsp;title=&quot;Curtis&nbsp;Rueden&nbsp;&lt;ctrueden&#64;wisc.edu&gt;&quot;&gt;&nbsp;&lt;span&nbsp;class=&quot;fn&quot;&gt;Curtis&nbsp;Rueden&lt;/span&gt;&lt;/a&gt;<br>
&lt;/span&gt;&nbsp;changed<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;bz_bug_link&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bz_status_NEEDSINFO&nbsp;&quot;<br>
&nbsp;&nbsp;&nbsp;title=&quot;NEEDSINFO&nbsp;-&nbsp;Bug&nbsp;in&nbsp;the&nbsp;Intermodes&nbsp;algorithm&nbsp;of&nbsp;threshold&quot;<br>
&nbsp;&nbsp;&nbsp;href=&quot;http://fiji.sc/bugzilla/show_bug.cgi?id=938&quot;&gt;bug&nbsp;938&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table&nbsp;border=&quot;1&quot;&nbsp;cellspacing=&quot;0&quot;&nbsp;cellpadding=&quot;8&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;What&lt;/th&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Removed&lt;/th&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&gt;Added&lt;/th&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;style=&quot;text-align:right;&quot;&gt;Status&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;NEW<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;NEEDSINFO<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&nbsp;style=&quot;text-align:right;&quot;&gt;CC&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;bnorthan&#64;gmail.com,&nbsp;ctrueden&#64;wisc.edu,&nbsp;g.landini&#64;bham.ac.uk<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;&lt;/table&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;&lt;a&nbsp;class=&quot;bz_bug_link&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bz_status_NEEDSINFO&nbsp;&quot;<br>
&nbsp;&nbsp;&nbsp;title=&quot;NEEDSINFO&nbsp;-&nbsp;Bug&nbsp;in&nbsp;the&nbsp;Intermodes&nbsp;algorithm&nbsp;of&nbsp;threshold&quot;<br>
&nbsp;&nbsp;&nbsp;href=&quot;http://fiji.sc/bugzilla/show_bug.cgi?id=938#c1&quot;&gt;Comment&nbsp;#&nbsp;1&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;&lt;a&nbsp;class=&quot;bz_bug_link&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bz_status_NEEDSINFO&nbsp;&quot;<br>
&nbsp;&nbsp;&nbsp;title=&quot;NEEDSINFO&nbsp;-&nbsp;Bug&nbsp;in&nbsp;the&nbsp;Intermodes&nbsp;algorithm&nbsp;of&nbsp;threshold&quot;<br>
&nbsp;&nbsp;&nbsp;href=&quot;http://fiji.sc/bugzilla/show_bug.cgi?id=938&quot;&gt;bug&nbsp;938&lt;/a&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;&lt;span&nbsp;class=&quot;vcard&quot;&gt;&lt;a&nbsp;class=&quot;email&quot;&nbsp;href=&quot;mailto:ctrueden&#64;wisc.edu&quot;&nbsp;title=&quot;Curtis&nbsp;Rueden&nbsp;&lt;ctrueden&#64;wisc.edu&gt;&quot;&gt;&nbsp;&lt;span&nbsp;class=&quot;fn&quot;&gt;Curtis&nbsp;Rueden&lt;/span&gt;&lt;/a&gt;<br>
&lt;/span&gt;&lt;/b&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&gt;Thanks&nbsp;for&nbsp;the&nbsp;report,&nbsp;and&nbsp;macro&nbsp;to&nbsp;reproduce!<br>
<br>
The&nbsp;ImageJ&nbsp;1.x&nbsp;implementation&nbsp;is&nbsp;in&nbsp;a&nbsp;class&nbsp;called&nbsp;AutoThresholder:<br>
<br>
&lt;a&nbsp;href=&quot;https://github.com/imagej/ImageJA/blob/v1.49h/src/main/java/ij/process/AutoThresholder.java#L176-L220&quot;&gt;https://github.com/imagej/ImageJA/blob/v1.49h/src/main/java/ij/process/AutoThresholder.java#L176-L220&lt;/a&gt;<br>
<br>
And&nbsp;the&nbsp;&quot;Auto&nbsp;Threshold&quot;&nbsp;implementation,&nbsp;which&nbsp;is&nbsp;part&nbsp;of&nbsp;Fiji,&nbsp;can&nbsp;be&nbsp;found<br>
at:<br>
<br>
&lt;a&nbsp;href=&quot;https://github.com/fiji/Auto_Threshold/blob/0565751243a83688c84857475adb51ae836a843e/src/main/java/fiji/threshold/Auto_Threshold.java#L493-L541&quot;&gt;https://github.com/fiji/Auto_Threshold/blob/0565751243a83688c84857475adb51ae836a843e/src/main/java/fiji/threshold/Auto_Threshold.java#L493-L541&lt;/a&gt;<br>
<br>
The&nbsp;ImageJ&nbsp;1.x&nbsp;implementation&nbsp;returns&nbsp;1713&nbsp;when&nbsp;&quot;Dark&nbsp;background&quot;&nbsp;is&nbsp;checked.<br>
The&nbsp;Fiji&nbsp;Auto_Threshold&nbsp;implementation&nbsp;returns&nbsp;525.<br>
<br>
It&nbsp;was&nbsp;not&nbsp;clear&nbsp;to&nbsp;me&nbsp;from&nbsp;your&nbsp;bug&nbsp;report&nbsp;which&nbsp;algorithm&nbsp;you&nbsp;believe&nbsp;to&nbsp;be<br>
correct,&nbsp;and&nbsp;which&nbsp;incorrect.&nbsp;However,&nbsp;seeing&nbsp;as&nbsp;how&nbsp;the&nbsp;minimum&nbsp;data&nbsp;value&nbsp;of<br>
the&nbsp;entire&nbsp;&quot;Neuron&quot;&nbsp;sample&nbsp;image&nbsp;is&nbsp;526,&nbsp;the&nbsp;value&nbsp;525&nbsp;seems&nbsp;obviously&nbsp;wrong&nbsp;to<br>
me.&nbsp;So&nbsp;I&nbsp;conclude&nbsp;that&nbsp;the&nbsp;ImageJ&nbsp;1.x&nbsp;result&nbsp;is&nbsp;correct,&nbsp;while&nbsp;the&nbsp;Fiji<br>
Auto_Threshold&nbsp;result&nbsp;is&nbsp;incorrect.&nbsp;Right?<br>
<br>
As&nbsp;an&nbsp;aside:&nbsp;there&nbsp;is&nbsp;a&nbsp;third&nbsp;implementation,&nbsp;recently&nbsp;ported&nbsp;from&nbsp;Fiji's<br>
Auto_Thresold,&nbsp;in&nbsp;the&nbsp;ImageJ&nbsp;OPS&nbsp;library:<br>
<br>
&lt;a&nbsp;href=&quot;https://github.com/imagej/imagej-ops/blob/114183192d41e9dcbe0e6450512170f8a566dc6e/src/main/java/net/imagej/ops/threshold/global/methods/ComputeIntermodesThreshold.java#L58-L100&quot;&gt;https://github.com/imagej/imagej-ops/blob/114183192d41e9dcbe0e6450512170f8a566dc6e/src/main/java/net/imagej/ops/threshold/global/methods/ComputeIntermodesThreshold.java#L58-L100&lt;/a&gt;<br>
<br>
Since&nbsp;it&nbsp;was&nbsp;ported&nbsp;from&nbsp;Fiji's&nbsp;Auto_Threshold,&nbsp;it&nbsp;also&nbsp;suffers&nbsp;from&nbsp;this&nbsp;bug.<br>
<br>
Gadea:&nbsp;Could&nbsp;you&nbsp;please&nbsp;confirm&nbsp;that&nbsp;the&nbsp;ImageJ&nbsp;1.x&nbsp;code&nbsp;produces&nbsp;the&nbsp;correct<br>
result,&nbsp;and&nbsp;the&nbsp;Fiji&nbsp;Auto_Threshold&nbsp;code&nbsp;an&nbsp;incorrect&nbsp;one?&nbsp;If&nbsp;so,&nbsp;I&nbsp;will&nbsp;fix<br>
the&nbsp;bug&nbsp;in&nbsp;the&nbsp;two&nbsp;affected&nbsp;libraries.&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;hr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&gt;You&nbsp;are&nbsp;receiving&nbsp;this&nbsp;mail&nbsp;because:&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;You&nbsp;are&nbsp;the&nbsp;assignee&nbsp;for&nbsp;the&nbsp;bug.&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
