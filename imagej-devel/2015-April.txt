From bugzilla at fiji.sc  Mon Apr  6 15:49:23 2015
From: bugzilla at fiji.sc (bugzilla at fiji.sc)
Date: Mon, 06 Apr 2015 20:49:23 +0000
Subject: [ImageJ-devel] [Bug 826] I cannot open *.avi files after updating
 my Fiji to ImageJ2. Before the update it was working perfectly. Now,
 I cannot come back to my previous version of Fiji :(
In-Reply-To: <bug-826-194@http.fiji.sc/bugzilla/>
References: <bug-826-194@http.fiji.sc/bugzilla/>
Message-ID: <bug-826-194-V3V5rq7oLc@http.fiji.sc/bugzilla/>

http://fiji.sc/bugzilla/show_bug.cgi?id=826

Curtis Rueden <ctrueden at wisc.edu> changed:

           What    |Removed                     |Added
----------------------------------------------------------------------------
                 CC|                            |imagej-bugs at imagej.net
          Component|SCIFIO                      |SCIFIO
            Product|Fiji                        |ImageJ

-- 
You are receiving this mail because:
You are on the CC list for the bug.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://imagej.net/pipermail/imagej-devel/attachments/20150406/093932b1/attachment.html>

From cyril.mongis at googlemail.com  Tue Apr  7 11:06:08 2015
From: cyril.mongis at googlemail.com (Mongis Cyril)
Date: Tue, 7 Apr 2015 18:06:08 +0200
Subject: [ImageJ-devel] Developping new UI for ImageJ
In-Reply-To: <etPan.55144082.327b23c6.5fe8@zen>
References: <CAJf7PRf6qnHCKKsqmad+-8yp9NfsC5xzFmwbC+rn-8ujQp2fpQ@mail.gmail.com>
	<etPan.55144082.327b23c6.5fe8@zen>
Message-ID: <CAJf7PRcfQE68mBABee0S85pBK-oN-NP1LTd5Ef30Eb9bx2sNSA@mail.gmail.com>

Hello everyone !

I had to put the project on pause for a couple of week but now I'm back on
it. First, thank you for your help. Thanks to you, I succeeded to put the
FxUI as prior UI. Also the JavaFX App is started in ImageJ. I could even
generate a menu and all. I can call the "Open file" plugin and it uses the
JavaFX routines to show the file dialogs and all. It's great. However, not
much happens after that. My next questions goes about to the ImageDisplay
stack. I have troubles understanding the "call stack" after the image has
been open. What the difference between the DisplayService, ImageDisplay and
ImageDisplayViewer ? An image is open but who decide of what and how ? Do I
have to overwrite the ImageDisplayService or is it UI agnostic ?

Cheers

Cyril



2015-03-26 18:23 GMT+01:00 Brian Schlining <bschlining at gmail.com>:

> Hi,
>
> On March 26, 2015 at 8:49:21 AM, Mongis Cyril (cyril.mongis at googlemail.com)
> wrote:
>
>
> I'm currently embedding ImageJ in one my application but I use JavaFX for
> the user interface. I would like to channel the image windows, which are
> created and handled by ImageJ, to JavaFX elements. In other words, when a
> plugin wants to display an image, this image would be displayed in a JavaFX
> element.
>
>
> I have some code that may help get you going. The source is under
> https://github.com/hohonuuli/assignments-openimaj. Specifically, you
> should take a look at the classes in
> https://github.com/hohonuuli/assignments-openimaj/tree/master/src/main/java/org/mbari/javafx/scene/image
>
> The code there is pretty straightforward. I wrote this code for an image
> processing course I was taking. You can display an image in a resizable
> JavaFX Stage likes so:
>
> import java.net.URL;
> import org.mbari.javafx.scene.image.*;
>
> JavaFX.namedWindow("My Window",
>   new URL("https://upload.wikimedia.org/wikipedia/en/2/24/Lenna.png"));
>
> If you need a reference to the Stage you can do the following after you?ve
> created it:
>
> Optional<ImageStage> stage = JavaFX.getNamedWindow("My Window");
>
> Anyway, it will at least give you a starting point. There?s a method that
> takes a javafx.scene.image.Image
> <http://docs.oracle.com/javase/8/javafx/api/javafx/scene/image/Image.html>
> instead of a URL too. You?ll still need to implement a conversion between
> ImageJ/imglib2 image formats and JavaFX?s Image. There?s also a Swing class
> the does something similar (e.g. Swing.namedWindow(...) in the project.
>
> Good Luck
>
> ? Brian Schlining
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://imagej.net/pipermail/imagej-devel/attachments/20150407/daf28c8e/attachment.html>

From warrick at wisc.edu  Tue Apr  7 17:11:59 2015
From: warrick at wisc.edu (Jay Warrick)
Date: Tue, 07 Apr 2015 17:11:59 -0500
Subject: [ImageJ-devel] Developping new UI for ImageJ
In-Reply-To: <CAJf7PRcfQE68mBABee0S85pBK-oN-NP1LTd5Ef30Eb9bx2sNSA@mail.gmail.com>
References: <CAJf7PRf6qnHCKKsqmad+-8yp9NfsC5xzFmwbC+rn-8ujQp2fpQ@mail.gmail.com>
	<etPan.55144082.327b23c6.5fe8@zen>
	<CAJf7PRcfQE68mBABee0S85pBK-oN-NP1LTd5Ef30Eb9bx2sNSA@mail.gmail.com>
Message-ID: <E0E9CBD3-F6A3-494B-B2B2-240B8DDFA7FB@wisc.edu>

https://www.overleaf.com/read/prvfqjnzzxwq

I wrote this up a while back. It only touches a bit on your topics (I think) at a high level but maybe it would help. Hopefully it isn't outdated anymore.

Cheers,

Jay

> On Apr 7, 2015, at 11:06 AM, Mongis Cyril <cyril.mongis at googlemail.com> wrote:
> 
> Hello everyone !
> 
> I had to put the project on pause for a couple of week but now I'm back on it. First, thank you for your help. Thanks to you, I succeeded to put the FxUI as prior UI. Also the JavaFX App is started in ImageJ. I could even generate a menu and all. I can call the "Open file" plugin and it uses the JavaFX routines to show the file dialogs and all. It's great. However, not much happens after that. My next questions goes about to the ImageDisplay stack. I have troubles understanding the "call stack" after the image has been open. What the difference between the DisplayService, ImageDisplay and ImageDisplayViewer ? An image is open but who decide of what and how ? Do I have to overwrite the ImageDisplayService or is it UI agnostic ?
> 
> Cheers
> 
> Cyril
> 
> 
> 
> 2015-03-26 18:23 GMT+01:00 Brian Schlining <bschlining at gmail.com <mailto:bschlining at gmail.com>>:
> 
> Hi,
> 
> On March 26, 2015 at 8:49:21 AM, Mongis Cyril (cyril.mongis at googlemail.com <mailto:cyril.mongis at googlemail.com>) wrote:
> 
>> 
>> I'm currently embedding ImageJ in one my application but I use JavaFX for the user interface. I would like to channel the image windows, which are created and handled by ImageJ, to JavaFX elements. In other words, when a plugin wants to display an image, this image would be displayed in a JavaFX element. 
> 
> 
> 
> I have some code that may help get you going. The source is under https://github.com/hohonuuli/assignments-openimaj <https://github.com/hohonuuli/assignments-openimaj>. Specifically, you should take a look at the classes in https://github.com/hohonuuli/assignments-openimaj/tree/master/src/main/java/org/mbari/javafx/scene/image <https://github.com/hohonuuli/assignments-openimaj/tree/master/src/main/java/org/mbari/javafx/scene/image>
> The code there is pretty straightforward. I wrote this code for an image processing course I was taking. You can display an image in a resizable JavaFX Stage likes so:
> 
> import java.net.URL;
> import org.mbari.javafx.scene.image.*;
> 
> JavaFX.namedWindow("My Window",  
>   new URL("https://upload.wikimedia.org/wikipedia/en/2/24/Lenna.png <https://upload.wikimedia.org/wikipedia/en/2/24/Lenna.png>"));
> If you need a reference to the Stage you can do the following after you?ve created it:
> 
> Optional<ImageStage> stage = JavaFX.getNamedWindow("My Window");
> Anyway, it will at least give you a starting point. There?s a method that takes a javafx.scene.image.Image <http://docs.oracle.com/javase/8/javafx/api/javafx/scene/image/Image.html> instead of a URL too. You?ll still need to implement a conversion between ImageJ/imglib2 image formats and JavaFX?s Image. There?s also a Swing class the does something similar (e.g. Swing.namedWindow(...) in the project.
> 
> Good Luck
> 
> ? Brian Schlining
> 
> 
> _______________________________________________
> ImageJ-devel mailing list
> ImageJ-devel at imagej.net
> http://imagej.net/mailman/listinfo/imagej-devel

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://imagej.net/pipermail/imagej-devel/attachments/20150407/68a446f9/attachment.html>

From saalfelds at janelia.hhmi.org  Tue Apr  7 18:34:52 2015
From: saalfelds at janelia.hhmi.org (Stephan Saalfeld)
Date: Tue, 7 Apr 2015 19:34:52 -0400
Subject: [ImageJ-devel] pom-trakem2-1.3.3
Message-ID: <1428449692.6888.46.camel@saalfelds-ws1.janelia.priv>

Hi,

I was too fast pushing, please make the release artifact
pom-trakem2-1.3.3 available.  It has a tag.

Thanks,
Stephan



From saalfelds at janelia.hhmi.org  Tue Apr  7 19:48:12 2015
From: saalfelds at janelia.hhmi.org (Stephan Saalfeld)
Date: Tue, 7 Apr 2015 20:48:12 -0400
Subject: [ImageJ-devel] Updater suicide
Message-ID: <1428454092.6888.56.camel@saalfelds-ws1.janelia.priv>

Hi,

I downloaded a fresh Fiji version, updated, built it successfully at

https://github.com/fiji/fiji/pull/117

with

mvn clean install \
 -Dimagej.app.directory=$HOME/packages/Fiji.app/ \
 -Ddelete.other.versions=true

, tested it, and then followed

http://fiji.sc/How_to_upload_to_core_update_sites

to upload the result.  While attempting to input

Host: webdav:Saalfeld

I observed a number of exceptions that I unfortunately did not track.
Instead, I closed the window, and restarted Fiji.  Since then, each
attempt to start the updater sends me into the (screenshot)-attached
exception from which I cannot do anything.  Fiji itself works, just the
updater has committed suicide.

Any help highly appreciated.

Thanks,
Stephan



-------------- next part --------------
A non-text attachment was scrubbed...
Name: Fiji-uploader.png
Type: image/png
Size: 368832 bytes
Desc: not available
URL: <http://imagej.net/pipermail/imagej-devel/attachments/20150407/25437071/attachment-0001.png>

From saalfelds at janelia.hhmi.org  Tue Apr  7 21:13:18 2015
From: saalfelds at janelia.hhmi.org (Stephan Saalfeld)
Date: Tue, 7 Apr 2015 22:13:18 -0400
Subject: [ImageJ-devel] Updater suicide
In-Reply-To: <1428454092.6888.56.camel@saalfelds-ws1.janelia.priv>
References: <1428454092.6888.56.camel@saalfelds-ws1.janelia.priv>
Message-ID: <1428459198.6888.62.camel@saalfelds-ws1.janelia.priv>

Hi,

for the record, I managed to work around this.  The necessary sequence
of operations is:

1. Download a fresh version of Fiji.
2. Start the updater (it finds that Fiji is up to date) and enter the
credentials as described at

http://fiji.sc/How_to_upload_to_core_update_sites

3. Close Fiji.
4. Build Fiji with

mvn clean install \
 -Dimagej.app.directory=$HOME/packages/Fiji.app/ \
 -Ddelete.other.versions=true

5. Start Fiji, and start the updater (it now finds something to update).
6. Update Fiji.
7. Restart Fiji.
8. Start the updater, mark all local changes for upload, upload.

Done.

Hooray!

Best,
Stephan



On Tue, 2015-04-07 at 20:48 -0400, Stephan Saalfeld wrote:
> Hi,
> 
> I downloaded a fresh Fiji version, updated, built it successfully at
> 
> https://github.com/fiji/fiji/pull/117
> 
> with
> 
> mvn clean install \
>  -Dimagej.app.directory=$HOME/packages/Fiji.app/ \
>  -Ddelete.other.versions=true
> 
> , tested it, and then followed
> 
> http://fiji.sc/How_to_upload_to_core_update_sites
> 
> to upload the result.  While attempting to input
> 
> Host: webdav:Saalfeld
> 
> I observed a number of exceptions that I unfortunately did not track.
> Instead, I closed the window, and restarted Fiji.  Since then, each
> attempt to start the updater sends me into the (screenshot)-attached
> exception from which I cannot do anything.  Fiji itself works, just the
> updater has committed suicide.
> 
> Any help highly appreciated.
> 
> Thanks,
> Stephan
> 
> 
> 



From saalfelds at janelia.hhmi.org  Tue Apr  7 21:24:08 2015
From: saalfelds at janelia.hhmi.org (Stephan Saalfeld)
Date: Tue, 7 Apr 2015 22:24:08 -0400
Subject: [ImageJ-devel] Fiji updated to mpicbg-1.0.1
Message-ID: <1428459848.6888.72.camel@saalfelds-ws1.janelia.priv>

Hi,

thanks to your help, I was finally able to update Fiji.  The necessary
pull-requests

https://github.com/fiji/pom-fiji/pull/4

https://github.com/fiji/fiji/pull/117

are still pending because I managed to screw up the Jenkins-release of
pom-trakem2-1.3.3 which you hopefully will be able to fix easily
tomorrow.

I [re-]added a few version-properties such that import of
pom-bigdataviewer and pom-trakem2 in fiji/pom come closer to Curtis'
intention (at least I hope that I got it right this time).  The
individual modules of TrakEM2 and BigDataViewer have not been updated to
use the properties yet, I think this can wait until their respective
next releases.

Jean-Yves, MaMuT now may need an upgrade (the one you tested to work)
because bigdataviewer was upgraded.

Thanks again for your help and I hope that we will be able to fix the
remaining glitches quickly.

Best,
Stephan



From ctrueden at wisc.edu  Wed Apr  8 12:20:44 2015
From: ctrueden at wisc.edu (Curtis Rueden)
Date: Wed, 8 Apr 2015 12:20:44 -0500
Subject: [ImageJ-devel] Developping new UI for ImageJ
In-Reply-To: <CAJf7PRcfQE68mBABee0S85pBK-oN-NP1LTd5Ef30Eb9bx2sNSA@mail.gmail.com>
References: <CAJf7PRf6qnHCKKsqmad+-8yp9NfsC5xzFmwbC+rn-8ujQp2fpQ@mail.gmail.com>
	<etPan.55144082.327b23c6.5fe8@zen>
	<CAJf7PRcfQE68mBABee0S85pBK-oN-NP1LTd5Ef30Eb9bx2sNSA@mail.gmail.com>
Message-ID: <CADN69ym2Cq1_gWnihpY+DTpuWKu7BddLGYgd9QLAm4Cn1Z-sVA@mail.gmail.com>

Hi Cyril,

> What the difference between the DisplayService, ImageDisplay and
> ImageDisplayViewer ?

The DisplayService is the service for working with Displays. It is UI
agnostic, and should not need to be overridden.

ImageDisplay is a Display for image objects. These are UI agnostic.

ImageDisplayViewer is the actual UI-specific implementation (e.g.,
SwingImageDisplayViewer in imagej-ui-swing), which creates and shows the UI
components for the desired ImageDisplay.

> An image is open but who decide of what and how ?

The UIService responds to DisplayCreatedEvents, creating and showing a
DisplayViewer for each currently visible UI [1, 2, 3].

> Do I have to overwrite the ImageDisplayService or is it UI agnostic ?

The ImageDisplayService is a convenience service for working specifically
with ImageDisplays (rather than the more general Displays). It is UI
agnostic, and should not need to be overridden.

What you need to do is implement a JavaFXImageDisplayViewer, which will
then be used to display the UI component that visualizes the image (i.e.,
the Dataset, which is wrapped in a DatasetView, which is wrapped in an
ImageDisplay).

The current type hierarchy is at least one level too complex. FWIW, it
evolved this way so that ImageDisplays could be fully headless [4]. But
there are definitely ways to simplify the hierarchy. We will do it before
the ImageJ2 data model comes out of beta.

See also these issues:
* https://github.com/scijava/scijava-common/issues/157
* https://github.com/imagej/imagej-common/issues/12

Regards,
Curtis

[1]
https://github.com/scijava/scijava-common/blob/scijava-common-2.40.0/src/main/java/org/scijava/ui/DefaultUIService.java#L373-L380
[2]
https://github.com/scijava/scijava-common/blob/scijava-common-2.40.0/src/main/java/org/scijava/ui/AbstractUserInterface.java#L125-L162
[3]
https://github.com/scijava/scijava-common/blob/scijava-common-2.40.0/src/main/java/org/scijava/ui/DefaultUIService.java#L272-L277

[4] http://trac.imagej.net/ticket/995


On Tue, Apr 7, 2015 at 11:06 AM, Mongis Cyril <cyril.mongis at googlemail.com>
wrote:

> Hello everyone !
>
> I had to put the project on pause for a couple of week but now I'm back on
> it. First, thank you for your help. Thanks to you, I succeeded to put the
> FxUI as prior UI. Also the JavaFX App is started in ImageJ. I could even
> generate a menu and all. I can call the "Open file" plugin and it uses the
> JavaFX routines to show the file dialogs and all. It's great. However, not
> much happens after that. My next questions goes about to the ImageDisplay
> stack. I have troubles understanding the "call stack" after the image has
> been open. What the difference between the DisplayService, ImageDisplay and
> ImageDisplayViewer ? An image is open but who decide of what and how ? Do I
> have to overwrite the ImageDisplayService or is it UI agnostic ?
>
> Cheers
>
> Cyril
>
>
>
> 2015-03-26 18:23 GMT+01:00 Brian Schlining <bschlining at gmail.com>:
>
>> Hi,
>>
>> On March 26, 2015 at 8:49:21 AM, Mongis Cyril (
>> cyril.mongis at googlemail.com) wrote:
>>
>>
>> I'm currently embedding ImageJ in one my application but I use JavaFX for
>> the user interface. I would like to channel the image windows, which are
>> created and handled by ImageJ, to JavaFX elements. In other words, when a
>> plugin wants to display an image, this image would be displayed in a JavaFX
>> element.
>>
>>
>> I have some code that may help get you going. The source is under
>> https://github.com/hohonuuli/assignments-openimaj. Specifically, you
>> should take a look at the classes in
>> https://github.com/hohonuuli/assignments-openimaj/tree/master/src/main/java/org/mbari/javafx/scene/image
>>
>> The code there is pretty straightforward. I wrote this code for an image
>> processing course I was taking. You can display an image in a resizable
>> JavaFX Stage likes so:
>>
>> import java.net.URL;
>> import org.mbari.javafx.scene.image.*;
>>
>> JavaFX.namedWindow("My Window",
>>   new URL("https://upload.wikimedia.org/wikipedia/en/2/24/Lenna.png"));
>>
>> If you need a reference to the Stage you can do the following after
>> you?ve created it:
>>
>> Optional<ImageStage> stage = JavaFX.getNamedWindow("My Window");
>>
>> Anyway, it will at least give you a starting point. There?s a method that
>> takes a javafx.scene.image.Image
>> <http://docs.oracle.com/javase/8/javafx/api/javafx/scene/image/Image.html>
>> instead of a URL too. You?ll still need to implement a conversion between
>> ImageJ/imglib2 image formats and JavaFX?s Image. There?s also a Swing class
>> the does something similar (e.g. Swing.namedWindow(...) in the project.
>>
>> Good Luck
>>
>> ? Brian Schlining
>>
>
>
> _______________________________________________
> ImageJ-devel mailing list
> ImageJ-devel at imagej.net
> http://imagej.net/mailman/listinfo/imagej-devel
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://imagej.net/pipermail/imagej-devel/attachments/20150408/4e338007/attachment.html>

From hiner at wisc.edu  Thu Apr  9 09:48:25 2015
From: hiner at wisc.edu (Mark Hiner)
Date: Thu, 9 Apr 2015 09:48:25 -0500
Subject: [ImageJ-devel] Updater suicide
In-Reply-To: <1428459198.6888.62.camel@saalfelds-ws1.janelia.priv>
References: <1428454092.6888.56.camel@saalfelds-ws1.janelia.priv>
	<1428459198.6888.62.camel@saalfelds-ws1.janelia.priv>
Message-ID: <CA+B=mGrAkBhMrChPigw2SY_6SqjbeoM1y9iw68b8BrKP5hLh9A@mail.gmail.com>

Hi Stephan,

Apologies in advance if you worked with Curtis on this and I'm
contradicting anything he said.

> 8. Start the updater, mark all local changes for upload, upload.

It looks like you completed the upload, given that the mpicbg version on
the update site is 1.0.1. I'm glad you got it working, but wanted to point
out that this upload breaks synchronization with the source since it's
based off a topic branch and not master.

More concerning is the fact that, by default, this branch can't actually be
built because it references a release of pom-fiji that doesn't exist yet.

I see you made a pom-fiji 9.0.0 release commit
<https://github.com/fiji/pom-fiji/commit/5eeb909bb0586e9816658abe4eb17abd8ac0aa66>.
Note that this *did not* actually release pom-fiji 9.0.0 because it's on a
topic branch. Jenkins is only configured to build and deploy Maven
artifacts from master. Merging the branch now will not retroactively cause
9.0.0 to be released, because after merging the branch its HEAD will be a
SNAPSHOT version - and only HEAD commits are built.

Anyway, I updated the release instructions
<http://imagej.net/Cutting_releases#The_manual_process> to clarify that the
2 commit method only works on master. I also expanded the core update site
<http://imagej.net/How_to_upload_to_core_update_sites> instructions to
better explain how we want these sites to be maintained.

We are, of course, still doomed until update site + source are synchronized
automatically. But hopefully things are a little clearer now. Please let me
know if they aren't, or if you have any suggestions on how to make things
better.

Thanks,
Mark

On Tue, Apr 7, 2015 at 9:13 PM, Stephan Saalfeld <saalfelds at janelia.hhmi.org
> wrote:

> Hi,
>
> for the record, I managed to work around this.  The necessary sequence
> of operations is:
>
> 1. Download a fresh version of Fiji.
> 2. Start the updater (it finds that Fiji is up to date) and enter the
> credentials as described at
>
> http://fiji.sc/How_to_upload_to_core_update_sites
>
> 3. Close Fiji.
> 4. Build Fiji with
>
> mvn clean install \
>  -Dimagej.app.directory=$HOME/packages/Fiji.app/ \
>  -Ddelete.other.versions=true
>
> 5. Start Fiji, and start the updater (it now finds something to update).
> 6. Update Fiji.
> 7. Restart Fiji.
> 8. Start the updater, mark all local changes for upload, upload.
>
> Done.
>
> Hooray!
>
> Best,
> Stephan
>
>
>
> On Tue, 2015-04-07 at 20:48 -0400, Stephan Saalfeld wrote:
> > Hi,
> >
> > I downloaded a fresh Fiji version, updated, built it successfully at
> >
> > https://github.com/fiji/fiji/pull/117
> >
> > with
> >
> > mvn clean install \
> >  -Dimagej.app.directory=$HOME/packages/Fiji.app/ \
> >  -Ddelete.other.versions=true
> >
> > , tested it, and then followed
> >
> > http://fiji.sc/How_to_upload_to_core_update_sites
> >
> > to upload the result.  While attempting to input
> >
> > Host: webdav:Saalfeld
> >
> > I observed a number of exceptions that I unfortunately did not track.
> > Instead, I closed the window, and restarted Fiji.  Since then, each
> > attempt to start the updater sends me into the (screenshot)-attached
> > exception from which I cannot do anything.  Fiji itself works, just the
> > updater has committed suicide.
> >
> > Any help highly appreciated.
> >
> > Thanks,
> > Stephan
> >
> >
> >
>
>
> _______________________________________________
> ImageJ-devel mailing list
> ImageJ-devel at imagej.net
> http://imagej.net/mailman/listinfo/imagej-devel
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://imagej.net/pipermail/imagej-devel/attachments/20150409/fc0954fc/attachment.html>

From hiner at wisc.edu  Thu Apr  9 10:22:08 2015
From: hiner at wisc.edu (Mark Hiner)
Date: Thu, 9 Apr 2015 10:22:08 -0500
Subject: [ImageJ-devel] pom-trakem2-1.3.3
In-Reply-To: <1428449692.6888.46.camel@saalfelds-ws1.janelia.priv>
References: <1428449692.6888.46.camel@saalfelds-ws1.janelia.priv>
Message-ID: <CA+B=mGrkCnJk2Phk-qb6o9q38PwG_Er9mhpKDL3kQNZG1O2Xiw@mail.gmail.com>

Released:
http://maven.imagej.net/service/local/repositories/releases/content/sc/fiji/pom-trakem2/1.3.3/pom-trakem2-1.3.3.pom

Sorry for the delay. Tagging it was a good idea. The TrakEM2 Jenkins job
<http://jenkins.imagej.net/job/TrakEM2> just needed to be manually pointed
to the tag or branch and run once, then pointed back to master.

Note that, in Jenkins, tags need to be explicitly referenced by
"refs/tags/<tagName>" - which I just learned today!

- Mark

On Tue, Apr 7, 2015 at 6:34 PM, Stephan Saalfeld <saalfelds at janelia.hhmi.org
> wrote:

> Hi,
>
> I was too fast pushing, please make the release artifact
> pom-trakem2-1.3.3 available.  It has a tag.
>
> Thanks,
> Stephan
>
>
> _______________________________________________
> ImageJ-devel mailing list
> ImageJ-devel at imagej.net
> http://imagej.net/mailman/listinfo/imagej-devel
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://imagej.net/pipermail/imagej-devel/attachments/20150409/16b43882/attachment-0001.html>

From wagner at biomedical-imaging.de  Mon Apr 20 04:53:36 2015
From: wagner at biomedical-imaging.de (Thorsten Wagner)
Date: Mon, 20 Apr 2015 11:53:36 +0200
Subject: [ImageJ-devel] Performing convolution using ImageJ2
Message-ID: <1429523616.6666.3.camel@biomedical-imaging.de>

Dear list,

I try to perform a simple convolution using imagej2. Unfortunately, it
failed!

This is my code:
http://pastebin.com/CqBgcLXd

This is the exception:
http://pastebin.com/KHkeGGAJ

I would be grateful for any help.

Regards,
Thorsten


From cyril.mongis at googlemail.com  Mon Apr 20 07:27:19 2015
From: cyril.mongis at googlemail.com (Mongis Cyril)
Date: Mon, 20 Apr 2015 14:27:19 +0200
Subject: [ImageJ-devel] Developping new UI for ImageJ
In-Reply-To: <CADN69ym2Cq1_gWnihpY+DTpuWKu7BddLGYgd9QLAm4Cn1Z-sVA@mail.gmail.com>
References: <CAJf7PRf6qnHCKKsqmad+-8yp9NfsC5xzFmwbC+rn-8ujQp2fpQ@mail.gmail.com>
	<etPan.55144082.327b23c6.5fe8@zen>
	<CAJf7PRcfQE68mBABee0S85pBK-oN-NP1LTd5Ef30Eb9bx2sNSA@mail.gmail.com>
	<CADN69ym2Cq1_gWnihpY+DTpuWKu7BddLGYgd9QLAm4Cn1Z-sVA@mail.gmail.com>
Message-ID: <CAJf7PRf2bn3JHwY4yt0YkQLY_JZOexWWfuT-JbRzcdXNDXKivw@mail.gmail.com>

Hi, Jay and Curtis,

Thanks for your explanations, I could implement the triggering of the view.
But since this part of the software may change in the future, I just
overrode the  methods "show(Display<?> display)" ,which originally searches
among the different Viewers, and made it create my own viewer. Now I'm
attacking pixel drawing, and again, many components seems to interacts with
each other. The low-level part of the software seems to have a lot of
control over the view. From what I saw, ImageJ proposes an abstraction of
the ImageCanvas (which does not seems to hold any pixels) and publish
modification of the canvas ( zoom, or drawn pixels ? ) as events, which
should be then handled by the view. Am I correct ? I was just wondering :
will this whole structure will be also modified in the future when
implementing the guideline of the issue #154 ?

I implemented my own Canvas that uses JavaFx display elements. I guess I
will just find a way to retrieve from the ImageDisplay the DatasetView
which is already a pretty useful object.

What do you think ?

Cheers,

Cyril


2015-04-08 19:20 GMT+02:00 Curtis Rueden <ctrueden at wisc.edu>:

> Hi Cyril,
>
> > What the difference between the DisplayService, ImageDisplay and
> > ImageDisplayViewer ?
>
> The DisplayService is the service for working with Displays. It is UI
> agnostic, and should not need to be overridden.
>
> ImageDisplay is a Display for image objects. These are UI agnostic.
>
> ImageDisplayViewer is the actual UI-specific implementation (e.g.,
> SwingImageDisplayViewer in imagej-ui-swing), which creates and shows the UI
> components for the desired ImageDisplay.
>
> > An image is open but who decide of what and how ?
>
> The UIService responds to DisplayCreatedEvents, creating and showing a
> DisplayViewer for each currently visible UI [1, 2, 3].
>
> > Do I have to overwrite the ImageDisplayService or is it UI agnostic ?
>
> The ImageDisplayService is a convenience service for working specifically
> with ImageDisplays (rather than the more general Displays). It is UI
> agnostic, and should not need to be overridden.
>
> What you need to do is implement a JavaFXImageDisplayViewer, which will
> then be used to display the UI component that visualizes the image (i.e.,
> the Dataset, which is wrapped in a DatasetView, which is wrapped in an
> ImageDisplay).
>
> The current type hierarchy is at least one level too complex. FWIW, it
> evolved this way so that ImageDisplays could be fully headless [4]. But
> there are definitely ways to simplify the hierarchy. We will do it before
> the ImageJ2 data model comes out of beta.
>
> See also these issues:
> * https://github.com/scijava/scijava-common/issues/157
> * https://github.com/imagej/imagej-common/issues/12
>
> Regards,
> Curtis
>
> [1]
> https://github.com/scijava/scijava-common/blob/scijava-common-2.40.0/src/main/java/org/scijava/ui/DefaultUIService.java#L373-L380
> [2]
> https://github.com/scijava/scijava-common/blob/scijava-common-2.40.0/src/main/java/org/scijava/ui/AbstractUserInterface.java#L125-L162
> [3]
> https://github.com/scijava/scijava-common/blob/scijava-common-2.40.0/src/main/java/org/scijava/ui/DefaultUIService.java#L272-L277
>
> [4] http://trac.imagej.net/ticket/995
>
>
> On Tue, Apr 7, 2015 at 11:06 AM, Mongis Cyril <cyril.mongis at googlemail.com
> > wrote:
>
>> Hello everyone !
>>
>> I had to put the project on pause for a couple of week but now I'm back
>> on it. First, thank you for your help. Thanks to you, I succeeded to put
>> the FxUI as prior UI. Also the JavaFX App is started in ImageJ. I could
>> even generate a menu and all. I can call the "Open file" plugin and it uses
>> the JavaFX routines to show the file dialogs and all. It's great. However,
>> not much happens after that. My next questions goes about to the
>> ImageDisplay stack. I have troubles understanding the "call stack" after
>> the image has been open. What the difference between the DisplayService,
>> ImageDisplay and ImageDisplayViewer ? An image is open but who decide of
>> what and how ? Do I have to overwrite the ImageDisplayService or is it UI
>> agnostic ?
>>
>> Cheers
>>
>> Cyril
>>
>>
>>
>> 2015-03-26 18:23 GMT+01:00 Brian Schlining <bschlining at gmail.com>:
>>
>>> Hi,
>>>
>>> On March 26, 2015 at 8:49:21 AM, Mongis Cyril (
>>> cyril.mongis at googlemail.com) wrote:
>>>
>>>
>>> I'm currently embedding ImageJ in one my application but I use JavaFX
>>> for the user interface. I would like to channel the image windows, which
>>> are created and handled by ImageJ, to JavaFX elements. In other words, when
>>> a plugin wants to display an image, this image would be displayed in a
>>> JavaFX element.
>>>
>>>
>>> I have some code that may help get you going. The source is under
>>> https://github.com/hohonuuli/assignments-openimaj. Specifically, you
>>> should take a look at the classes in
>>> https://github.com/hohonuuli/assignments-openimaj/tree/master/src/main/java/org/mbari/javafx/scene/image
>>>
>>> The code there is pretty straightforward. I wrote this code for an image
>>> processing course I was taking. You can display an image in a resizable
>>> JavaFX Stage likes so:
>>>
>>> import java.net.URL;
>>> import org.mbari.javafx.scene.image.*;
>>>
>>> JavaFX.namedWindow("My Window",
>>>   new URL("https://upload.wikimedia.org/wikipedia/en/2/24/Lenna.png"));
>>>
>>> If you need a reference to the Stage you can do the following after
>>> you?ve created it:
>>>
>>> Optional<ImageStage> stage = JavaFX.getNamedWindow("My Window");
>>>
>>> Anyway, it will at least give you a starting point. There?s a method
>>> that takes a javafx.scene.image.Image
>>> <http://docs.oracle.com/javase/8/javafx/api/javafx/scene/image/Image.html>
>>> instead of a URL too. You?ll still need to implement a conversion between
>>> ImageJ/imglib2 image formats and JavaFX?s Image. There?s also a Swing class
>>> the does something similar (e.g. Swing.namedWindow(...) in the project.
>>>
>>> Good Luck
>>>
>>> ? Brian Schlining
>>>
>>
>>
>> _______________________________________________
>> ImageJ-devel mailing list
>> ImageJ-devel at imagej.net
>> http://imagej.net/mailman/listinfo/imagej-devel
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://imagej.net/pipermail/imagej-devel/attachments/20150420/452029ec/attachment.html>

From ctrueden at wisc.edu  Mon Apr 20 15:25:35 2015
From: ctrueden at wisc.edu (Curtis Rueden)
Date: Mon, 20 Apr 2015 15:25:35 -0500
Subject: [ImageJ-devel] Performing convolution using ImageJ2
In-Reply-To: <1429523616.6666.3.camel@biomedical-imaging.de>
References: <1429523616.6666.3.camel@biomedical-imaging.de>
Message-ID: <CADN69ymhd+Nc=6k7gaHJVsLOY8PihNiyd_k27j1RX+pDq2PSog@mail.gmail.com>

Hi Thorsten,

> I try to perform a simple convolution using imagej2. Unfortunately, it
> failed!

The exception you receive is because you are creating a new ImageJ
application context, rather than reusing the existing one. This happens
because you write:

   final ImageJ ij = new ImageJ();

The handle to the existing context can be obtained in one of two ways:

1) If you are writing an ImageJ1 plugin (e.g., an ij.plugin.Plugin), then
you can write:

    // retrieve the ImageJ application context
    final Context context = (Context) IJ.runPlugIn("org.scijava.Context",
"");
    final ImageJ ij = new ImageJ(context);

2) If you are writing an ImageJ2 plugin, then you can write:

    @Parameter
    private OpService ops

And just call "ops.convolve(...)" in your code.

Or if you really want the "ImageJ" object, you can write:

    @Parameter
    private ImageJ ij;

See also:
https://github.com/imagej/imagej-tutorials/

Regards,
Curtis

On Mon, Apr 20, 2015 at 4:53 AM, Thorsten Wagner <
wagner at biomedical-imaging.de> wrote:

> Dear list,
>
> I try to perform a simple convolution using imagej2. Unfortunately, it
> failed!
>
> This is my code:
> http://pastebin.com/CqBgcLXd
>
> This is the exception:
> http://pastebin.com/KHkeGGAJ
>
> I would be grateful for any help.
>
> Regards,
> Thorsten
>
> _______________________________________________
> ImageJ-devel mailing list
> ImageJ-devel at imagej.net
> http://imagej.net/mailman/listinfo/imagej-devel
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://imagej.net/pipermail/imagej-devel/attachments/20150420/af19a493/attachment.html>

From bnorthan at gmail.com  Tue Apr 21 08:13:54 2015
From: bnorthan at gmail.com (Brian Northan)
Date: Tue, 21 Apr 2015 09:13:54 -0400
Subject: [ImageJ-devel] Performing convolution using ImageJ2
In-Reply-To: <CADN69ymhd+Nc=6k7gaHJVsLOY8PihNiyd_k27j1RX+pDq2PSog@mail.gmail.com>
References: <1429523616.6666.3.camel@biomedical-imaging.de>
	<CADN69ymhd+Nc=6k7gaHJVsLOY8PihNiyd_k27j1RX+pDq2PSog@mail.gmail.com>
Message-ID: <CAMWa8i2vjdEG2WVjJroPqDAioyMcpUytFyphrVMFD1dGUXgGqw@mail.gmail.com>

Hi Thorsten

I'm working on a convolution tutorial for imagej-tutorials.  (Though it
looks like you are almost there anyway)

https://github.com/imagej/imagej-tutorials/blob/convolution/using-ops/src/main/java/ConvolutionOps.java

A couple of things to note for small kernels

1.  For small kernels there is no practical need to use "borderSize".
Under the hood the default border size is set to kernelSize/2.  The border
size can be used if the kernel is very large.  In that case you could force
it to use a smaller border size to improve speed (the trade off would be
the possibility of edge artifacts).

2.  The fast convolution for small symmetric kernels has not been
implemented in ops yet (it is a matter of wrapping code from imglib2).
However long term it will be, and that will make ops very powerful.   A
high level programmer will not have to worry about that detail.  Under the
hood ops will choose the correct type of convolution based on the kernel.

Brian

On Mon, Apr 20, 2015 at 4:25 PM, Curtis Rueden <ctrueden at wisc.edu> wrote:

> Hi Thorsten,
>
> > I try to perform a simple convolution using imagej2. Unfortunately, it
> > failed!
>
> The exception you receive is because you are creating a new ImageJ
> application context, rather than reusing the existing one. This happens
> because you write:
>
>    final ImageJ ij = new ImageJ();
>
> The handle to the existing context can be obtained in one of two ways:
>
> 1) If you are writing an ImageJ1 plugin (e.g., an ij.plugin.Plugin), then
> you can write:
>
>     // retrieve the ImageJ application context
>     final Context context = (Context) IJ.runPlugIn("org.scijava.Context",
> "");
>     final ImageJ ij = new ImageJ(context);
>
> 2) If you are writing an ImageJ2 plugin, then you can write:
>
>     @Parameter
>     private OpService ops
>
> And just call "ops.convolve(...)" in your code.
>
> Or if you really want the "ImageJ" object, you can write:
>
>     @Parameter
>     private ImageJ ij;
>
> See also:
> https://github.com/imagej/imagej-tutorials/
>
> Regards,
> Curtis
>
> On Mon, Apr 20, 2015 at 4:53 AM, Thorsten Wagner <
> wagner at biomedical-imaging.de> wrote:
>
>> Dear list,
>>
>> I try to perform a simple convolution using imagej2. Unfortunately, it
>> failed!
>>
>> This is my code:
>> http://pastebin.com/CqBgcLXd
>>
>> This is the exception:
>> http://pastebin.com/KHkeGGAJ
>>
>> I would be grateful for any help.
>>
>> Regards,
>> Thorsten
>>
>> _______________________________________________
>> ImageJ-devel mailing list
>> ImageJ-devel at imagej.net
>> http://imagej.net/mailman/listinfo/imagej-devel
>>
>
>
> _______________________________________________
> ImageJ-devel mailing list
> ImageJ-devel at imagej.net
> http://imagej.net/mailman/listinfo/imagej-devel
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://imagej.net/pipermail/imagej-devel/attachments/20150421/89458cab/attachment.html>

From wagner at biomedical-imaging.de  Tue Apr 21 08:35:38 2015
From: wagner at biomedical-imaging.de (Thorsten Wagner)
Date: Tue, 21 Apr 2015 15:35:38 +0200
Subject: [ImageJ-devel] Performing convolution using ImageJ2
In-Reply-To: <CAMWa8i2vjdEG2WVjJroPqDAioyMcpUytFyphrVMFD1dGUXgGqw@mail.gmail.com>
References: <1429523616.6666.3.camel@biomedical-imaging.de>
	<CADN69ymhd+Nc=6k7gaHJVsLOY8PihNiyd_k27j1RX+pDq2PSog@mail.gmail.com>
	<CAMWa8i2vjdEG2WVjJroPqDAioyMcpUytFyphrVMFD1dGUXgGqw@mail.gmail.com>
Message-ID: <1429623338.6212.5.camel@biomedical-imaging.de>

Dear Brian,
thank you for the link! I'm approaching to a solution. However, I
followed your tutorial but I stell get a exception:
http://pastebin.com/vn84LCXx
That's my code:
http://pastebin.com/jeuXaycN
What I'm doing wrong?
Cheers,
Thorsten
> On Mon, Apr 20, 2015 at 4:25 PM, Curtis Rueden <ctrueden at wisc.edu>
> wrote:
> > Hi Thorsten,
> > 
> > > I try to perform a simple convolution using imagej2.
> > Unfortunately, it
> > > failed!
> > 
> > The exception you receive is because you are creating a new ImageJ
> > application context, rather than reusing the existing one. This
> > happens because you write:
> > 
> >    final ImageJ ij = new ImageJ();
> > 
> > The handle to the existing context can be obtained in one of two
> > ways:
> > 
> > 1) If you are writing an ImageJ1 plugin (e.g., an
> > ij.plugin.Plugin), then you can write:
> > 
> >     // retrieve the ImageJ application context
> >     final Context context = (Context)
> > IJ.runPlugIn("org.scijava.Context", "");
> >     final ImageJ ij = new ImageJ(context);
> > 
> > 2) If you are writing an ImageJ2 plugin, then you can write:
> > 
> >     @Parameter
> >     private OpService ops
> > 
> > And just call "ops.convolve(...)" in your code.
> > 
> > Or if you really want the "ImageJ" object, you can write:
> > 
> >     @Parameter
> >     private ImageJ ij;
> > 
> > See also:
> > https://github.com/imagej/imagej-tutorials/
> > 
> > Regards,
> > Curtis
> > 
> > On Mon, Apr 20, 2015 at 4:53 AM, Thorsten Wagner <
> > wagner at biomedical-imaging.de> wrote:
> > > Dear list,
> > > 
> > > I try to perform a simple convolution using imagej2.
> > > Unfortunately, it
> > > failed!
> > > 
> > > This is my code:
> > > http://pastebin.com/CqBgcLXd
> > > 
> > > This is the exception:
> > > http://pastebin.com/KHkeGGAJ
> > > 
> > > I would be grateful for any help.
> > > 
> > > Regards,
> > > Thorsten
> > > 
> > > _______________________________________________
> > > ImageJ-devel mailing list
> > > ImageJ-devel at imagej.net
> > > http://imagej.net/mailman/listinfo/imagej-devel
> > > 
> > 
> > _______________________________________________
> > ImageJ-devel mailing list
> > ImageJ-devel at imagej.net
> > http://imagej.net/mailman/listinfo/imagej-devel
> > 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://imagej.net/pipermail/imagej-devel/attachments/20150421/ad5be15b/attachment.html>

From bnorthan at gmail.com  Tue Apr 21 10:56:06 2015
From: bnorthan at gmail.com (Brian Northan)
Date: Tue, 21 Apr 2015 11:56:06 -0400
Subject: [ImageJ-devel] Performing convolution using ImageJ2
In-Reply-To: <1429623338.6212.5.camel@biomedical-imaging.de>
References: <1429523616.6666.3.camel@biomedical-imaging.de>
	<CADN69ymhd+Nc=6k7gaHJVsLOY8PihNiyd_k27j1RX+pDq2PSog@mail.gmail.com>
	<CAMWa8i2vjdEG2WVjJroPqDAioyMcpUytFyphrVMFD1dGUXgGqw@mail.gmail.com>
	<1429623338.6212.5.camel@biomedical-imaging.de>
Message-ID: <CAMWa8i029MMhsH8iro-m_HQH_F44uNsOzRb09afp7Rv3D+PECQ@mail.gmail.com>

Hi Thorsten

Your code looks fine.  It is a problem in my convolution ops code.

I updated the convolution branch in tutorials to work with your use-case.

https://github.com/imagej/imagej-tutorials/blob/convolution/using-ops/src/main/java/ConvolutionOps.java

The problem was that the ops framework did not correctly choose
'NaiveConvolution' (direct convolution with small kernel).  Then even when
I forced it to (by referring to NaiveConvolution.class directly) it did not
extend the images properly (see
https://github.com/imagej/imagej-ops/issues/98)

If you get a chance let me know if this new example works.  The example is
now too complicated, but if it works for you I can spend some time this
week integrating this logic into the op (so you can write nice concise
code).

Brian

On Tue, Apr 21, 2015 at 9:35 AM, Thorsten Wagner <
wagner at biomedical-imaging.de> wrote:

> Dear Brian,
>
> thank you for the link! I'm approaching to a solution. However, I followed
> your tutorial but I stell get a exception:
> http://pastebin.com/vn84LCXx
>
> That's my code:
> http://pastebin.com/jeuXaycN
>
> What I'm doing wrong?
>
> Cheers,
> Thorsten
>
>
>
> On Mon, Apr 20, 2015 at 4:25 PM, Curtis Rueden <ctrueden at wisc.edu> wrote:
>
> Hi Thorsten,
>
> > I try to perform a simple convolution using imagej2. Unfortunately, it
> > failed!
>
> The exception you receive is because you are creating a new ImageJ
> application context, rather than reusing the existing one. This happens
> because you write:
>
>    final ImageJ ij = new ImageJ();
>
> The handle to the existing context can be obtained in one of two ways:
>
> 1) If you are writing an ImageJ1 plugin (e.g., an ij.plugin.Plugin), then
> you can write:
>
>     // retrieve the ImageJ application context
>     final Context context = (Context) IJ.runPlugIn("org.scijava.Context",
> "");
>     final ImageJ ij = new ImageJ(context);
>
> 2) If you are writing an ImageJ2 plugin, then you can write:
>
>     @Parameter
>     private OpService ops
>
> And just call "ops.convolve(...)" in your code.
>
> Or if you really want the "ImageJ" object, you can write:
>
>     @Parameter
>     private ImageJ ij;
>
> See also:
> https://github.com/imagej/imagej-tutorials/
>
> Regards,
> Curtis
>
> On Mon, Apr 20, 2015 at 4:53 AM, Thorsten Wagner <
> wagner at biomedical-imaging.de> wrote:
>
> Dear list,
>
> I try to perform a simple convolution using imagej2. Unfortunately, it
> failed!
>
> This is my code:
> http://pastebin.com/CqBgcLXd
>
> This is the exception:
> http://pastebin.com/KHkeGGAJ
>
> I would be grateful for any help.
>
> Regards,
> Thorsten
>
> _______________________________________________
> ImageJ-devel mailing list
> ImageJ-devel at imagej.net
> http://imagej.net/mailman/listinfo/imagej-devel
>
>
>
> _______________________________________________
> ImageJ-devel mailing list
> ImageJ-devel at imagej.net
> http://imagej.net/mailman/listinfo/imagej-devel
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://imagej.net/pipermail/imagej-devel/attachments/20150421/d3bcf3e2/attachment-0001.html>

From wagner at biomedical-imaging.de  Tue Apr 21 11:49:57 2015
From: wagner at biomedical-imaging.de (Thorsten Wagner)
Date: Tue, 21 Apr 2015 18:49:57 +0200
Subject: [ImageJ-devel] Performing convolution using ImageJ2
In-Reply-To: <CAMWa8i029MMhsH8iro-m_HQH_F44uNsOzRb09afp7Rv3D+PECQ@mail.gmail.com>
References: <1429523616.6666.3.camel@biomedical-imaging.de>
	<CADN69ymhd+Nc=6k7gaHJVsLOY8PihNiyd_k27j1RX+pDq2PSog@mail.gmail.com>
	<CAMWa8i2vjdEG2WVjJroPqDAioyMcpUytFyphrVMFD1dGUXgGqw@mail.gmail.com>
	<1429623338.6212.5.camel@biomedical-imaging.de>
	<CAMWa8i029MMhsH8iro-m_HQH_F44uNsOzRb09afp7Rv3D+PECQ@mail.gmail.com>
Message-ID: <1429634997.18851.1.camel@biomedical-imaging.de>

Dear Brian,
thank you for your efforts! Your example works perfectly! 
Thank you very much.
Cheers,
Thorsten
Am Dienstag, den 21.04.2015, 11:56 -0400 schrieb Brian Northan:
> Hi Thorsten
> 
> Your code looks fine.  It is a problem in my convolution ops code.
> 
> I updated the convolution branch in tutorials to work with your use
> -case.  
> 
> https://github.com/imagej/imagej-tutorials/blob/convolution/using
> -ops/src/main/java/ConvolutionOps.java
> 
> The problem was that the ops framework did not correctly choose
> 'NaiveConvolution' (direct convolution with small kernel).  Then
> even when I forced it to (by referring to NaiveConvolution.class
> directly) it did not extend the images properly (see 
> https://github.com/imagej/imagej-ops/issues/98)
> 
> If you get a chance let me know if this new example works.  The
> example is now too complicated, but if it works for you I can spend
> some time this week integrating this logic into the op (so you can
> write nice concise code). 
> 
> Brian
> 
> On Tue, Apr 21, 2015 at 9:35 AM, Thorsten Wagner <
> wagner at biomedical-imaging.de> wrote:
> > Dear Brian,
> > 
> > thank you for the link! I'm approaching to a solution. However, I
> > followed your tutorial but I stell get a exception:
> > http://pastebin.com/vn84LCXx
> > 
> > That's my code:
> > http://pastebin.com/jeuXaycN
> > 
> > What I'm doing wrong?
> > 
> > Cheers,
> > Thorsten
> > 
> > 
> > > 
> > > On Mon, Apr 20, 2015 at 4:25 PM, Curtis Rueden <ctrueden at wisc.edu
> > > > wrote:
> > > > Hi Thorsten,
> > > > 
> > > > > I try to perform a simple convolution using imagej2.
> > > > Unfortunately, it
> > > > > failed!
> > > > 
> > > > The exception you receive is because you are creating a new
> > > > ImageJ application context, rather than reusing the existing
> > > > one. This happens because you write:
> > > > 
> > > >    final ImageJ ij = new ImageJ();
> > > > 
> > > > The handle to the existing context can be obtained in one of
> > > > two ways:
> > > > 
> > > > 1) If you are writing an ImageJ1 plugin (e.g., an
> > > > ij.plugin.Plugin), then you can write:
> > > > 
> > > >     // retrieve the ImageJ application context
> > > >     final Context context = (Context)
> > > > IJ.runPlugIn("org.scijava.Context", "");
> > > >     final ImageJ ij = new ImageJ(context);
> > > > 
> > > > 2) If you are writing an ImageJ2 plugin, then you can write:
> > > > 
> > > >     @Parameter
> > > >     private OpService ops
> > > > 
> > > > And just call "ops.convolve(...)" in your code.
> > > > 
> > > > Or if you really want the "ImageJ" object, you can write:
> > > > 
> > > >     @Parameter
> > > >     private ImageJ ij;
> > > > 
> > > > See also:
> > > > https://github.com/imagej/imagej-tutorials/
> > > > 
> > > > Regards,
> > > > Curtis
> > > > 
> > > > On Mon, Apr 20, 2015 at 4:53 AM, Thorsten Wagner <
> > > > wagner at biomedical-imaging.de> wrote:
> > > > > Dear list,
> > > > > 
> > > > > I try to perform a simple convolution using imagej2.
> > > > > Unfortunately, it
> > > > > failed!
> > > > > 
> > > > > This is my code:
> > > > > http://pastebin.com/CqBgcLXd
> > > > > 
> > > > > This is the exception:
> > > > > http://pastebin.com/KHkeGGAJ
> > > > > 
> > > > > I would be grateful for any help.
> > > > > 
> > > > > Regards,
> > > > > Thorsten
> > > > > 
> > > > > _______________________________________________
> > > > > ImageJ-devel mailing list
> > > > > ImageJ-devel at imagej.net
> > > > > http://imagej.net/mailman/listinfo/imagej-devel
> > > > > 
> > > > 
> > > > _______________________________________________
> > > > ImageJ-devel mailing list
> > > > ImageJ-devel at imagej.net
> > > > http://imagej.net/mailman/listinfo/imagej-devel
> > > > 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://imagej.net/pipermail/imagej-devel/attachments/20150421/c5580c0a/attachment.html>

From johannes.schindelin at gmx.de  Thu Apr 23 01:33:59 2015
From: johannes.schindelin at gmx.de (Johannes Schindelin)
Date: Thu, 23 Apr 2015 08:33:59 +0200
Subject: [ImageJ-devel] Performance benchmarking
Message-ID: <d61bb5329e51439f2b9290d2e54a74ad@www.dscho.org>

Hi everyone,

while researching something completely different, I stumbled upon this 
very informative mail about performance benchmarking in Java. Just in 
case anybody still thought that the Not Invented Here approach cannot be 
*all* that bad, here is some news you won't like, and which you are of 
course free to ignore:

https://groups.google.com/forum/#!msg/mechanical-sympathy/m4opvy4xq3U/7lY8x8SvHgwJ

Enjoy,
Johannes


From jan.eglinger at gmail.com  Mon Apr 27 08:58:18 2015
From: jan.eglinger at gmail.com (Jan Eglinger)
Date: Mon, 27 Apr 2015 15:58:18 +0200
Subject: [ImageJ-devel] ImageJ2 scripting
Message-ID: <553E407A.1060109@gmail.com>

Dear all,

*** TL;DR:
How do I proceed to get multiple input Datasets as ImageJ2 parameters 
from open images in Fiji?
***

I was recently exploring ImageJ2 scripting in Fiji and found the 
OpsThresholdIJ1Analyze template [1] in the script editor very helpful.

When trying to get more than one @net.imagej.Dataset input parameter 
however, I noticed some inconsistencies.
Let me try to illustrate with the two following scripts:

     # @DisplayService display
     # @OpService ops
     # @net.imagej.Dataset inputData1

     from net.imglib2.meta import ImgPlus

     display.createDisplay("my1", ImgPlus(inputData1))


The above script re-displays the current image as expected (I tried with 
the Blobs sample image open, which will be re-displayed with a 
non-inverted LUT.)

When I ask for two input datasets (right after a fresh start of Fiji 
with only the Blobs sample image open):

     # @DisplayService display
     # @OpService ops
     # @net.imagej.Dataset inputData1
     # @net.imagej.Dataset inputData2

     from net.imglib2.meta import ImgPlus

     display.createDisplay("my1", ImgPlus(inputData1))
     display.createDisplay("my2", ImgPlus(inputData2))

an error message is displayed: "A Dataset is required but none exist."
The same error message is displayed when I open a second image in Fiji 
before running the script.

Now, when I run script #2 after script #1 was run at least once, I get a 
dialog with two choices "InputData1" and "InputData2", both choice 
fields containing "blobs.gif" and a number of "Untitled" entries (where 
can this title be set, by the way?).

I guess that a choice is only displayed if there are ImageJ2 datasets 
(i.e. wrapped ImagePlus) already available. The single input case seems 
to be special-cased as it auto-wraps the currently open image.

So how do I proceed to get more than one input in ImageJ2 scripting from 
open (ImageJ1-)images?

Thanks for your advice,
Regards,
Jan


[1]: 
https://github.com/imagej/imagej-legacy/blob/master/src/main/resources/script_templates/Python/OpsThresholdIJ1Analyze.py


From hiner at wisc.edu  Mon Apr 27 13:23:51 2015
From: hiner at wisc.edu (Mark Hiner)
Date: Mon, 27 Apr 2015 13:23:51 -0500
Subject: [ImageJ-devel] ImageJ2 scripting
In-Reply-To: <553E407A.1060109@gmail.com>
References: <553E407A.1060109@gmail.com>
Message-ID: <CA+B=mGrtvuBveowm=OckmNR+giR-jQ1fPoFCpOAbQL_x=-gLFA@mail.gmail.com>

Hi Jan,

>an error message is displayed: "A Dataset is required but none exist."

This was due to limitations with the input preprocessor presenting the list
of datasets. Since ImagePluses aren't explicitly tracked by the IJ2
framework, having an ImagePlus recognized as a Dataset requires some extra
layers. We had covered the single input case (which is why your first
script worked) but not the general multi-input case. There is an issue
tracking the multi-input
<https://github.com/imagej/imagej-legacy/issues/106> case, which I resolved
today. So this should work as intended in our next release - and thank you
for the motivation to wrap this up!

You can also manually enable ImagePlus <> Dataset synchronization to ensure
ImagePluses always have a corresponding Dataset:
http://imagej.net/Compatibility#Translation_of_data_structures

>(where can this title be set, by the way?)

For the multiple choice input selection, the labels are based on the name
of the input type. Since the input type is Dataset, the Dataset name is
used (which delegates to the wrapped ImgPlus). In your code you are
applying labels to the Display, but not the underlying dataset - if you
name the ImgPlus, or explicitly create a Dataset and set its name, that
name will propagate up to the input chooser (and the Display). As a side
note, you should use the net.imagej.ImgPlus instead of the net.imglib2.meta.

An updated script would be:


   # @DisplayService display
   # @OpService ops
   # @net.imagej.Dataset inputData1
   # @net.imagej.Dataset inputData2

   from net.imagej import ImgPlus

   display.createDisplay(ImgPlus(inputData1, "my1"))
   display.createDisplay(ImgPlus(inputData2, "my2"))

Hope that helps. Let me know if you have any other questions.

Best,
Mark

On Mon, Apr 27, 2015 at 8:58 AM, Jan Eglinger <jan.eglinger at gmail.com>
wrote:

> Dear all,
>
> *** TL;DR:
> How do I proceed to get multiple input Datasets as ImageJ2 parameters from
> open images in Fiji?
> ***
>
> I was recently exploring ImageJ2 scripting in Fiji and found the
> OpsThresholdIJ1Analyze template [1] in the script editor very helpful.
>
> When trying to get more than one @net.imagej.Dataset input parameter
> however, I noticed some inconsistencies.
> Let me try to illustrate with the two following scripts:
>
>     # @DisplayService display
>     # @OpService ops
>     # @net.imagej.Dataset inputData1
>
>     from net.imglib2.meta import ImgPlus
>
>     display.createDisplay("my1", ImgPlus(inputData1))
>
>
> The above script re-displays the current image as expected (I tried with
> the Blobs sample image open, which will be re-displayed with a non-inverted
> LUT.)
>
> When I ask for two input datasets (right after a fresh start of Fiji with
> only the Blobs sample image open):
>
>     # @DisplayService display
>     # @OpService ops
>     # @net.imagej.Dataset inputData1
>     # @net.imagej.Dataset inputData2
>
>     from net.imglib2.meta import ImgPlus
>
>     display.createDisplay("my1", ImgPlus(inputData1))
>     display.createDisplay("my2", ImgPlus(inputData2))
>
> an error message is displayed: "A Dataset is required but none exist."
> The same error message is displayed when I open a second image in Fiji
> before running the script.
>
> Now, when I run script #2 after script #1 was run at least once, I get a
> dialog with two choices "InputData1" and "InputData2", both choice fields
> containing "blobs.gif" and a number of "Untitled" entries (where can this
> title be set, by the way?).
>
> I guess that a choice is only displayed if there are ImageJ2 datasets
> (i.e. wrapped ImagePlus) already available. The single input case seems to
> be special-cased as it auto-wraps the currently open image.
>
> So how do I proceed to get more than one input in ImageJ2 scripting from
> open (ImageJ1-)images?
>
> Thanks for your advice,
> Regards,
> Jan
>
>
> [1]:
> https://github.com/imagej/imagej-legacy/blob/master/src/main/resources/script_templates/Python/OpsThresholdIJ1Analyze.py
>
> _______________________________________________
> ImageJ-devel mailing list
> ImageJ-devel at imagej.net
> http://imagej.net/mailman/listinfo/imagej-devel
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://imagej.net/pipermail/imagej-devel/attachments/20150427/670d5e03/attachment.html>

From ctrueden at wisc.edu  Mon Apr 27 13:42:09 2015
From: ctrueden at wisc.edu (Curtis Rueden)
Date: Mon, 27 Apr 2015 13:42:09 -0500
Subject: [ImageJ-devel] ImageJ2 scripting
In-Reply-To: <CA+B=mGrtvuBveowm=OckmNR+giR-jQ1fPoFCpOAbQL_x=-gLFA@mail.gmail.com>
References: <553E407A.1060109@gmail.com>
	<CA+B=mGrtvuBveowm=OckmNR+giR-jQ1fPoFCpOAbQL_x=-gLFA@mail.gmail.com>
Message-ID: <CADN69ymDzgbcrHBKy+9+FQj0LM9i479ueZCr4Ziz2fJJaEGoGw@mail.gmail.com>

Hi Jan,

Here is another version of the script, which avoids wrapping each Dataset
in another ImgPlus (which the framework would then wrap into yet another
Dataset....):

   # @DisplayService display
   # @OpService ops
   # @net.imagej.Dataset inputData1
   # @net.imagej.Dataset inputData2

   inputData1.setName("my1")
   inputData2.setName("my2")
   display.createDisplay(inputData1)
   display.createDisplay(inputData2)

But note that you also don't need to explicitly call createDisplay. Any
output parameters of your script will automatically have displays created
for them. E.g.:

   # @OUTPUT net.imagej.Dataset outputData

Will be shown at the conclusion of the script.

Apologies for the appalling lack of documentation -- it would be great to
flesh out the wiki docs about all this.

HTH,
Curtis

On Mon, Apr 27, 2015 at 1:23 PM, Mark Hiner <hiner at wisc.edu> wrote:

> Hi Jan,
>
> >an error message is displayed: "A Dataset is required but none exist."
>
> This was due to limitations with the input preprocessor presenting the
> list of datasets. Since ImagePluses aren't explicitly tracked by the IJ2
> framework, having an ImagePlus recognized as a Dataset requires some extra
> layers. We had covered the single input case (which is why your first
> script worked) but not the general multi-input case. There is an issue
> tracking the multi-input
> <https://github.com/imagej/imagej-legacy/issues/106> case, which I
> resolved today. So this should work as intended in our next release - and
> thank you for the motivation to wrap this up!
>
> You can also manually enable ImagePlus <> Dataset synchronization to
> ensure ImagePluses always have a corresponding Dataset:
> http://imagej.net/Compatibility#Translation_of_data_structures
>
> >(where can this title be set, by the way?)
>
> For the multiple choice input selection, the labels are based on the name
> of the input type. Since the input type is Dataset, the Dataset name is
> used (which delegates to the wrapped ImgPlus). In your code you are
> applying labels to the Display, but not the underlying dataset - if you
> name the ImgPlus, or explicitly create a Dataset and set its name, that
> name will propagate up to the input chooser (and the Display). As a side
> note, you should use the net.imagej.ImgPlus instead of the net.imglib2.meta.
>
> An updated script would be:
>
>
>    # @DisplayService display
>    # @OpService ops
>    # @net.imagej.Dataset inputData1
>    # @net.imagej.Dataset inputData2
>
>    from net.imagej import ImgPlus
>
>    display.createDisplay(ImgPlus(inputData1, "my1"))
>    display.createDisplay(ImgPlus(inputData2, "my2"))
>
> Hope that helps. Let me know if you have any other questions.
>
> Best,
> Mark
>
> On Mon, Apr 27, 2015 at 8:58 AM, Jan Eglinger <jan.eglinger at gmail.com>
> wrote:
>
>> Dear all,
>>
>> *** TL;DR:
>> How do I proceed to get multiple input Datasets as ImageJ2 parameters
>> from open images in Fiji?
>> ***
>>
>> I was recently exploring ImageJ2 scripting in Fiji and found the
>> OpsThresholdIJ1Analyze template [1] in the script editor very helpful.
>>
>> When trying to get more than one @net.imagej.Dataset input parameter
>> however, I noticed some inconsistencies.
>> Let me try to illustrate with the two following scripts:
>>
>>     # @DisplayService display
>>     # @OpService ops
>>     # @net.imagej.Dataset inputData1
>>
>>     from net.imglib2.meta import ImgPlus
>>
>>     display.createDisplay("my1", ImgPlus(inputData1))
>>
>>
>> The above script re-displays the current image as expected (I tried with
>> the Blobs sample image open, which will be re-displayed with a non-inverted
>> LUT.)
>>
>> When I ask for two input datasets (right after a fresh start of Fiji with
>> only the Blobs sample image open):
>>
>>     # @DisplayService display
>>     # @OpService ops
>>     # @net.imagej.Dataset inputData1
>>     # @net.imagej.Dataset inputData2
>>
>>     from net.imglib2.meta import ImgPlus
>>
>>     display.createDisplay("my1", ImgPlus(inputData1))
>>     display.createDisplay("my2", ImgPlus(inputData2))
>>
>> an error message is displayed: "A Dataset is required but none exist."
>> The same error message is displayed when I open a second image in Fiji
>> before running the script.
>>
>> Now, when I run script #2 after script #1 was run at least once, I get a
>> dialog with two choices "InputData1" and "InputData2", both choice fields
>> containing "blobs.gif" and a number of "Untitled" entries (where can this
>> title be set, by the way?).
>>
>> I guess that a choice is only displayed if there are ImageJ2 datasets
>> (i.e. wrapped ImagePlus) already available. The single input case seems to
>> be special-cased as it auto-wraps the currently open image.
>>
>> So how do I proceed to get more than one input in ImageJ2 scripting from
>> open (ImageJ1-)images?
>>
>> Thanks for your advice,
>> Regards,
>> Jan
>>
>>
>> [1]:
>> https://github.com/imagej/imagej-legacy/blob/master/src/main/resources/script_templates/Python/OpsThresholdIJ1Analyze.py
>>
>> _______________________________________________
>> ImageJ-devel mailing list
>> ImageJ-devel at imagej.net
>> http://imagej.net/mailman/listinfo/imagej-devel
>>
>
>
> _______________________________________________
> ImageJ-devel mailing list
> ImageJ-devel at imagej.net
> http://imagej.net/mailman/listinfo/imagej-devel
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://imagej.net/pipermail/imagej-devel/attachments/20150427/4122953b/attachment.html>

From jan.eglinger at gmail.com  Tue Apr 28 02:03:55 2015
From: jan.eglinger at gmail.com (Jan Eglinger)
Date: Tue, 28 Apr 2015 09:03:55 +0200
Subject: [ImageJ-devel] ImageJ2 scripting
In-Reply-To: <CADN69ymDzgbcrHBKy+9+FQj0LM9i479ueZCr4Ziz2fJJaEGoGw@mail.gmail.com>
References: <553E407A.1060109@gmail.com>
	<CA+B=mGrtvuBveowm=OckmNR+giR-jQ1fPoFCpOAbQL_x=-gLFA@mail.gmail.com>
	<CADN69ymDzgbcrHBKy+9+FQj0LM9i479ueZCr4Ziz2fJJaEGoGw@mail.gmail.com>
Message-ID: <553F30DB.4080501@gmail.com>

Dear Mark and Curtis,

thank you very much for the quick replies and helpful pointers!

Jan


On 27.04.2015 20:42, Curtis Rueden wrote:
> Hi Jan,
>
> Here is another version of the script, which avoids wrapping each
> Dataset in another ImgPlus (which the framework would then wrap into yet
> another Dataset....):
>
>     # @DisplayService display
>     # @OpService ops
>     # @net.imagej.Dataset inputData1
>     # @net.imagej.Dataset inputData2
>
>     inputData1.setName("my1")
>     inputData2.setName("my2")
>     display.createDisplay(inputData1)
>     display.createDisplay(inputData2)
>
> But note that you also don't need to explicitly call createDisplay. Any
> output parameters of your script will automatically have displays
> created for them. E.g.:
>
>     # @OUTPUT net.imagej.Dataset outputData
>
> Will be shown at the conclusion of the script.
>
> Apologies for the appalling lack of documentation -- it would be great
> to flesh out the wiki docs about all this.
>
> HTH,
> Curtis
>
> On Mon, Apr 27, 2015 at 1:23 PM, Mark Hiner <hiner at wisc.edu
> <mailto:hiner at wisc.edu>> wrote:
>
>     Hi Jan,
>
>     >an error message is displayed: "A Dataset is required but none exist."
>
>     This was due to limitations with the input preprocessor presenting
>     the list of datasets. Since ImagePluses aren't explicitly tracked by
>     the IJ2 framework, having an ImagePlus recognized as a Dataset
>     requires some extra layers. We had covered the single input case
>     (which is why your first script worked) but not the general
>     multi-input case. There is an issue tracking the multi-input
>     <https://github.com/imagej/imagej-legacy/issues/106> case, which I
>     resolved today. So this should work as intended in our next release
>     - and thank you for the motivation to wrap this up!
>
>     You can also manually enable ImagePlus <> Dataset synchronization to
>     ensure ImagePluses always have a corresponding Dataset:
>     http://imagej.net/Compatibility#Translation_of_data_structures
>
>     >(where can this title be set, by the way?)
>
>     For the multiple choice input selection, the labels are based on the
>     name of the input type. Since the input type is Dataset, the Dataset
>     name is used (which delegates to the wrapped ImgPlus). In your code
>     you are applying labels to the Display, but not the underlying
>     dataset - if you name the ImgPlus, or explicitly create a Dataset
>     and set its name, that name will propagate up to the input chooser
>     (and the Display). As a side note, you should use the
>     net.imagej.ImgPlus instead of the net.imglib2.meta.
>
>     An updated script would be:
>
>
>         # @DisplayService display
>         # @OpService ops
>         # @net.imagej.Dataset inputData1
>         # @net.imagej.Dataset inputData2
>
>         from net.imagej import ImgPlus
>
>         display.createDisplay(ImgPlus(inputData1, "my1"))
>         display.createDisplay(ImgPlus(inputData2, "my2"))
>
>     Hope that helps. Let me know if you have any other questions.
>
>     Best,
>     Mark
>
>     On Mon, Apr 27, 2015 at 8:58 AM, Jan Eglinger
>     <jan.eglinger at gmail.com <mailto:jan.eglinger at gmail.com>> wrote:
>
>         Dear all,
>
>         *** TL;DR:
>         How do I proceed to get multiple input Datasets as ImageJ2
>         parameters from open images in Fiji?
>         ***
>
>         I was recently exploring ImageJ2 scripting in Fiji and found the
>         OpsThresholdIJ1Analyze template [1] in the script editor very
>         helpful.
>
>         When trying to get more than one @net.imagej.Dataset input
>         parameter however, I noticed some inconsistencies.
>         Let me try to illustrate with the two following scripts:
>
>              # @DisplayService display
>              # @OpService ops
>              # @net.imagej.Dataset inputData1
>
>              from net.imglib2.meta import ImgPlus
>
>              display.createDisplay("my1", ImgPlus(inputData1))
>
>
>         The above script re-displays the current image as expected (I
>         tried with the Blobs sample image open, which will be
>         re-displayed with a non-inverted LUT.)
>
>         When I ask for two input datasets (right after a fresh start of
>         Fiji with only the Blobs sample image open):
>
>              # @DisplayService display
>              # @OpService ops
>              # @net.imagej.Dataset inputData1
>              # @net.imagej.Dataset inputData2
>
>              from net.imglib2.meta import ImgPlus
>
>              display.createDisplay("my1", ImgPlus(inputData1))
>              display.createDisplay("my2", ImgPlus(inputData2))
>
>         an error message is displayed: "A Dataset is required but none
>         exist."
>         The same error message is displayed when I open a second image
>         in Fiji before running the script.
>
>         Now, when I run script #2 after script #1 was run at least once,
>         I get a dialog with two choices "InputData1" and "InputData2",
>         both choice fields containing "blobs.gif" and a number of
>         "Untitled" entries (where can this title be set, by the way?).
>
>         I guess that a choice is only displayed if there are ImageJ2
>         datasets (i.e. wrapped ImagePlus) already available. The single
>         input case seems to be special-cased as it auto-wraps the
>         currently open image.
>
>         So how do I proceed to get more than one input in ImageJ2
>         scripting from open (ImageJ1-)images?
>
>         Thanks for your advice,
>         Regards,
>         Jan
>
>
>         [1]:
>         https://github.com/imagej/imagej-legacy/blob/master/src/main/resources/script_templates/Python/OpsThresholdIJ1Analyze.py
>


From jan.eglinger at gmail.com  Tue Apr 28 10:53:21 2015
From: jan.eglinger at gmail.com (Jan Eglinger)
Date: Tue, 28 Apr 2015 17:53:21 +0200
Subject: [ImageJ-devel] ImageJ2 scripting
In-Reply-To: <553F30DB.4080501@gmail.com>
References: <553E407A.1060109@gmail.com>
	<CA+B=mGrtvuBveowm=OckmNR+giR-jQ1fPoFCpOAbQL_x=-gLFA@mail.gmail.com>
	<CADN69ymDzgbcrHBKy+9+FQj0LM9i479ueZCr4Ziz2fJJaEGoGw@mail.gmail.com>
	<553F30DB.4080501@gmail.com>
Message-ID: <553FACF1.80208@gmail.com>

Hi all,

some follow-up questions regarding imagej-ops:

I tried to use some basic ops in python. From the 2014 wiki announcement 
[1] and the python template [2], I assumed something like this would 
work in python:

     # @OpService ops
     # @DisplayService display

     blank = ops.create([100, 50])

     display.createDisplay(blank)

But a choice of candidate functions is listed in output:

**********************************************
Request:
-	createimg(
		Integer,
		Integer)

Candidates:
1. 	(Img output) =
	net.imagej.ops.create.DefaultCreateImg(
==>		Type outType?,
		ImgFactory fac?,
		long[] dims)
	Inconvertible type: java.lang.Integer => net.imglib2.type.Type<capture 
of ?>
2. 	(ImgPlus output) =
	net.imagej.ops.create.CreateEmptyImgCopy(
		ImgPlus input)
	Too many arguments: 2 > 1
3. 	(Img output) =
	net.imagej.ops.create.CreateImgNativeType(
		ImgFactory fac,
		NativeType outType,
		Dimensions dims)
	Not enough arguments: 2 < 3
4. 	(Img output) =
	net.imagej.ops.create.CreateImgDifferentNativeType(
==>		Img input,
		NativeType type)
	Inconvertible type: java.lang.Integer => net.imglib2.img.Img<capture of ?>
5. 	(ImgPlus output) =
	net.imagej.ops.create.CreateEmptyImgPlusCopy(
		ImgPlus input)
	Too many arguments: 2 > 1
**********************************************

and I am unsure if I have to provide image type and factory here.


Similarly, for the subtract op:

     # @OpService ops
     # @StatisticsService stats
     # @net.imagej.Dataset inData
     # @OUTPUT net.imagej.Dataset outData

     outData = inData.duplicate()

     mean = stats.alphaTrimmedMean(inData, 0)
     print mean

     ops.subtract(outData, inData, mean)

I am getting the following list of candidates:

**********************************************
Request:
-	math.subtract(
		DefaultDataset,
		DefaultDataset,
		Double)

Candidates:
1. 	(Object result) =
	net.imagej.ops.onthefly.ArithmeticOp$SubtractOp(
		Object result,
		Object a,
		Object b)
	Inputs do not conform to op rules
		result = blobs.gif
		a = blobs.gif
		b = 103.26857775590551
2. 	(int result) =
	net.imagej.ops.math.PrimitiveMath$IntegerSubtract(
		int a,
		int b)
	Too many arguments: 3 > 2
3. 	(long result) =
	net.imagej.ops.math.PrimitiveMath$LongSubtract(
		long a,
		long b)
	Too many arguments: 3 > 2
4. 	(float result) =
	net.imagej.ops.math.PrimitiveMath$FloatSubtract(
		float a,
		float b)
	Too many arguments: 3 > 2
5. 	(double result) =
	net.imagej.ops.math.PrimitiveMath$DoubleSubtract(
		double a,
		double b)
	Too many arguments: 3 > 2
6. 	(RealType out) =
	net.imagej.ops.arithmetic.real.RealSubtract(
==>		RealType out,
		RealType in,
		double constant)
	Inconvertible type: net.imagej.DefaultDataset => capture of ?
**********************************************

is there a way with the type-unsafe scripting languages to get ops to 
use the correct function? Or am I misunderstanding the concept of 
imagej-ops here?

Thanks again for any hints.

Jan


[1] http://fiji.sc/2014-04-04_-_Announcing_ImageJ_OPS
[2] 
https://github.com/imagej/imagej-legacy/blob/master/src/main/resources/script_templates/Python/OpsThresholdIJ1Analyze.py


On 28.04.2015 09:03, Jan Eglinger wrote:
> Dear Mark and Curtis,
>
> thank you very much for the quick replies and helpful pointers!
>
> Jan
>
>
> On 27.04.2015 20:42, Curtis Rueden wrote:
>> Hi Jan,
>>
>> Here is another version of the script, which avoids wrapping each
>> Dataset in another ImgPlus (which the framework would then wrap into yet
>> another Dataset....):
>>
>>     # @DisplayService display
>>     # @OpService ops
>>     # @net.imagej.Dataset inputData1
>>     # @net.imagej.Dataset inputData2
>>
>>     inputData1.setName("my1")
>>     inputData2.setName("my2")
>>     display.createDisplay(inputData1)
>>     display.createDisplay(inputData2)
>>
>> But note that you also don't need to explicitly call createDisplay. Any
>> output parameters of your script will automatically have displays
>> created for them. E.g.:
>>
>>     # @OUTPUT net.imagej.Dataset outputData
>>
>> Will be shown at the conclusion of the script.
>>
>> Apologies for the appalling lack of documentation -- it would be great
>> to flesh out the wiki docs about all this.
>>
>> HTH,
>> Curtis
>>
>> On Mon, Apr 27, 2015 at 1:23 PM, Mark Hiner <hiner at wisc.edu
>> <mailto:hiner at wisc.edu>> wrote:
>>
>>     Hi Jan,
>>
>>     >an error message is displayed: "A Dataset is required but none
>> exist."
>>
>>     This was due to limitations with the input preprocessor presenting
>>     the list of datasets. Since ImagePluses aren't explicitly tracked by
>>     the IJ2 framework, having an ImagePlus recognized as a Dataset
>>     requires some extra layers. We had covered the single input case
>>     (which is why your first script worked) but not the general
>>     multi-input case. There is an issue tracking the multi-input
>>     <https://github.com/imagej/imagej-legacy/issues/106> case, which I
>>     resolved today. So this should work as intended in our next release
>>     - and thank you for the motivation to wrap this up!
>>
>>     You can also manually enable ImagePlus <> Dataset synchronization to
>>     ensure ImagePluses always have a corresponding Dataset:
>>     http://imagej.net/Compatibility#Translation_of_data_structures
>>
>>     >(where can this title be set, by the way?)
>>
>>     For the multiple choice input selection, the labels are based on the
>>     name of the input type. Since the input type is Dataset, the Dataset
>>     name is used (which delegates to the wrapped ImgPlus). In your code
>>     you are applying labels to the Display, but not the underlying
>>     dataset - if you name the ImgPlus, or explicitly create a Dataset
>>     and set its name, that name will propagate up to the input chooser
>>     (and the Display). As a side note, you should use the
>>     net.imagej.ImgPlus instead of the net.imglib2.meta.
>>
>>     An updated script would be:
>>
>>
>>         # @DisplayService display
>>         # @OpService ops
>>         # @net.imagej.Dataset inputData1
>>         # @net.imagej.Dataset inputData2
>>
>>         from net.imagej import ImgPlus
>>
>>         display.createDisplay(ImgPlus(inputData1, "my1"))
>>         display.createDisplay(ImgPlus(inputData2, "my2"))
>>
>>     Hope that helps. Let me know if you have any other questions.
>>
>>     Best,
>>     Mark
>>
>>     On Mon, Apr 27, 2015 at 8:58 AM, Jan Eglinger
>>     <jan.eglinger at gmail.com <mailto:jan.eglinger at gmail.com>> wrote:
>>
>>         Dear all,
>>
>>         *** TL;DR:
>>         How do I proceed to get multiple input Datasets as ImageJ2
>>         parameters from open images in Fiji?
>>         ***
>>
>>         I was recently exploring ImageJ2 scripting in Fiji and found the
>>         OpsThresholdIJ1Analyze template [1] in the script editor very
>>         helpful.
>>
>>         When trying to get more than one @net.imagej.Dataset input
>>         parameter however, I noticed some inconsistencies.
>>         Let me try to illustrate with the two following scripts:
>>
>>              # @DisplayService display
>>              # @OpService ops
>>              # @net.imagej.Dataset inputData1
>>
>>              from net.imglib2.meta import ImgPlus
>>
>>              display.createDisplay("my1", ImgPlus(inputData1))
>>
>>
>>         The above script re-displays the current image as expected (I
>>         tried with the Blobs sample image open, which will be
>>         re-displayed with a non-inverted LUT.)
>>
>>         When I ask for two input datasets (right after a fresh start of
>>         Fiji with only the Blobs sample image open):
>>
>>              # @DisplayService display
>>              # @OpService ops
>>              # @net.imagej.Dataset inputData1
>>              # @net.imagej.Dataset inputData2
>>
>>              from net.imglib2.meta import ImgPlus
>>
>>              display.createDisplay("my1", ImgPlus(inputData1))
>>              display.createDisplay("my2", ImgPlus(inputData2))
>>
>>         an error message is displayed: "A Dataset is required but none
>>         exist."
>>         The same error message is displayed when I open a second image
>>         in Fiji before running the script.
>>
>>         Now, when I run script #2 after script #1 was run at least once,
>>         I get a dialog with two choices "InputData1" and "InputData2",
>>         both choice fields containing "blobs.gif" and a number of
>>         "Untitled" entries (where can this title be set, by the way?).
>>
>>         I guess that a choice is only displayed if there are ImageJ2
>>         datasets (i.e. wrapped ImagePlus) already available. The single
>>         input case seems to be special-cased as it auto-wraps the
>>         currently open image.
>>
>>         So how do I proceed to get more than one input in ImageJ2
>>         scripting from open (ImageJ1-)images?
>>
>>         Thanks for your advice,
>>         Regards,
>>         Jan
>>
>>
>>         [1]:
>>
>> https://github.com/imagej/imagej-legacy/blob/master/src/main/resources/script_templates/Python/OpsThresholdIJ1Analyze.py
>>
>>


From bnorthan at gmail.com  Tue Apr 28 11:03:25 2015
From: bnorthan at gmail.com (Brian Northan)
Date: Tue, 28 Apr 2015 12:03:25 -0400
Subject: [ImageJ-devel] ImageJ2 scripting
In-Reply-To: <553FACF1.80208@gmail.com>
References: <553E407A.1060109@gmail.com>
	<CA+B=mGrtvuBveowm=OckmNR+giR-jQ1fPoFCpOAbQL_x=-gLFA@mail.gmail.com>
	<CADN69ymDzgbcrHBKy+9+FQj0LM9i479ueZCr4Ziz2fJJaEGoGw@mail.gmail.com>
	<553F30DB.4080501@gmail.com> <553FACF1.80208@gmail.com>
Message-ID: <CAMWa8i1dqDjcRqt+PngvHktHO4jQqD5rjohmkuxTXPeBU5320Q@mail.gmail.com>

Hi Jan

The following might work for the create op -- it takes a java array not a
python list....

from jarray import array
blank=ops.createimg(array([100, 50], 'l'))

Brian



On Tue, Apr 28, 2015 at 11:53 AM, Jan Eglinger <jan.eglinger at gmail.com>
wrote:

> Hi all,
>
> some follow-up questions regarding imagej-ops:
>
> I tried to use some basic ops in python. From the 2014 wiki announcement
> [1] and the python template [2], I assumed something like this would work
> in python:
>
>     # @OpService ops
>     # @DisplayService display
>
>     blank = ops.create([100, 50])
>
>     display.createDisplay(blank)
>
> But a choice of candidate functions is listed in output:
>
> **********************************************
> Request:
> -       createimg(
>                 Integer,
>                 Integer)
>
> Candidates:
> 1.      (Img output) =
>         net.imagej.ops.create.DefaultCreateImg(
> ==>             Type outType?,
>                 ImgFactory fac?,
>                 long[] dims)
>         Inconvertible type: java.lang.Integer =>
> net.imglib2.type.Type<capture of ?>
> 2.      (ImgPlus output) =
>         net.imagej.ops.create.CreateEmptyImgCopy(
>                 ImgPlus input)
>         Too many arguments: 2 > 1
> 3.      (Img output) =
>         net.imagej.ops.create.CreateImgNativeType(
>                 ImgFactory fac,
>                 NativeType outType,
>                 Dimensions dims)
>         Not enough arguments: 2 < 3
> 4.      (Img output) =
>         net.imagej.ops.create.CreateImgDifferentNativeType(
> ==>             Img input,
>                 NativeType type)
>         Inconvertible type: java.lang.Integer =>
> net.imglib2.img.Img<capture of ?>
> 5.      (ImgPlus output) =
>         net.imagej.ops.create.CreateEmptyImgPlusCopy(
>                 ImgPlus input)
>         Too many arguments: 2 > 1
> **********************************************
>
> and I am unsure if I have to provide image type and factory here.
>
>
> Similarly, for the subtract op:
>
>     # @OpService ops
>     # @StatisticsService stats
>     # @net.imagej.Dataset inData
>     # @OUTPUT net.imagej.Dataset outData
>
>     outData = inData.duplicate()
>
>     mean = stats.alphaTrimmedMean(inData, 0)
>     print mean
>
>     ops.subtract(outData, inData, mean)
>
> I am getting the following list of candidates:
>
> **********************************************
> Request:
> -       math.subtract(
>                 DefaultDataset,
>                 DefaultDataset,
>                 Double)
>
> Candidates:
> 1.      (Object result) =
>         net.imagej.ops.onthefly.ArithmeticOp$SubtractOp(
>                 Object result,
>                 Object a,
>                 Object b)
>         Inputs do not conform to op rules
>                 result = blobs.gif
>                 a = blobs.gif
>                 b = 103.26857775590551
> 2.      (int result) =
>         net.imagej.ops.math.PrimitiveMath$IntegerSubtract(
>                 int a,
>                 int b)
>         Too many arguments: 3 > 2
> 3.      (long result) =
>         net.imagej.ops.math.PrimitiveMath$LongSubtract(
>                 long a,
>                 long b)
>         Too many arguments: 3 > 2
> 4.      (float result) =
>         net.imagej.ops.math.PrimitiveMath$FloatSubtract(
>                 float a,
>                 float b)
>         Too many arguments: 3 > 2
> 5.      (double result) =
>         net.imagej.ops.math.PrimitiveMath$DoubleSubtract(
>                 double a,
>                 double b)
>         Too many arguments: 3 > 2
> 6.      (RealType out) =
>         net.imagej.ops.arithmetic.real.RealSubtract(
> ==>             RealType out,
>                 RealType in,
>                 double constant)
>         Inconvertible type: net.imagej.DefaultDataset => capture of ?
> **********************************************
>
> is there a way with the type-unsafe scripting languages to get ops to use
> the correct function? Or am I misunderstanding the concept of imagej-ops
> here?
>
> Thanks again for any hints.
>
> Jan
>
>
> [1] http://fiji.sc/2014-04-04_-_Announcing_ImageJ_OPS
> [2]
> https://github.com/imagej/imagej-legacy/blob/master/src/main/resources/script_templates/Python/OpsThresholdIJ1Analyze.py
>
>
>
> On 28.04.2015 09:03, Jan Eglinger wrote:
>
>> Dear Mark and Curtis,
>>
>> thank you very much for the quick replies and helpful pointers!
>>
>> Jan
>>
>>
>> On 27.04.2015 20:42, Curtis Rueden wrote:
>>
>>> Hi Jan,
>>>
>>> Here is another version of the script, which avoids wrapping each
>>> Dataset in another ImgPlus (which the framework would then wrap into yet
>>> another Dataset....):
>>>
>>>     # @DisplayService display
>>>     # @OpService ops
>>>     # @net.imagej.Dataset inputData1
>>>     # @net.imagej.Dataset inputData2
>>>
>>>     inputData1.setName("my1")
>>>     inputData2.setName("my2")
>>>     display.createDisplay(inputData1)
>>>     display.createDisplay(inputData2)
>>>
>>> But note that you also don't need to explicitly call createDisplay. Any
>>> output parameters of your script will automatically have displays
>>> created for them. E.g.:
>>>
>>>     # @OUTPUT net.imagej.Dataset outputData
>>>
>>> Will be shown at the conclusion of the script.
>>>
>>> Apologies for the appalling lack of documentation -- it would be great
>>> to flesh out the wiki docs about all this.
>>>
>>> HTH,
>>> Curtis
>>>
>>> On Mon, Apr 27, 2015 at 1:23 PM, Mark Hiner <hiner at wisc.edu
>>> <mailto:hiner at wisc.edu>> wrote:
>>>
>>>     Hi Jan,
>>>
>>>     >an error message is displayed: "A Dataset is required but none
>>> exist."
>>>
>>>     This was due to limitations with the input preprocessor presenting
>>>     the list of datasets. Since ImagePluses aren't explicitly tracked by
>>>     the IJ2 framework, having an ImagePlus recognized as a Dataset
>>>     requires some extra layers. We had covered the single input case
>>>     (which is why your first script worked) but not the general
>>>     multi-input case. There is an issue tracking the multi-input
>>>     <https://github.com/imagej/imagej-legacy/issues/106> case, which I
>>>     resolved today. So this should work as intended in our next release
>>>     - and thank you for the motivation to wrap this up!
>>>
>>>     You can also manually enable ImagePlus <> Dataset synchronization to
>>>     ensure ImagePluses always have a corresponding Dataset:
>>>     http://imagej.net/Compatibility#Translation_of_data_structures
>>>
>>>     >(where can this title be set, by the way?)
>>>
>>>     For the multiple choice input selection, the labels are based on the
>>>     name of the input type. Since the input type is Dataset, the Dataset
>>>     name is used (which delegates to the wrapped ImgPlus). In your code
>>>     you are applying labels to the Display, but not the underlying
>>>     dataset - if you name the ImgPlus, or explicitly create a Dataset
>>>     and set its name, that name will propagate up to the input chooser
>>>     (and the Display). As a side note, you should use the
>>>     net.imagej.ImgPlus instead of the net.imglib2.meta.
>>>
>>>     An updated script would be:
>>>
>>>
>>>         # @DisplayService display
>>>         # @OpService ops
>>>         # @net.imagej.Dataset inputData1
>>>         # @net.imagej.Dataset inputData2
>>>
>>>         from net.imagej import ImgPlus
>>>
>>>         display.createDisplay(ImgPlus(inputData1, "my1"))
>>>         display.createDisplay(ImgPlus(inputData2, "my2"))
>>>
>>>     Hope that helps. Let me know if you have any other questions.
>>>
>>>     Best,
>>>     Mark
>>>
>>>     On Mon, Apr 27, 2015 at 8:58 AM, Jan Eglinger
>>>     <jan.eglinger at gmail.com <mailto:jan.eglinger at gmail.com>> wrote:
>>>
>>>         Dear all,
>>>
>>>         *** TL;DR:
>>>         How do I proceed to get multiple input Datasets as ImageJ2
>>>         parameters from open images in Fiji?
>>>         ***
>>>
>>>         I was recently exploring ImageJ2 scripting in Fiji and found the
>>>         OpsThresholdIJ1Analyze template [1] in the script editor very
>>>         helpful.
>>>
>>>         When trying to get more than one @net.imagej.Dataset input
>>>         parameter however, I noticed some inconsistencies.
>>>         Let me try to illustrate with the two following scripts:
>>>
>>>              # @DisplayService display
>>>              # @OpService ops
>>>              # @net.imagej.Dataset inputData1
>>>
>>>              from net.imglib2.meta import ImgPlus
>>>
>>>              display.createDisplay("my1", ImgPlus(inputData1))
>>>
>>>
>>>         The above script re-displays the current image as expected (I
>>>         tried with the Blobs sample image open, which will be
>>>         re-displayed with a non-inverted LUT.)
>>>
>>>         When I ask for two input datasets (right after a fresh start of
>>>         Fiji with only the Blobs sample image open):
>>>
>>>              # @DisplayService display
>>>              # @OpService ops
>>>              # @net.imagej.Dataset inputData1
>>>              # @net.imagej.Dataset inputData2
>>>
>>>              from net.imglib2.meta import ImgPlus
>>>
>>>              display.createDisplay("my1", ImgPlus(inputData1))
>>>              display.createDisplay("my2", ImgPlus(inputData2))
>>>
>>>         an error message is displayed: "A Dataset is required but none
>>>         exist."
>>>         The same error message is displayed when I open a second image
>>>         in Fiji before running the script.
>>>
>>>         Now, when I run script #2 after script #1 was run at least once,
>>>         I get a dialog with two choices "InputData1" and "InputData2",
>>>         both choice fields containing "blobs.gif" and a number of
>>>         "Untitled" entries (where can this title be set, by the way?).
>>>
>>>         I guess that a choice is only displayed if there are ImageJ2
>>>         datasets (i.e. wrapped ImagePlus) already available. The single
>>>         input case seems to be special-cased as it auto-wraps the
>>>         currently open image.
>>>
>>>         So how do I proceed to get more than one input in ImageJ2
>>>         scripting from open (ImageJ1-)images?
>>>
>>>         Thanks for your advice,
>>>         Regards,
>>>         Jan
>>>
>>>
>>>         [1]:
>>>
>>>
>>> https://github.com/imagej/imagej-legacy/blob/master/src/main/resources/script_templates/Python/OpsThresholdIJ1Analyze.py
>>>
>>>
>>>
> _______________________________________________
> ImageJ-devel mailing list
> ImageJ-devel at imagej.net
> http://imagej.net/mailman/listinfo/imagej-devel
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://imagej.net/pipermail/imagej-devel/attachments/20150428/a0511668/attachment-0001.html>

From hiner at wisc.edu  Tue Apr 28 13:54:00 2015
From: hiner at wisc.edu (Mark Hiner)
Date: Tue, 28 Apr 2015 13:54:00 -0500
Subject: [ImageJ-devel] ImageJ2 scripting
In-Reply-To: <CAMWa8i1dqDjcRqt+PngvHktHO4jQqD5rjohmkuxTXPeBU5320Q@mail.gmail.com>
References: <553E407A.1060109@gmail.com>
	<CA+B=mGrtvuBveowm=OckmNR+giR-jQ1fPoFCpOAbQL_x=-gLFA@mail.gmail.com>
	<CADN69ymDzgbcrHBKy+9+FQj0LM9i479ueZCr4Ziz2fJJaEGoGw@mail.gmail.com>
	<553F30DB.4080501@gmail.com> <553FACF1.80208@gmail.com>
	<CAMWa8i1dqDjcRqt+PngvHktHO4jQqD5rjohmkuxTXPeBU5320Q@mail.gmail.com>
Message-ID: <CA+B=mGrO_cgjQPA8X7nufYoNr+NmQ++wjnv+Yb1sdQtBDQXDsQ@mail.gmail.com>

> from jarray import array
> blank=ops.createimg(array([100, 50], 'l'))
>

Thanks for this Brian! It definitely worked for me.

I would like to make things friendlier by automatically converting python
arrays to java, so I opened a new issue:
https://github.com/scijava/scripting-jython/issues/2

Thanks for pointing this out Jan.

Best,
Mark
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://imagej.net/pipermail/imagej-devel/attachments/20150428/b7c4c6e5/attachment.html>

From cyril.mongis at googlemail.com  Wed Apr 29 03:17:05 2015
From: cyril.mongis at googlemail.com (Mongis Cyril)
Date: Wed, 29 Apr 2015 10:17:05 +0200
Subject: [ImageJ-devel] ImageJ Custom UI and preprocessors
Message-ID: <CAJf7PRdBdRO1UHt=kxvGfuTheGeOuHAHXmmh6t6TXvP+Ohy7cQ@mail.gmail.com>

Dear all,

I'm actually integrating ImageJ in my PhD project. It leads me to
implements a JavaFX UI for ImageJ. Thanks to Curtis's help, I have been
able to support image opening and displaying. I'm now facing the issue of
triggering the filling of parameters via the UI. My menu is generated via a
MenuCreator implementation (the whole MenuCreator structure is a brillant
idea by the way, it allowed to integrate the ImageJ Menu in no time !) and
call the ShadowMenu.run() for the corresponding module. Applying LUT works
(so I guess that getting the active display works). However, when I want to
apply a Gaussian Blur (for instance), the software sents back a message
telling that the "dataset" input hasn't been provided. I guess it's a
preprocessor issue. I already did some digging about how preprocessor work
(from the tutorial and from the code that I read), but I lacking
explanations about the big picture. My main question is  : which approach
should I use make Imagej trigger my UI with some kind of auto-generated
dialog ? Should I create my own preprocessor or just maybe implements some
kind of UI binding used by an already existing preprocessor ? Since
applying LUT seems to work, does it means several preprocessor are executed
before a command is ran ? If yes, how is the preprocessing order decided ?
Could you point me to some existing preprocessor that does most of the
logic so I don't have to re-implement simple operations ?


I joined a screenshot of the current state of the ImageJ integration :-)
http://cyrilmongis.net/img/imagejfx-screenshot.jpg

Cheers,

Cyril MONGIS
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://imagej.net/pipermail/imagej-devel/attachments/20150429/919ae81a/attachment.html>

From hiner at wisc.edu  Wed Apr 29 08:20:40 2015
From: hiner at wisc.edu (Mark Hiner)
Date: Wed, 29 Apr 2015 08:20:40 -0500
Subject: [ImageJ-devel] ImageJ Custom UI and preprocessors
In-Reply-To: <CAJf7PRdBdRO1UHt=kxvGfuTheGeOuHAHXmmh6t6TXvP+Ohy7cQ@mail.gmail.com>
References: <CAJf7PRdBdRO1UHt=kxvGfuTheGeOuHAHXmmh6t6TXvP+Ohy7cQ@mail.gmail.com>
Message-ID: <CA+B=mGrjf9HQWVBnYU=w0bd2vhW-ZTe2UAeaTqueC8ZhJXd_SQ@mail.gmail.com>

Hi Cyril,

>However, when I want to apply a Gaussian Blur (for instance), the software
sents back a message telling that the "dataset" input hasn't been provided.
I guess it's a preprocessor issue.

Another possibility is that there actually is no Dataset. A Dataset[1] is
an ImageJ2 construct, and by default would not be produced by opening an
image with an ImageJ 1.x command. You can ensure a Dataset is available by
using an ImageJ2 I/O plugin (e.g. File > Import > Image...) or turn on
synchronization[2]. Once we get the synchronization step to be more
performant, it will be made automatic.

>how is the preprocessing order decided ?

All Preprocessors[3] are SciJava Plugins, which are accessed in order of
priority[4,5]

>Could you point me to some existing preprocessor that does most of the
logic so I don't have to re-implement simple operations ?

The ActiveDataset preprocessor[6] is what populates single @Dataset
parameters. There's also an ImagePlus version[7] for making @ImagePlus work.

>http://cyrilmongis.net/img/imagejfx-screenshot.jpg

This is fantastic. Is your source code openly available? I'm interested in
JavaFX - for cross-platform distribution more than as a library, but would
still be great to see what you're doing.

Thanks for keeping us up to date, let us know how it goes and if you run
into any more roadblocks (or if any of this is unclear)!

Best,
Mark

[1]
https://github.com/imagej/imagej-common/blob/imagej-common-0.14.0/src/main/java/net/imagej/Dataset.java
[2] http://imagej.net/Compatibility#Translation_of_data_structures
[3]
https://github.com/scijava/scijava-common/blob/scijava-common-2.40.0/src/main/java/org/scijava/module/process/PreprocessorPlugin.java
[4]
https://github.com/scijava/scijava-common/blob/scijava-common-2.40.0/src/main/java/org/scijava/plugin/Plugin.java#L129
[5]
https://github.com/scijava/scijava-common/blob/scijava-common-2.40.0/src/main/java/org/scijava/Priority.java
[6]
https://github.com/imagej/imagej-common/blob/imagej-common-0.14.0/src/main/java/net/imagej/display/process/ActiveDatasetPreprocessor.java
[7]
https://github.com/imagej/imagej-legacy/blob/master/src/main/java/net/imagej/legacy/plugin/ActiveImagePlusPreprocessor.java

On Wed, Apr 29, 2015 at 3:17 AM, Mongis Cyril <cyril.mongis at googlemail.com>
wrote:

> Dear all,
>
> I'm actually integrating ImageJ in my PhD project. It leads me to
> implements a JavaFX UI for ImageJ. Thanks to Curtis's help, I have been
> able to support image opening and displaying. I'm now facing the issue of
> triggering the filling of parameters via the UI. My menu is generated via a
> MenuCreator implementation (the whole MenuCreator structure is a brillant
> idea by the way, it allowed to integrate the ImageJ Menu in no time !) and
> call the ShadowMenu.run() for the corresponding module. Applying LUT works
> (so I guess that getting the active display works). However, when I want to
> apply a Gaussian Blur (for instance), the software sents back a message
> telling that the "dataset" input hasn't been provided. I guess it's a
> preprocessor issue. I already did some digging about how preprocessor work
> (from the tutorial and from the code that I read), but I lacking
> explanations about the big picture. My main question is  : which approach
> should I use make Imagej trigger my UI with some kind of auto-generated
> dialog ? Should I create my own preprocessor or just maybe implements some
> kind of UI binding used by an already existing preprocessor ? Since
> applying LUT seems to work, does it means several preprocessor are executed
> before a command is ran ? If yes, how is the preprocessing order decided ?
> Could you point me to some existing preprocessor that does most of the
> logic so I don't have to re-implement simple operations ?
>
>
> I joined a screenshot of the current state of the ImageJ integration :-)
> http://cyrilmongis.net/img/imagejfx-screenshot.jpg
>
> Cheers,
>
> Cyril MONGIS
>
> _______________________________________________
> ImageJ-devel mailing list
> ImageJ-devel at imagej.net
> http://imagej.net/mailman/listinfo/imagej-devel
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://imagej.net/pipermail/imagej-devel/attachments/20150429/3506e1bd/attachment.html>

From hiner at wisc.edu  Wed Apr 29 12:17:20 2015
From: hiner at wisc.edu (Mark Hiner)
Date: Wed, 29 Apr 2015 12:17:20 -0500
Subject: [ImageJ-devel] ImageJ2 scripting
In-Reply-To: <CA+B=mGrO_cgjQPA8X7nufYoNr+NmQ++wjnv+Yb1sdQtBDQXDsQ@mail.gmail.com>
References: <553E407A.1060109@gmail.com>
	<CA+B=mGrtvuBveowm=OckmNR+giR-jQ1fPoFCpOAbQL_x=-gLFA@mail.gmail.com>
	<CADN69ymDzgbcrHBKy+9+FQj0LM9i479ueZCr4Ziz2fJJaEGoGw@mail.gmail.com>
	<553F30DB.4080501@gmail.com> <553FACF1.80208@gmail.com>
	<CAMWa8i1dqDjcRqt+PngvHktHO4jQqD5rjohmkuxTXPeBU5320Q@mail.gmail.com>
	<CA+B=mGrO_cgjQPA8X7nufYoNr+NmQ++wjnv+Yb1sdQtBDQXDsQ@mail.gmail.com>
Message-ID: <CA+B=mGqmEoiq6QEHsQc7N0afrwMNKQ4_a3SBpcWHgAq55a1Bzw@mail.gmail.com>

Hi all,

>I would like to make things friendlier by automatically converting python
arrays to java, so I opened a new issue:
https://github.com/scijava/scripting-jython/issues/2

After further investigation, the problem wasn't type conversion but rather
that the createimg (and create) ops have a varargs parameter. Even though
an array was being passed, the individual values were being unwrapped (so
the Ops framework saw two parameters, instead of a single array parameter
with two elements).

The issue was not limited to jython scripting. I filed a PR to improve the
matching logic[1] - once it's merged, the following will all work:

   blank = ops.create(100, 50)

   blank = ops.create([100, 50])

   from jarray import array
   blank=ops.createimg(array([100, 50], 'l'))

Thanks again for the help and feedback!

Best,
Mark

[1] https://github.com/imagej/imagej-ops/pull/115

On Tue, Apr 28, 2015 at 1:54 PM, Mark Hiner <hiner at wisc.edu> wrote:

>
> from jarray import array
>> blank=ops.createimg(array([100, 50], 'l'))
>>
>
> Thanks for this Brian! It definitely worked for me.
>
> I would like to make things friendlier by automatically converting python
> arrays to java, so I opened a new issue:
> https://github.com/scijava/scripting-jython/issues/2
>
> Thanks for pointing this out Jan.
>
> Best,
> Mark
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://imagej.net/pipermail/imagej-devel/attachments/20150429/1cad9a4c/attachment.html>

From cyril.mongis at googlemail.com  Thu Apr 30 04:34:06 2015
From: cyril.mongis at googlemail.com (Mongis Cyril)
Date: Thu, 30 Apr 2015 11:34:06 +0200
Subject: [ImageJ-devel] ImageJ Custom UI and preprocessors
In-Reply-To: <CA+B=mGrjf9HQWVBnYU=w0bd2vhW-ZTe2UAeaTqueC8ZhJXd_SQ@mail.gmail.com>
References: <CAJf7PRdBdRO1UHt=kxvGfuTheGeOuHAHXmmh6t6TXvP+Ohy7cQ@mail.gmail.com>
	<CA+B=mGrjf9HQWVBnYU=w0bd2vhW-ZTe2UAeaTqueC8ZhJXd_SQ@mail.gmail.com>
Message-ID: <CAJf7PRenzGvsmwSQLdhyw+2XSNsef2zFYXw0XyiARt4S9=ymwQ@mail.gmail.com>

Dear Mark,

Thanks for your help. I used a ImageJ2 command to open the image (the
OpenFile.class module) so the display service knows what's the actual
display :-) I guess it's a preprocessor issue then... I'm gonna implement
my own preprocessor that triggers JavaFX.

The source code is now a bit messy for now but as soon as I get something
clean, I will publish it on Github. JavaFx is a great improvement compared
to swing that really worth the look. For instance, I will use a Webview
associated with Angular JS and a JSON Object Mapper to create a little
embedded web app that list of all modules, and display informations about
them like input, output etc. I also created some kind of new "special
widget" for browsing through N-Dimensional images. I will publish a demo
video when it's fully operational ;-)

I keep you up ;-)

Cheers everyone,

Cyril MONGIS


2015-04-29 15:20 GMT+02:00 Mark Hiner <hiner at wisc.edu>:

> Hi Cyril,
>
> >However, when I want to apply a Gaussian Blur (for instance), the
> software sents back a message telling that the "dataset" input hasn't been
> provided. I guess it's a preprocessor issue.
>
> Another possibility is that there actually is no Dataset. A Dataset[1] is
> an ImageJ2 construct, and by default would not be produced by opening an
> image with an ImageJ 1.x command. You can ensure a Dataset is available by
> using an ImageJ2 I/O plugin (e.g. File > Import > Image...) or turn on
> synchronization[2]. Once we get the synchronization step to be more
> performant, it will be made automatic.
>
> >how is the preprocessing order decided ?
>
> All Preprocessors[3] are SciJava Plugins, which are accessed in order of
> priority[4,5]
>
> >Could you point me to some existing preprocessor that does most of the
> logic so I don't have to re-implement simple operations ?
>
> The ActiveDataset preprocessor[6] is what populates single @Dataset
> parameters. There's also an ImagePlus version[7] for making @ImagePlus work.
>
> >http://cyrilmongis.net/img/imagejfx-screenshot.jpg
>
> This is fantastic. Is your source code openly available? I'm interested in
> JavaFX - for cross-platform distribution more than as a library, but would
> still be great to see what you're doing.
>
> Thanks for keeping us up to date, let us know how it goes and if you run
> into any more roadblocks (or if any of this is unclear)!
>
> Best,
> Mark
>
> [1]
> https://github.com/imagej/imagej-common/blob/imagej-common-0.14.0/src/main/java/net/imagej/Dataset.java
> [2] http://imagej.net/Compatibility#Translation_of_data_structures
> [3]
> https://github.com/scijava/scijava-common/blob/scijava-common-2.40.0/src/main/java/org/scijava/module/process/PreprocessorPlugin.java
> [4]
> https://github.com/scijava/scijava-common/blob/scijava-common-2.40.0/src/main/java/org/scijava/plugin/Plugin.java#L129
> [5]
> https://github.com/scijava/scijava-common/blob/scijava-common-2.40.0/src/main/java/org/scijava/Priority.java
> [6]
> https://github.com/imagej/imagej-common/blob/imagej-common-0.14.0/src/main/java/net/imagej/display/process/ActiveDatasetPreprocessor.java
> [7]
> https://github.com/imagej/imagej-legacy/blob/master/src/main/java/net/imagej/legacy/plugin/ActiveImagePlusPreprocessor.java
>
> On Wed, Apr 29, 2015 at 3:17 AM, Mongis Cyril <cyril.mongis at googlemail.com
> > wrote:
>
>> Dear all,
>>
>> I'm actually integrating ImageJ in my PhD project. It leads me to
>> implements a JavaFX UI for ImageJ. Thanks to Curtis's help, I have been
>> able to support image opening and displaying. I'm now facing the issue of
>> triggering the filling of parameters via the UI. My menu is generated via a
>> MenuCreator implementation (the whole MenuCreator structure is a brillant
>> idea by the way, it allowed to integrate the ImageJ Menu in no time !) and
>> call the ShadowMenu.run() for the corresponding module. Applying LUT works
>> (so I guess that getting the active display works). However, when I want to
>> apply a Gaussian Blur (for instance), the software sents back a message
>> telling that the "dataset" input hasn't been provided. I guess it's a
>> preprocessor issue. I already did some digging about how preprocessor work
>> (from the tutorial and from the code that I read), but I lacking
>> explanations about the big picture. My main question is  : which approach
>> should I use make Imagej trigger my UI with some kind of auto-generated
>> dialog ? Should I create my own preprocessor or just maybe implements some
>> kind of UI binding used by an already existing preprocessor ? Since
>> applying LUT seems to work, does it means several preprocessor are executed
>> before a command is ran ? If yes, how is the preprocessing order decided ?
>> Could you point me to some existing preprocessor that does most of the
>> logic so I don't have to re-implement simple operations ?
>>
>>
>> I joined a screenshot of the current state of the ImageJ integration :-)
>> http://cyrilmongis.net/img/imagejfx-screenshot.jpg
>>
>> Cheers,
>>
>> Cyril MONGIS
>>
>> _______________________________________________
>> ImageJ-devel mailing list
>> ImageJ-devel at imagej.net
>> http://imagej.net/mailman/listinfo/imagej-devel
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://imagej.net/pipermail/imagej-devel/attachments/20150430/e8bfe5ea/attachment.html>

