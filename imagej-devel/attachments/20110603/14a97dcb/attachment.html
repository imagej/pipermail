<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;content-type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=ISO-8859-1&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;text=&quot;#000000&quot;&nbsp;bgcolor=&quot;#ffffff&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I'm&nbsp;running&nbsp;into&nbsp;a&nbsp;number&nbsp;of&nbsp;problems&nbsp;with&nbsp;overlays&nbsp;that&nbsp;are&nbsp;caused<br>
&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;the&nbsp;fact&nbsp;that&nbsp;the&nbsp;EuclideanSpace&nbsp;is&nbsp;now&nbsp;defined&nbsp;on&nbsp;the&nbsp;Dataset<br>
&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;not&nbsp;on&nbsp;the&nbsp;Display&nbsp;used&nbsp;to&nbsp;composite&nbsp;datasets&nbsp;and&nbsp;overlays.<br>
&nbsp;&nbsp;&nbsp;&nbsp;There&nbsp;are&nbsp;more&nbsp;than&nbsp;a&nbsp;few&nbsp;issues:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;Trac&nbsp;issue&nbsp;ImageJ&nbsp;558&nbsp;-&nbsp;the&nbsp;user&nbsp;takes&nbsp;a&nbsp;Z-stack,&nbsp;multichannel<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image&nbsp;and&nbsp;thresholds&nbsp;it&nbsp;to&nbsp;get&nbsp;a&nbsp;BinaryMaskOverlay&nbsp;and<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;associated&nbsp;ROI.&nbsp;The&nbsp;ROI&nbsp;is&nbsp;properly&nbsp;defined&nbsp;in&nbsp;a&nbsp;4-dimensional<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;space.&nbsp;However,&nbsp;when&nbsp;displayed,&nbsp;a&nbsp;single&nbsp;X/Y&nbsp;plane&nbsp;should&nbsp;be<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sampled&nbsp;and&nbsp;displayed,&nbsp;but&nbsp;there&nbsp;is&nbsp;no&nbsp;mechanism&nbsp;to&nbsp;retrieve&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plane&nbsp;being&nbsp;displayed&nbsp;or&nbsp;the&nbsp;color&nbsp;display&nbsp;mode.&nbsp;The&nbsp;code<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iterates&nbsp;through&nbsp;the&nbsp;entire&nbsp;stack&nbsp;and&nbsp;that's&nbsp;what&nbsp;causes&nbsp;it&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;update&nbsp;slowly.&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;Datasets&nbsp;have&nbsp;axes&nbsp;which&nbsp;capture&nbsp;the&nbsp;metadata&nbsp;of&nbsp;what&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;particular&nbsp;dimension&nbsp;means.&nbsp;Overlays&nbsp;don't&nbsp;have&nbsp;that.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;Channels&nbsp;are&nbsp;really&nbsp;categorical,&nbsp;not&nbsp;ordinal&nbsp;-&nbsp;there's&nbsp;no<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reason&nbsp;the&nbsp;red&nbsp;channel&nbsp;is&nbsp;zero,&nbsp;the&nbsp;green&nbsp;is&nbsp;one&nbsp;and&nbsp;the&nbsp;blue&nbsp;is<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;two&nbsp;and,&nbsp;with&nbsp;a&nbsp;channel-stack,&nbsp;the&nbsp;DAPI&nbsp;channel&nbsp;in&nbsp;one&nbsp;image<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;might&nbsp;be&nbsp;the&nbsp;PI&nbsp;channel&nbsp;in&nbsp;a&nbsp;second.&nbsp;You&nbsp;can&nbsp;properly&nbsp;relate&nbsp;one<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;channel&nbsp;to&nbsp;the&nbsp;other&nbsp;through&nbsp;metadata,&nbsp;but&nbsp;overlays&nbsp;don't&nbsp;have<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that.&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;You&nbsp;might&nbsp;want&nbsp;to&nbsp;composite&nbsp;datasets&nbsp;-&nbsp;take&nbsp;two&nbsp;images&nbsp;and<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;place&nbsp;them&nbsp;adjacently.&nbsp;What&nbsp;happens&nbsp;if&nbsp;they&nbsp;have&nbsp;different&nbsp;axes?<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;What&nbsp;happens&nbsp;if&nbsp;they&nbsp;have&nbsp;different&nbsp;channel&nbsp;layouts?&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;So,&nbsp;what&nbsp;I'm&nbsp;thinking&nbsp;is&nbsp;the&nbsp;following:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;A&nbsp;display&nbsp;represents&nbsp;the&nbsp;EuclideanSpace&nbsp;that's&nbsp;used&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;composite&nbsp;overlays&nbsp;and&nbsp;datasets.&amp;nbsp;&nbsp;Think&nbsp;of&nbsp;the&nbsp;display&nbsp;as&nbsp;a&nbsp;big<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N-dimensional&nbsp;container&nbsp;and&nbsp;the&nbsp;overlays&nbsp;and&nbsp;datasets&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inside&nbsp;that&nbsp;container.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;The&nbsp;display&nbsp;has&nbsp;a&nbsp;set&nbsp;of&nbsp;axes&nbsp;that&nbsp;are&nbsp;the&nbsp;union&nbsp;of&nbsp;all&nbsp;of<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;axes&nbsp;that&nbsp;appear&nbsp;in&nbsp;the&nbsp;view&nbsp;data&nbsp;objects.&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;There&nbsp;are&nbsp;two&nbsp;behaviors&nbsp;for&nbsp;a&nbsp;view&nbsp;object&nbsp;that&nbsp;does&nbsp;not&nbsp;have<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;an&nbsp;axis&nbsp;in&nbsp;the&nbsp;space.&nbsp;Perhaps&nbsp;the&nbsp;user&nbsp;selects&nbsp;the&nbsp;behavior?:&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;The&nbsp;value&nbsp;in&nbsp;space&nbsp;outside&nbsp;of&nbsp;a&nbsp;single&nbsp;plane&nbsp;defined&nbsp;by&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coordinate&nbsp;location&nbsp;along&nbsp;the&nbsp;axis&nbsp;is&nbsp;nan&nbsp;or&nbsp;null.&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;The&nbsp;value&nbsp;in&nbsp;space&nbsp;along&nbsp;the&nbsp;missing&nbsp;axis&nbsp;is&nbsp;the&nbsp;same&nbsp;at<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;locations&nbsp;along&nbsp;that&nbsp;axis.&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;A&nbsp;display&nbsp;window&nbsp;holds&nbsp;the&nbsp;information&nbsp;about&nbsp;what&nbsp;plane&nbsp;is<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;being&nbsp;displayed&nbsp;and&nbsp;how&nbsp;the&nbsp;channels&nbsp;are&nbsp;composited.&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;The&nbsp;views&nbsp;are&nbsp;asked&nbsp;to&nbsp;display&nbsp;according&nbsp;to&nbsp;the&nbsp;plane<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;information.&nbsp;A&nbsp;plane&nbsp;is&nbsp;an&nbsp;interval&nbsp;where&nbsp;the&nbsp;min=max&nbsp;for&nbsp;all<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dimensions&nbsp;but&nbsp;X&nbsp;and&nbsp;Y.&nbsp;The&nbsp;views&nbsp;could&nbsp;construct&nbsp;appropriate<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;projectors&nbsp;based&nbsp;on&nbsp;the&nbsp;interval.&nbsp;The&nbsp;display&nbsp;window&nbsp;should<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;also&nbsp;control&nbsp;the&nbsp;channel&nbsp;compositing&nbsp;information&nbsp;and&nbsp;the&nbsp;views<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;should&nbsp;reference&nbsp;the&nbsp;display&nbsp;window's&nbsp;compositing&nbsp;information<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;instead&nbsp;of&nbsp;maintaining&nbsp;their&nbsp;own&nbsp;copies.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;Perhaps&nbsp;there&nbsp;is&nbsp;a&nbsp;SpatialDataObject&nbsp;or&nbsp;perhaps&nbsp;the&nbsp;DataObject<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;always&nbsp;spatial.&nbsp;In&nbsp;any&nbsp;case,&nbsp;the&nbsp;axis&nbsp;information&nbsp;and&nbsp;channel<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;metadata&nbsp;should&nbsp;be&nbsp;pushed&nbsp;up&nbsp;the&nbsp;inheritance&nbsp;hierarchy&nbsp;so&nbsp;that<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Overlay&nbsp;has&nbsp;a&nbsp;first-class&nbsp;representation&nbsp;of&nbsp;that&nbsp;and&nbsp;operations<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;generate&nbsp;overlays&nbsp;from&nbsp;datasets&nbsp;copy&nbsp;the&nbsp;information&nbsp;to&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overlays&nbsp;they&nbsp;create.&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;There&nbsp;is&nbsp;a&nbsp;spectral&nbsp;dimension,&nbsp;but&nbsp;the&nbsp;channel&nbsp;axis&nbsp;doesn't<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;capture&nbsp;that.&nbsp;Channels&nbsp;are&nbsp;categorical&nbsp;and&nbsp;should&nbsp;have&nbsp;names&nbsp;so<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;they&nbsp;can&nbsp;be&nbsp;matched&nbsp;in&nbsp;the&nbsp;same&nbsp;way&nbsp;that&nbsp;axes&nbsp;are&nbsp;matched.&lt;/li&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;It's&nbsp;some&nbsp;work&nbsp;to&nbsp;refactor&nbsp;these&nbsp;things,&nbsp;but&nbsp;as&nbsp;the&nbsp;code&nbsp;base&nbsp;grows<br>
&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;becomes&nbsp;more&nbsp;entrenched&nbsp;it&nbsp;will&nbsp;become&nbsp;increasingly&nbsp;difficult&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;refactor,&nbsp;so&nbsp;we&nbsp;should&nbsp;do&nbsp;it&nbsp;sooner&nbsp;rather&nbsp;than&nbsp;later.&nbsp;I&nbsp;don't&nbsp;think<br>
&nbsp;&nbsp;&nbsp;&nbsp;this&nbsp;is&nbsp;much&nbsp;coding&nbsp;at&nbsp;this&nbsp;point&nbsp;and&nbsp;if&nbsp;you&nbsp;look&nbsp;at&nbsp;the&nbsp;code,&nbsp;there<br>
&nbsp;&nbsp;&nbsp;&nbsp;are&nbsp;places&nbsp;where&nbsp;this&nbsp;organization&nbsp;clarifies&nbsp;some&nbsp;things.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;--Lee&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
