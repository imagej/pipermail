<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;2013/6/24&nbsp;Tobias&nbsp;Pietzsch&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:pietzsch@mpi-cbg.de&quot;&nbsp;target=&quot;_blank&quot;&gt;pietzsch@mpi-cbg.de&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
<br>
&lt;div&nbsp;style=&quot;word-wrap:break-word&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;First&nbsp;regarding&nbsp;the&nbsp;slow&nbsp;(feel&nbsp;free&nbsp;to&nbsp;skip&nbsp;to&nbsp;this&nbsp;paragraph...).&nbsp;I&nbsp;played&nbsp;with&nbsp;unsigned&nbsp;short&nbsp;to&nbsp;ARGB&nbsp;conversion&nbsp;and&nbsp;noticed&nbsp;that&nbsp;it&nbsp;divides&nbsp;by&nbsp;scale&nbsp;factor&nbsp;for&nbsp;every&nbsp;pixel.&lt;/div&gt;<br>
<br>
&lt;div&gt;I&nbsp;thought&nbsp;that&nbsp;maybe&nbsp;we&nbsp;could&nbsp;speed&nbsp;it&nbsp;up&nbsp;a&nbsp;little&nbsp;by&nbsp;replacing&nbsp;that&nbsp;with&nbsp;a&nbsp;multiplication.&nbsp;Amazingly&nbsp;even&nbsp;in&nbsp;a&nbsp;language&nbsp;as&nbsp;Java&nbsp;that&nbsp;is&nbsp;seemingly&nbsp;far&nbsp;removed&nbsp;from&nbsp;the&nbsp;CPU&nbsp;this&nbsp;actually&nbsp;matters.&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Just&nbsp;wanted&nbsp;to&nbsp;point&nbsp;out&nbsp;that&nbsp;this&nbsp;particular&nbsp;surprise&nbsp;with&nbsp;division,&nbsp;in&nbsp;Java,&nbsp;I&#39;ve&nbsp;run&nbsp;into&nbsp;before.&nbsp;Another&nbsp;aspect&nbsp;of&nbsp;it:&nbsp;for&nbsp;whatever&nbsp;reason&nbsp;the&nbsp;compiler&nbsp;or&nbsp;JIT&nbsp;are&nbsp;unable&nbsp;to&nbsp;map&nbsp;divisions&nbsp;by&nbsp;powers&nbsp;of&nbsp;two&nbsp;to&nbsp;a&nbsp;bit&nbsp;shift.&nbsp;For&nbsp;example:&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;int&nbsp;d&nbsp;=&nbsp;16;&lt;/div&gt;&lt;div&gt;int&nbsp;a&nbsp;=&nbsp;4096&nbsp;/&nbsp;d;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;...&nbsp;is&nbsp;about&nbsp;substantially&nbsp;slower&nbsp;(15&nbsp;to&nbsp;50%)&nbsp;than:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;int&nbsp;s&nbsp;=&nbsp;4;&lt;/div&gt;&lt;div&gt;int&nbsp;a&nbsp;=&nbsp;4096&nbsp;&gt;&gt;&nbsp;s;&lt;/div&gt;&lt;div&gt;&lt;br&gt;<br>
<br>
&lt;/div&gt;&lt;div&gt;...&nbsp;to&nbsp;the&nbsp;same&nbsp;result.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Albert &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;/div&gt;&lt;a&nbsp;href=&quot;http://albert.rierol.net&quot;&nbsp;target=&quot;_blank&quot;&gt;http://albert.rierol.net&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://www.ini.uzh.ch/~acardona/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.ini.uzh.ch/~acardona/&lt;/a&gt;<br>
&lt;/div&gt;&lt;/div&gt;<br>

</tt>
