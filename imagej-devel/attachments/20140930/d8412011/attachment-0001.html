<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html&nbsp;charset=windows-1252&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&gt;Hi&nbsp;all,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;sorry,&nbsp;long&nbsp;(but&nbsp;hopefully&nbsp;informative)&nbsp;mail&nbsp;coming…&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;On&nbsp;25&nbsp;Sep&nbsp;2014,&nbsp;at&nbsp;19:58,&nbsp;Johannes&nbsp;Schindelin&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:schindelin@wisc.edu&quot;&gt;schindelin@wisc.edu&lt;/a&gt;&gt;&nbsp;wrote:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;It&nbsp;is&nbsp;great&nbsp;that&nbsp;you&nbsp;continue&nbsp;our&nbsp;conversation&nbsp;from&nbsp;the&nbsp;hackathon&nbsp;last&lt;br&gt;year&nbsp;in&nbsp;Madison:&lt;br&gt;&lt;br&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;a&nbsp;href=&quot;http://fiji.sc/2013-05-03_-_ImgLib2_Hackathon_in_Madison&quot;&gt;http://fiji.sc/2013-05-03_-_ImgLib2_Hackathon_in_Madison&lt;/a&gt;&lt;br&gt;&lt;br&gt;I&nbsp;am&nbsp;very&nbsp;glad&nbsp;that&nbsp;you&nbsp;have&nbsp;returned&nbsp;to&nbsp;this&nbsp;work,&nbsp;with&nbsp;a&nbsp;promising&lt;br&gt;initial&nbsp;foray&nbsp;into&nbsp;a&nbsp;general&nbsp;solution.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;need&nbsp;to&nbsp;make&nbsp;clear&nbsp;that&nbsp;(ex-)neon&nbsp;is&nbsp;not&nbsp;a&nbsp;continuation&nbsp;of&nbsp;our&nbsp;hackathon&nbsp;conversation.&nbsp;There&nbsp;is&nbsp;a&nbsp;crucial&nbsp;difference&nbsp;in&nbsp;scope.&nbsp;Let&nbsp;me&nbsp;quote&nbsp;the&nbsp;two&nbsp;relevant&nbsp;points&nbsp;from&nbsp;the&nbsp;above&nbsp;page:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;ul&nbsp;style=&quot;padding:&nbsp;0px;&nbsp;margin:&nbsp;0.3em&nbsp;0px&nbsp;0px&nbsp;1.6em;&nbsp;font-size:&nbsp;13px;&nbsp;color:&nbsp;rgb(68,&nbsp;68,&nbsp;68);&nbsp;font-family:&nbsp;Arial,&nbsp;sans-serif;&nbsp;background-color:&nbsp;rgb(255,&nbsp;255,&nbsp;255);&quot;&gt;&lt;li&nbsp;style=&quot;padding:&nbsp;0px;&nbsp;margin:&nbsp;0px&nbsp;0px&nbsp;0.5em&nbsp;2em;&nbsp;font-size:&nbsp;1em;&quot;&gt;Performance&nbsp;is&nbsp;another&nbsp;issue,&nbsp;completely.&nbsp;Over&nbsp;the&nbsp;course&nbsp;of&nbsp;several&nbsp;experiments,&nbsp;I&nbsp;became&nbsp;convinced&nbsp;that&nbsp;we&nbsp;were&nbsp;wrong&nbsp;to&nbsp;rely&nbsp;on&nbsp;the&nbsp;JIT&nbsp;so&nbsp;much:&nbsp;it&nbsp;is&nbsp;okay&nbsp;for&nbsp;simple&nbsp;things,&nbsp;but&nbsp;for&nbsp;ever&nbsp;so&nbsp;slightly&nbsp;complicated&nbsp;things,&nbsp;we&nbsp;need&nbsp;a&nbsp;precompiler&nbsp;that&nbsp;knows&nbsp;what&nbsp;we&nbsp;really&nbsp;want&nbsp;to&nbsp;do.&nbsp;For&nbsp;example,&nbsp;just&nbsp;the&nbsp;mere&nbsp;fact&nbsp;should&nbsp;have&nbsp;taught&nbsp;us&nbsp;something&nbsp;that&nbsp;stand-alone&nbsp;FloatType&nbsp;instances&nbsp;*must*&nbsp;refer&nbsp;to&nbsp;their&nbsp;*single*&nbsp;float&nbsp;value&nbsp;as&nbsp;a&nbsp;1-element&nbsp;float&nbsp;array&nbsp;*just&nbsp;so*&nbsp;that&nbsp;the&nbsp;JIT&nbsp;does&nbsp;not&nbsp;do&nbsp;an&nbsp;utterly&nbsp;bad&nbsp;job&nbsp;when&nbsp;we&nbsp;access&nbsp;single&nbsp;values&nbsp;as&nbsp;well&nbsp;as&nbsp;pixel&nbsp;values&nbsp;in&nbsp;an&nbsp;array.&lt;/li&gt;&lt;/ul&gt;&lt;div&gt;&lt;ul&nbsp;style=&quot;padding:&nbsp;0px;&nbsp;margin:&nbsp;0.3em&nbsp;0px&nbsp;0px&nbsp;1.6em;&nbsp;font-size:&nbsp;13px;&nbsp;color:&nbsp;rgb(68,&nbsp;68,&nbsp;68);&nbsp;font-family:&nbsp;Arial,&nbsp;sans-serif;&nbsp;background-color:&nbsp;rgb(255,&nbsp;255,&nbsp;255);&quot;&gt;&lt;li&nbsp;style=&quot;padding:&nbsp;0px;&nbsp;margin:&nbsp;0px&nbsp;0px&nbsp;0.5em&nbsp;2em;&nbsp;font-size:&nbsp;1em;&quot;&gt;As&nbsp;a&nbsp;consequence&nbsp;of&nbsp;the&nbsp;findings&nbsp;regarding&nbsp;performance,&nbsp;I&nbsp;came&nbsp;up&nbsp;with&nbsp;a&nbsp;simple&nbsp;proof-of-concept&nbsp;that&nbsp;things&nbsp;could&nbsp;be&nbsp;made&nbsp;fast&nbsp;by&nbsp;using&nbsp;Javassist,&nbsp;a&nbsp;library&nbsp;for&nbsp;bytecode&nbsp;manipulation.&nbsp;We&nbsp;use&nbsp;this&nbsp;library&nbsp;extensively&nbsp;in&nbsp;ImageJ2&nbsp;and&nbsp;Fiji&nbsp;already&nbsp;for&nbsp;just-in-time&nbsp;patching&nbsp;of,&nbsp;say,&nbsp;ImageJ1.&nbsp;It&nbsp;was&nbsp;a&nbsp;natural&nbsp;choice&nbsp;to&nbsp;turn&nbsp;to&nbsp;Javassist&nbsp;for&nbsp;trying&nbsp;to&nbsp;optimize&nbsp;ImgLib,&nbsp;too.&nbsp;Mind&nbsp;you,&nbsp;the&nbsp;example&nbsp;I&nbsp;made&nbsp;was&nbsp;very&nbsp;simple:&nbsp;it&nbsp;constructed&nbsp;a&nbsp;class&nbsp;working&nbsp;on&nbsp;ArrayImgs&nbsp;of&nbsp;FloatType&nbsp;directly,&nbsp;without&nbsp;even&nbsp;inspecting&nbsp;any&nbsp;code&nbsp;to&nbsp;know&nbsp;what&nbsp;to&nbsp;do,&nbsp;but&nbsp;instead&nbsp;hard-coding&nbsp;the&nbsp;&quot;+&quot;&nbsp;op.&nbsp;But&nbsp;it&nbsp;showed&nbsp;the&nbsp;way&nbsp;to&nbsp;how&nbsp;we&nbsp;could&nbsp;do&nbsp;things&nbsp;in&nbsp;the&nbsp;future:&nbsp;inspect&nbsp;what&nbsp;the,&nbsp;say,&nbsp;Expression&nbsp;is&nbsp;supposed&nbsp;to&nbsp;do&nbsp;and&nbsp;rewrite&nbsp;it&nbsp;in&nbsp;optimized&nbsp;bytecode.&nbsp;The&nbsp;speed&nbsp;improvement&nbsp;was—as&nbsp;I&nbsp;expected—impressive.&lt;/li&gt;&lt;/ul&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;contrast&nbsp;to&nbsp;what&nbsp;Johannes&nbsp;describes&nbsp;here,&nbsp;(ex-)neon&nbsp;explicitly&nbsp;relies&nbsp;on&nbsp;the&nbsp;JIT&nbsp;to&nbsp;“do&nbsp;it’s&nbsp;thing”.&lt;/div&gt;&lt;div&gt;I&nbsp;had&nbsp;hoped&nbsp;that&nbsp;this&nbsp;would&nbsp;be&nbsp;clear&nbsp;from&nbsp;the&nbsp;README&nbsp;which&nbsp;very&nbsp;explicitly&nbsp;explains&nbsp;what&nbsp;it&nbsp;currently&nbsp;does.&lt;/div&gt;&lt;/div&gt;&lt;div&gt;It&nbsp;addresses&nbsp;one&nbsp;particular&nbsp;pattern&nbsp;of&nbsp;polymorphic&nbsp;method&nbsp;calls&nbsp;that&nbsp;makes&nbsp;the&nbsp;JIT&nbsp;*deoptimize*&nbsp;optimistically&nbsp;compiled&nbsp;code.&nbsp;I&nbsp;address&nbsp;this&nbsp;by&nbsp;modifying&nbsp;bytecode&nbsp;to&nbsp;make&nbsp;the&nbsp;optimistic&nbsp;assumption&nbsp;valid.&lt;/div&gt;&lt;div&gt;Also&nbsp;answering&nbsp;the&nbsp;performance&nbsp;question&nbsp;below:&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:pre&quot;&gt;&nbsp;&lt;/span&gt;It&nbsp;should&nbsp;be&nbsp;clear,&nbsp;that&nbsp;this&nbsp;will&nbsp;never&nbsp;(!)&nbsp;produce&nbsp;something&nbsp;that&nbsp;runs&nbsp;faster&nbsp;than&nbsp;the&nbsp;optimistically&nbsp;compiled&nbsp;code,&nbsp;that&nbsp;is,&nbsp;the&nbsp;case&nbsp;where&nbsp;polymorphism&nbsp;was&nbsp;not&nbsp;realized&nbsp;at&nbsp;runtime.&lt;/div&gt;&lt;div&gt;A&nbsp;lot&nbsp;of&nbsp;ImgLib2&nbsp;benchmarks&nbsp;we&nbsp;did&nbsp;fall&nbsp;into&nbsp;this&nbsp;category.&nbsp;They&nbsp;are&nbsp;fast&nbsp;as&nbsp;individual&nbsp;benchmarks&nbsp;but&nbsp;put&nbsp;a&nbsp;few&nbsp;of&nbsp;them&nbsp;together&nbsp;and&nbsp;use&nbsp;different&nbsp;image&nbsp;types&nbsp;etc,&nbsp;it&nbsp;paints&nbsp;a&nbsp;totally&nbsp;different&nbsp;picture.&nbsp;This&nbsp;is&nbsp;where&nbsp;I&nbsp;though&nbsp;(ex-)neon&nbsp;could&nbsp;help&nbsp;ImgLib2.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;also&nbsp;need&nbsp;to&nbsp;point&nbsp;out&nbsp;that&nbsp;I&nbsp;see&nbsp;the&nbsp;scope&nbsp;of&nbsp;(ex-)neon&nbsp;to&nbsp;be&nbsp;broader&nbsp;than&nbsp;imglib2,&nbsp;imagej2,&nbsp;scijava,&nbsp;etc.&nbsp;I&nbsp;think&nbsp;it&nbsp;could&nbsp;be&nbsp;useful&nbsp;in&nbsp;scenarios&nbsp;completely&nbsp;unrelated&nbsp;to&nbsp;our&nbsp;little&nbsp;corner&nbsp;of&nbsp;the&nbsp;world.&nbsp;Therefore,&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;keep&nbsp;it&nbsp;a&nbsp;small,&nbsp;separate&nbsp;project&nbsp;to&nbsp;make&nbsp;it&nbsp;as&nbsp;easy&nbsp;as&nbsp;possible&nbsp;for&nbsp;whomever&nbsp;might&nbsp;be&nbsp;interested&nbsp;to&nbsp;take&nbsp;advantage&nbsp;of&nbsp;it.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Johannes,&nbsp;what&nbsp;you&nbsp;describe&nbsp;in&nbsp;the&nbsp;above&nbsp;page&nbsp;is&nbsp;different&nbsp;in&nbsp;scope.&nbsp;You&nbsp;used&nbsp;knowledge&nbsp;about&nbsp;implementation&nbsp;details&nbsp;to&nbsp;hand-code&nbsp;a&nbsp;faster&nbsp;version.&nbsp;That&nbsp;the&nbsp;hand-coded&nbsp;source&nbsp;goes&nbsp;through&nbsp;a&nbsp;layer&nbsp;of&nbsp;indirection&nbsp;with&nbsp;Javassist&nbsp;is&nbsp;for&nbsp;that&nbsp;particular&nbsp;example&nbsp;irrelevant,&nbsp;but&nbsp;I&nbsp;absolutely&nbsp;see&nbsp;the&nbsp;potential&nbsp;of&nbsp;assembling&nbsp;code&nbsp;from&nbsp;expressions&nbsp;recombining&nbsp;these&nbsp;hand-coded&nbsp;patterns.&nbsp;This&nbsp;is&nbsp;a&nbsp;different&nbsp;but&nbsp;completely&nbsp;valid&nbsp;approach,&nbsp;which&nbsp;was&nbsp;what&nbsp;I&nbsp;meant&nbsp;by&nbsp;saying&nbsp;that&nbsp;it&nbsp;is&nbsp;“orthogonal&nbsp;to&nbsp;imagej-ops”.&nbsp;However&nbsp;pushing&nbsp;this&nbsp;to&nbsp;a&nbsp;level&nbsp;where&nbsp;it&nbsp;works&nbsp;for&nbsp;many&nbsp;things&nbsp;(like&nbsp;in&nbsp;the&nbsp;imglib&nbsp;case&nbsp;something&nbsp;simple&nbsp;as&nbsp;user-made&nbsp;Types&nbsp;that&nbsp;are&nbsp;not&nbsp;part&nbsp;of&nbsp;the&nbsp;core&nbsp;library),&nbsp;gathering&nbsp;these&nbsp;implementation&nbsp;details&nbsp;automatically&nbsp;from&nbsp;places&nbsp;in&nbsp;the&nbsp;code&nbsp;that&nbsp;are&nbsp;potentially&nbsp;very&nbsp;far&nbsp;from&nbsp;where&nbsp;you&nbsp;currently&nbsp;are&nbsp;is&nbsp;extremely&nbsp;difficult,&nbsp;if&nbsp;not&nbsp;infeasible.&nbsp;It&nbsp;amounts&nbsp;to&nbsp;making&nbsp;a&nbsp;new&nbsp;JIT,&nbsp;but&nbsp;without&nbsp;access&nbsp;to&nbsp;profiling&nbsp;information.&lt;/div&gt;&lt;div&gt;So&nbsp;in&nbsp;my&nbsp;opinion&nbsp;this&nbsp;is&nbsp;a&nbsp;complementary&nbsp;approach.&nbsp;The&nbsp;advantage&nbsp;is&nbsp;potentially&nbsp;higher&nbsp;performance.&nbsp;The&nbsp;drawback&nbsp;is&nbsp;that&nbsp;you&nbsp;basically&nbsp;hand-code&nbsp;things.&nbsp;It’s&nbsp;targeted&nbsp;at&nbsp;a&nbsp;specific&nbsp;library&nbsp;and/or&nbsp;application.&nbsp;If&nbsp;the&nbsp;library&nbsp;code&nbsp;changes&nbsp;too&nbsp;much,&nbsp;it&nbsp;is&nbsp;likely&nbsp;to&nbsp;break.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Sorry&nbsp;for&nbsp;being&nbsp;so&nbsp;nit-picky&nbsp;about&nbsp;it&nbsp;but&nbsp;I&nbsp;really&nbsp;think&nbsp;it&nbsp;is&nbsp;important&nbsp;to&nbsp;not&nbsp;convolute&nbsp;these&nbsp;two&nbsp;(valid)&nbsp;approaches&nbsp;(and&nbsp;projects).&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;On&nbsp;the&nbsp;other&nbsp;hand&nbsp;I&nbsp;do&nbsp;not&nbsp;want&nbsp;to&nbsp;give&nbsp;the&nbsp;impression&nbsp;that&nbsp;I&nbsp;made&nbsp;this&nbsp;up&nbsp;out&nbsp;of&nbsp;thin&nbsp;air.&nbsp;There&nbsp;is&nbsp;lot’s&nbsp;of&nbsp;stuff&nbsp;that&nbsp;*is*&nbsp;closely&nbsp;related&nbsp;and&nbsp;I&nbsp;neglected&nbsp;to&nbsp;give&nbsp;credit&nbsp;for&nbsp;that&nbsp;(which&nbsp;seems&nbsp;to&nbsp;me&nbsp;to&nbsp;be&nbsp;part&nbsp;of&nbsp;your&nbsp;problem&nbsp;with&nbsp;this,&nbsp;Johannes?).&nbsp;To&nbsp;rectify&nbsp;that,&nbsp;I&nbsp;added&nbsp;a&nbsp;“Resources”&nbsp;section&nbsp;to&nbsp;the&nbsp;README&nbsp;on&nbsp;&lt;a&nbsp;href=&quot;https://github.com/tpietzsch/none&quot;&gt;https://github.com/tpietzsch/none&lt;/a&gt;&nbsp;pointing&nbsp;to&nbsp;helpful&nbsp;discussions&nbsp;etc.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;I&nbsp;do&nbsp;have&nbsp;some&nbsp;questions&nbsp;and&nbsp;suggestions:&lt;br&gt;&lt;br&gt;-&nbsp;Why&nbsp;use&nbsp;ASM&nbsp;over&nbsp;Javassist?&nbsp;At&nbsp;the&nbsp;hackathon,&nbsp;we&nbsp;used&nbsp;Javassist&nbsp;because&lt;br&gt;&nbsp;&nbsp;it&nbsp;is&nbsp;easier&nbsp;to&nbsp;use,&nbsp;we&nbsp;have&nbsp;much&nbsp;better&nbsp;documentation&nbsp;(e.g.&lt;br&gt;&nbsp;&nbsp;&lt;a&nbsp;href=&quot;http://fiji.sc/Javassist&quot;&gt;http://fiji.sc/Javassist&lt;/a&gt;)&nbsp;and&nbsp;we&nbsp;already&nbsp;ship&nbsp;it&nbsp;with&nbsp;Fiji.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Here&nbsp;I&nbsp;have&nbsp;a&nbsp;different&nbsp;opinion.&nbsp;I&nbsp;think&nbsp;ASM&nbsp;has&nbsp;the&nbsp;better&nbsp;documentation.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;There&nbsp;is&nbsp;no&nbsp;doc&nbsp;page&nbsp;for&nbsp;ASM&nbsp;on&nbsp;the&nbsp;Fiji&nbsp;wiki,&nbsp;but&nbsp;they&nbsp;have&nbsp;a&nbsp;very&nbsp;good&nbsp;guide&nbsp;on&nbsp;their&nbsp;own&nbsp;site:&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;http://download.forge.objectweb.org/asm/asm4-guide.pdf&quot;&gt;http://download.forge.objectweb.org/asm/asm4-guide.pdf&lt;/a&gt;&lt;/div&gt;&lt;div&gt;which&nbsp;is&nbsp;both&nbsp;tutorial&nbsp;style&nbsp;and&nbsp;going&nbsp;into&nbsp;detail.&nbsp;It&nbsp;also&nbsp;contains&nbsp;an&nbsp;introduction&nbsp;to&nbsp;the&nbsp;java&nbsp;class&nbsp;file&nbsp;format&nbsp;and&nbsp;bytecode.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;API&nbsp;is&nbsp;well&nbsp;structured&nbsp;and&nbsp;the&nbsp;API&nbsp;documentation&nbsp;is&nbsp;complete,&nbsp;&lt;a&nbsp;href=&quot;http://asm.ow2.org/asm50/javadoc/user/index.html&quot;&gt;ASM&nbsp;5.0&nbsp;API&lt;/a&gt;.&nbsp;Especially&nbsp;after&nbsp;reading&nbsp;the&nbsp;guide,&nbsp;I&nbsp;had&nbsp;absolutely&nbsp;trouble&nbsp;finding&nbsp;my&nbsp;way&nbsp;around.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Finally,&nbsp;and&nbsp;this&nbsp;is&nbsp;really&nbsp;really&nbsp;helpful.&nbsp;They&nbsp;have&nbsp;a&nbsp;“Bytecode&nbsp;Outline”&nbsp;plugin&nbsp;for&nbsp;Eclipse.&lt;/div&gt;&lt;div&gt;This&nbsp;shows&nbsp;you&nbsp;not&nbsp;only&nbsp;the&nbsp;bytecode&nbsp;of&nbsp;the&nbsp;file&nbsp;you&nbsp;are&nbsp;currently&nbsp;editing:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;img&nbsp;name=&quot;Screen&nbsp;Shot&nbsp;2014-09-30&nbsp;at&nbsp;16.59.16.png&quot;&nbsp;apple-inline=&quot;yes&quot;&nbsp;id=&quot;2007ABBB-E15B-4EF7-8308-949ECD635647&quot;&nbsp;height=&quot;323&quot;&nbsp;width=&quot;832&quot;&nbsp;apple-width=&quot;yes&quot;&nbsp;apple-height=&quot;yes&quot;&nbsp;src=&quot;cid:D3058267-7BF6-4437-92EC-63C50BF8D246@mpi-cbg.de&quot;&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;...but&nbsp;also&nbsp;the&nbsp;ASM&nbsp;code&nbsp;needed&nbsp;to&nbsp;generate&nbsp;that:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;img&nbsp;apple-inline=&quot;yes&quot;&nbsp;id=&quot;62DFB8F0-E6A8-4B95-A5E6-0C09CDEA4BB7&quot;&nbsp;height=&quot;294&quot;&nbsp;width=&quot;831&quot;&nbsp;apple-width=&quot;yes&quot;&nbsp;apple-height=&quot;yes&quot;&nbsp;src=&quot;cid:C6EE714A-CC4A-4EDA-8D82-CB058FC8BA9C@mpi-cbg.de&quot;&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This&nbsp;makes&nbsp;it&nbsp;trivial&nbsp;to&nbsp;get&nbsp;started.&nbsp;(Though&nbsp;you&nbsp;later&nbsp;figure&nbsp;out&nbsp;that&nbsp;there&nbsp;is&nbsp;a&nbsp;more&nbsp;powerful&nbsp;tree&nbsp;API&nbsp;that&nbsp;is&nbsp;to&nbsp;the&nbsp;above&nbsp;as&nbsp;DOM&nbsp;is&nbsp;to&nbsp;SAX).&lt;/div&gt;&lt;div&gt;For&nbsp;the&nbsp;non-Eclipse&nbsp;people,&nbsp;there&nbsp;is&nbsp;of&nbsp;course&nbsp;a&nbsp;command-line&nbsp;“ASMifier&quot;.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Importantly,&nbsp;I&nbsp;need&nbsp;low-level&nbsp;manipulations&nbsp;to&nbsp;arrive&nbsp;at&nbsp;code&nbsp;that&nbsp;I&nbsp;could&nbsp;*not*&nbsp;have&nbsp;produced&nbsp;by&nbsp;source&nbsp;code&nbsp;+&nbsp;javac.&lt;/div&gt;&lt;div&gt;I&nbsp;think&nbsp;these&nbsp;manipulations&nbsp;are&nbsp;possible&nbsp;using&nbsp;Javassist&nbsp;but&nbsp;I&nbsp;couldn’t&nbsp;easily&nbsp;find&nbsp;information&nbsp;about&nbsp;how.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;Besides&nbsp;all&nbsp;that,&nbsp;ASM&nbsp;has&nbsp;going&nbsp;for&nbsp;it&nbsp;that&nbsp;it&nbsp;is&nbsp;bleeding&nbsp;edge,&nbsp;always&nbsp;at&nbsp;the&nbsp;latest&nbsp;java&nbsp;release&nbsp;version&nbsp;(and&nbsp;often&nbsp;beta&nbsp;versions).&lt;/div&gt;&lt;div&gt;There&nbsp;is&nbsp;overlap&nbsp;between&nbsp;OpenJDK&nbsp;and&nbsp;ASM&nbsp;people.&nbsp;ASM&nbsp;is&nbsp;used&nbsp;in&nbsp;the&nbsp;JDK&nbsp;itself&nbsp;(to&nbsp;implement&nbsp;java&nbsp;8&nbsp;lambda&nbsp;expressions&nbsp;for&nbsp;example).&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So&nbsp;to&nbsp;summarize,&nbsp;I’m&nbsp;pretty&nbsp;much&nbsp;married&nbsp;to&nbsp;ASM&nbsp;now.&nbsp;I&nbsp;like&nbsp;the&nbsp;documentation,&nbsp;I&nbsp;like&nbsp;the&nbsp;tools,&nbsp;and&nbsp;it&nbsp;works&nbsp;great&nbsp;for&nbsp;what&nbsp;I&nbsp;want&nbsp;to&nbsp;do.&lt;/div&gt;&lt;div&gt;I&nbsp;see&nbsp;no&nbsp;reason&nbsp;to&nbsp;dig&nbsp;into&nbsp;Javassist&nbsp;now&nbsp;without&nbsp;any&nbsp;clear&nbsp;benefit.&lt;/div&gt;&lt;div&gt;Obviously,&nbsp;the&nbsp;same&nbsp;is&nbsp;probably&nbsp;true&nbsp;for&nbsp;the&nbsp;Javassist&nbsp;people:&nbsp;no&nbsp;reason&nbsp;to&nbsp;learn&nbsp;ASM.&lt;/div&gt;&lt;div&gt;So&nbsp;it&nbsp;is&nbsp;completely&nbsp;ok&nbsp;for&nbsp;me&nbsp;if,&nbsp;for&nbsp;example&nbsp;Johannes&nbsp;chooses&nbsp;to&nbsp;not&nbsp;get&nbsp;involved&nbsp;in&nbsp;(ex-)neon&nbsp;for&nbsp;that&nbsp;reason.&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;-&nbsp;If&nbsp;the&nbsp;plan&nbsp;is&nbsp;to&nbsp;use&nbsp;it&nbsp;inside&nbsp;Fiji,&nbsp;why&nbsp;not&nbsp;use&nbsp;version&nbsp;4.0&nbsp;of&nbsp;ASM&lt;br&gt;&nbsp;&nbsp;which&nbsp;is&nbsp;in&nbsp;Fiji&nbsp;already&nbsp;as&nbsp;a&nbsp;transitive&nbsp;dependency&nbsp;of&nbsp;JRuby?&nbsp;Requiring&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&nbsp;&nbsp;a&nbsp;newer&nbsp;version&nbsp;(5.0.2)&nbsp;is&nbsp;prone&nbsp;to&nbsp;cause&nbsp;problems…&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Sure,&nbsp;I’ll&nbsp;start&nbsp;by&nbsp;making&nbsp;a&nbsp;branch&nbsp;that&nbsp;uses&nbsp;the&nbsp;4.0&nbsp;version.&lt;/div&gt;&lt;div&gt;It&nbsp;should&nbsp;be&nbsp;as&nbsp;simple&nbsp;as&nbsp;using&nbsp;a&nbsp;now-deprecated&nbsp;ClassVisitor.visitMethodInsn()&nbsp;version.&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;-&nbsp;A&nbsp;quick&nbsp;web&nbsp;search&nbsp;shows&nbsp;that&nbsp;there&nbsp;is&nbsp;an&nbsp;active,&nbsp;successful&nbsp;Neon&nbsp;library&nbsp;for&lt;br&gt;&nbsp;&nbsp;WebDAV&nbsp;communication.&nbsp;To&nbsp;avoid&nbsp;legal&nbsp;and&nbsp;social&nbsp;problems,&nbsp;we'll&nbsp;need&nbsp;to&lt;br&gt;&nbsp;&nbsp;choose&nbsp;a&nbsp;different&nbsp;name&nbsp;for&nbsp;the&nbsp;project.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Ok,&nbsp;I&nbsp;understand.&nbsp;I&nbsp;changed&nbsp;the&nbsp;name.&nbsp;I&nbsp;just&nbsp;scrambled&nbsp;the&nbsp;letters&nbsp;and&nbsp;now&nbsp;it’s&nbsp;called&nbsp;“none”.&nbsp;I&nbsp;didn’t&nbsp;find&nbsp;a&nbsp;project&nbsp;called&nbsp;like&nbsp;this&nbsp;on&nbsp;google,&nbsp;so&nbsp;should&nbsp;be&nbsp;fine.&lt;/div&gt;&lt;div&gt;It’s&nbsp;a&nbsp;bit&nbsp;strange&nbsp;at&nbsp;first,&nbsp;but&nbsp;actually,&nbsp;I&nbsp;think&nbsp;it’s&nbsp;not&nbsp;so&nbsp;bad:&lt;/div&gt;&lt;div&gt;1)&nbsp;ample&nbsp;opportunity&nbsp;for&nbsp;evil&nbsp;chuckles&nbsp;whenever&nbsp;somebody&nbsp;claims&nbsp;his&nbsp;lib&nbsp;is&nbsp;“second&nbsp;to&nbsp;none”.&lt;/div&gt;&lt;div&gt;2)&nbsp;chemical&nbsp;elements&nbsp;logo&nbsp;still&nbsp;works&nbsp;out&nbsp;nicely.&lt;/div&gt;I&nbsp;hope&nbsp;nobody&nbsp;has&nbsp;a&nbsp;problem&nbsp;with&nbsp;that.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;By&nbsp;pure&nbsp;coincidence,&nbsp;“none”&nbsp;is&nbsp;exactly&nbsp;the&nbsp;amount&nbsp;of&nbsp;controversy&nbsp;I&nbsp;expected&nbsp;when&nbsp;announcing&nbsp;the&nbsp;project.&lt;/div&gt;&lt;div&gt;I&nbsp;could&nbsp;not&nbsp;have&nbsp;been&nbsp;more&nbsp;wrong.&nbsp;Off-list&nbsp;there&nbsp;has&nbsp;been&nbsp;a&nbsp;bit&nbsp;of&nbsp;a&nbsp;personal&nbsp;clash,&nbsp;which&nbsp;is&nbsp;not&nbsp;really&nbsp;of&nbsp;concern&nbsp;here.&lt;/div&gt;&lt;div&gt;However,&nbsp;it&nbsp;made&nbsp;me&nbsp;realize&nbsp;that&nbsp;I&nbsp;was&nbsp;not&nbsp;prepared&nbsp;for&nbsp;the,&nbsp;let’s&nbsp;say,&nbsp;political&nbsp;discussions&nbsp;that&nbsp;I&nbsp;triggered.&lt;/div&gt;&lt;div&gt;I&nbsp;wanted&nbsp;to&nbsp;get&nbsp;this&nbsp;out&nbsp;and&nbsp;off-my-plate&nbsp;in&nbsp;time&nbsp;for&nbsp;the&nbsp;hackathon.&nbsp;It&nbsp;turned&nbsp;out&nbsp;that&nbsp;by&nbsp;doing&nbsp;that&nbsp;I&nbsp;didn’t&nbsp;put&nbsp;it&nbsp;off-my-plate&nbsp;at&nbsp;all.&nbsp;To&nbsp;the&nbsp;contrary,&nbsp;it&nbsp;developed&nbsp;into&nbsp;a&nbsp;time-&nbsp;and&nbsp;fun-suck.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;So&nbsp;in&nbsp;order&nbsp;to&nbsp;avoid&nbsp;that,&nbsp;I&nbsp;want&nbsp;to&nbsp;step&nbsp;back&nbsp;a&nbsp;little&nbsp;and&nbsp;make&nbsp;this&nbsp;back&nbsp;into&nbsp;the&nbsp;little&nbsp;fun&nbsp;playground&nbsp;that&nbsp;it&nbsp;was.&lt;/div&gt;&lt;div&gt;It&nbsp;has&nbsp;been&nbsp;made&nbsp;a&nbsp;much&nbsp;bigger&nbsp;deal&nbsp;than&nbsp;it&nbsp;actually&nbsp;is,&nbsp;and&nbsp;it&nbsp;needs&nbsp;time&nbsp;to&nbsp;mature&nbsp;before&nbsp;making&nbsp;it&nbsp;into&nbsp;imglib&nbsp;or&nbsp;fiji&nbsp;or&nbsp;wherever.&lt;/div&gt;&lt;div&gt;By&nbsp;mature&nbsp;I&nbsp;mean&nbsp;that&nbsp;it&nbsp;must&nbsp;be&nbsp;a&nbsp;place&nbsp;where&nbsp;I&nbsp;can&nbsp;try&nbsp;ideas&nbsp;without&nbsp;worrying&nbsp;about&nbsp;compatibility,&nbsp;integratability,&nbsp;stepping&nbsp;on&nbsp;peoples&nbsp;toes,&nbsp;etc.&lt;/div&gt;&lt;div&gt;So,&nbsp;this&nbsp;is&nbsp;what&nbsp;will&nbsp;happen&nbsp;in&nbsp;my&nbsp;github&nbsp;repository.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;code&nbsp;is&nbsp;under&nbsp;BSD&nbsp;license,&nbsp;so&nbsp;of&nbsp;course&nbsp;if&nbsp;someone&nbsp;wants&nbsp;to&nbsp;fork,&nbsp;pick&nbsp;pieces&nbsp;out&nbsp;of&nbsp;it&nbsp;etc&nbsp;they&nbsp;are&nbsp;more&nbsp;than&nbsp;welcome.&lt;/div&gt;&lt;div&gt;If&nbsp;there&nbsp;is&nbsp;a&nbsp;fork&nbsp;intended&nbsp;specifically&nbsp;for&nbsp;scijava/imglib2/imagej/fiji&nbsp;purposes,&nbsp;I’ll&nbsp;be&nbsp;glad&nbsp;to&nbsp;help&nbsp;with&nbsp;that.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;I&nbsp;think&nbsp;it&nbsp;is&nbsp;orthogonal&nbsp;to&nbsp;what&nbsp;you&nbsp;do&nbsp;with&nbsp;compile-time&nbsp;code&lt;br&gt;generation&nbsp;currently&nbsp;and&nbsp;therefore&nbsp;might&nbsp;complement&nbsp;it&nbsp;nicely.&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;-&nbsp;I&nbsp;agree&nbsp;that&nbsp;the&nbsp;bytecode&nbsp;manipulation&nbsp;and&nbsp;code&nbsp;generation&nbsp;strategies&nbsp;can&lt;br&gt;&nbsp;&nbsp;complement&nbsp;each&nbsp;other&nbsp;nicely.&nbsp;I&nbsp;am&nbsp;looking&nbsp;forward&nbsp;to&nbsp;the&nbsp;upcoming&nbsp;ImgLib2&lt;br&gt;&nbsp;&nbsp;hackathon&nbsp;so&nbsp;that&nbsp;we&nbsp;can&nbsp;show&nbsp;you&nbsp;how&nbsp;OPS&nbsp;tackles&nbsp;the&nbsp;performance&nbsp;issue&nbsp;in&nbsp;a&lt;br&gt;&nbsp;&nbsp;way&nbsp;that&nbsp;facilitates&nbsp;extensibility&nbsp;and&nbsp;keeps&nbsp;concerns&nbsp;well&nbsp;separated!&nbsp;If&nbsp;you&lt;br&gt;&nbsp;&nbsp;have&nbsp;a&nbsp;chance&nbsp;to&nbsp;explore&nbsp;OPS&nbsp;in&nbsp;depth&nbsp;before&nbsp;the&nbsp;hackathon,&nbsp;it&nbsp;would&nbsp;be&nbsp;very&lt;br&gt;&nbsp;&nbsp;helpful&nbsp;to&nbsp;expedite&nbsp;later&nbsp;discussion.&lt;br&gt;&lt;br&gt;-&nbsp;I&nbsp;encourage&nbsp;you&nbsp;to&nbsp;study&nbsp;ImageJ&nbsp;OPS&nbsp;before&nbsp;continuing&nbsp;this&nbsp;project&nbsp;because&nbsp;it&lt;br&gt;&nbsp;&nbsp;provides&nbsp;the&nbsp;necessary&nbsp;infrastructure&nbsp;already,&nbsp;matured&nbsp;over&nbsp;a&nbsp;course&nbsp;of&lt;br&gt;&nbsp;&nbsp;several&nbsp;iterations.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I’ve&nbsp;been&nbsp;following&nbsp;ImageJ-Ops&nbsp;loosely.&nbsp;As&nbsp;I&nbsp;understand&nbsp;it&nbsp;still&nbsp;very&nbsp;much&nbsp;in&nbsp;flux&nbsp;and&nbsp;documentation&nbsp;is&nbsp;very&nbsp;sparse.&nbsp;I’m&nbsp;looking&nbsp;forward&nbsp;to&nbsp;learn&nbsp;about&nbsp;it&nbsp;in&nbsp;personal&nbsp;discussion&nbsp;at&nbsp;the&nbsp;hackathon.&nbsp;I’ll&nbsp;probably&nbsp;not&nbsp;be&nbsp;able&nbsp;to&nbsp;get&nbsp;an&nbsp;in-depth&nbsp;look&nbsp;before.&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;-&nbsp;For&nbsp;demonstration&nbsp;purposes,&nbsp;using&nbsp;a&nbsp;Java&nbsp;Agent&nbsp;at&nbsp;startup&nbsp;is&nbsp;great;&nbsp;We&nbsp;will&lt;br&gt;&nbsp;&nbsp;definitely&nbsp;want&nbsp;to&nbsp;explore&nbsp;practical&nbsp;ways&nbsp;of&nbsp;applying&nbsp;the&nbsp;bytecode&lt;br&gt;&nbsp;&nbsp;manipulation.&nbsp;It&nbsp;should&nbsp;be&nbsp;achievable&nbsp;--&nbsp;we&nbsp;do&nbsp;it&nbsp;already&nbsp;in&nbsp;the&nbsp;ImageJ&nbsp;Legacy&lt;br&gt;&nbsp;&nbsp;project&nbsp;to&nbsp;rewrite&nbsp;portions&nbsp;of&nbsp;ImageJ1&nbsp;as&nbsp;needed.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;The&nbsp;important&nbsp;thing&nbsp;is&nbsp;that&nbsp;it&nbsp;needs&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;intercept&nbsp;any&nbsp;class&nbsp;as&nbsp;it&nbsp;is&nbsp;loaded&nbsp;into&nbsp;the&nbsp;JVM.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;think&nbsp;another&nbsp;perfect&nbsp;place&nbsp;to&nbsp;put&nbsp;it&nbsp;is&nbsp;in&nbsp;a&nbsp;ClassLoader.&lt;/div&gt;&lt;div&gt;Building&nbsp;on&nbsp;OSGi,&nbsp;that&nbsp;is&nbsp;probably&nbsp;a&nbsp;feasible&nbsp;way&nbsp;to&nbsp;go&nbsp;for&nbsp;KNIME.&lt;/div&gt;&lt;div&gt;Does&nbsp;ImageJ2&nbsp;use&nbsp;custom&nbsp;ClassLoaders?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;best&nbsp;regards,&lt;/div&gt;&lt;div&gt;Tobias&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
