<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html&nbsp;charset=windows-1252&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&gt;Hi&nbsp;Robert,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;the&nbsp;problem&nbsp;is&nbsp;the&nbsp;following:&lt;/div&gt;&lt;div&gt;In&nbsp;the&nbsp;ImgLabeling&nbsp;constructor&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(147,&nbsp;26,&nbsp;104);&quot;&gt;public&lt;/span&gt;&nbsp;ImgLabeling(&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(147,&nbsp;26,&nbsp;104);&quot;&gt;final&lt;/span&gt;&nbsp;RandomAccessibleInterval&lt;&nbsp;I&nbsp;&gt;&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;img&lt;/span&gt;&nbsp;)&lt;/div&gt;&lt;/div&gt;&lt;div&gt;the&nbsp;img&nbsp;you&nbsp;pass&nbsp;is&nbsp;used&nbsp;to&nbsp;store&nbsp;the&nbsp;labels&nbsp;at&nbsp;each&nbsp;pixel.&lt;/div&gt;&lt;div&gt;(The&nbsp;way&nbsp;that&nbsp;works&nbsp;is&nbsp;that&nbsp;integers&nbsp;are&nbsp;mapped&nbsp;to&nbsp;sets&nbsp;of&nbsp;labels&nbsp;that&nbsp;occur.&nbsp;If&nbsp;you&nbsp;have&nbsp;labels&nbsp;of&nbsp;type&nbsp;String,&nbsp;i.e.,&nbsp;a&nbsp;ImgLabeling&lt;String,IntType&gt;,&lt;/div&gt;&lt;div&gt;then&nbsp;depending&nbsp;on&nbsp;which&nbsp;labels&nbsp;and&nbsp;combinations&nbsp;of&nbsp;labels&nbsp;actually&nbsp;occur&nbsp;in&nbsp;your&nbsp;labeling,&nbsp;the&nbsp;mapping&nbsp;might&nbsp;be&nbsp;something&nbsp;like&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&nbsp;color:&nbsp;rgb(78,&nbsp;144,&nbsp;114);&quot;&gt;&nbsp;0&nbsp;-&gt;&nbsp;{}&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&nbsp;color:&nbsp;rgb(78,&nbsp;144,&nbsp;114);&quot;&gt;&nbsp;1&nbsp;-&gt;&nbsp;{&quot;A&quot;}&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&nbsp;color:&nbsp;rgb(78,&nbsp;144,&nbsp;114);&quot;&gt;&nbsp;2&nbsp;-&gt;&nbsp;{&quot;B&quot;}&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&nbsp;color:&nbsp;rgb(78,&nbsp;144,&nbsp;114);&quot;&gt;&nbsp;3&nbsp;-&gt;&nbsp;{&quot;B&quot;,&quot;C&quot;}&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&nbsp;color:&nbsp;rgb(78,&nbsp;144,&nbsp;114);&quot;&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Helvetica;&nbsp;font-size:&nbsp;12px;&quot;&gt;etc...&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Helvetica;&nbsp;font-size:&nbsp;12px;&quot;&gt;The&nbsp;mapping&nbsp;is&nbsp;build,&nbsp;as&nbsp;you&nbsp;add&nbsp;labels&nbsp;to&nbsp;pixels.)&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Helvetica;&nbsp;font-size:&nbsp;12px;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Helvetica;&nbsp;font-size:&nbsp;12px;&quot;&gt;The&nbsp;assumption&nbsp;is&nbsp;that&nbsp;initially&nbsp;the&nbsp;labeling&nbsp;is&nbsp;empty,&nbsp;that&nbsp;is&nbsp;all&nbsp;zeros&nbsp;in&nbsp;the&nbsp;backing&nbsp;image,&nbsp;and&nbsp;the&nbsp;mapping&nbsp;just&nbsp;comprising&nbsp;0&nbsp;-&gt;&nbsp;{}.&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Helvetica;&nbsp;font-size:&nbsp;12px;&quot;&gt;In&nbsp;your&nbsp;example,&nbsp;you&nbsp;passed&nbsp;the&nbsp;labelMap&nbsp;as&nbsp;the&nbsp;backing&nbsp;image.&nbsp;This&nbsp;is&nbsp;not&nbsp;zeroed.&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Helvetica;&nbsp;font-size:&nbsp;12px;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Helvetica;&nbsp;font-size:&nbsp;12px;&quot;&gt;One&nbsp;way&nbsp;to&nbsp;make&nbsp;your&nbsp;example&nbsp;work&nbsp;is&nbsp;to&nbsp;simply&nbsp;use&nbsp;a&nbsp;new,&nbsp;empty&nbsp;backing&nbsp;image,&nbsp;and&nbsp;then&nbsp;set&nbsp;the&nbsp;labels&nbsp;from&nbsp;the&nbsp;labelMap&nbsp;like&nbsp;you&nbsp;did.&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Helvetica;&nbsp;font-size:&nbsp;12px;&quot;&gt;Replace&nbsp;this:&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Helvetica;&nbsp;font-size:&nbsp;12px;&quot;&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(147,&nbsp;26,&nbsp;104);&quot;&gt;final&lt;/span&gt;&nbsp;RandomAccessibleInterval&lt;&nbsp;IntType&nbsp;&gt;&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;img&lt;/span&gt;&nbsp;=&nbsp;ImageJFunctions.wrapNumeric(&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;labelMap&lt;/span&gt;&nbsp;);&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;Img&lt;&nbsp;FloatType&nbsp;&gt;&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;img2&lt;/span&gt;&nbsp;=&nbsp;ImageJFunctions.convertFloat(&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;labelMap&lt;/span&gt;&nbsp;);&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(147,&nbsp;26,&nbsp;104);&quot;&gt;final&lt;/span&gt;&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(147,&nbsp;26,&nbsp;104);&quot;&gt;long&lt;/span&gt;[]&nbsp;&lt;span&nbsp;style=&quot;text-decoration:&nbsp;underline;&nbsp;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;dims&lt;/span&gt;&nbsp;=&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(147,&nbsp;26,&nbsp;104);&quot;&gt;new&lt;/span&gt;&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(147,&nbsp;26,&nbsp;104);&quot;&gt;long&lt;/span&gt;[&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;img&lt;/span&gt;.numDimensions()&nbsp;];&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;ImgLabeling&lt;&nbsp;Integer,&nbsp;IntType&nbsp;&gt;&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;labeling&lt;/span&gt;&nbsp;=&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(147,&nbsp;26,&nbsp;104);&quot;&gt;new&lt;/span&gt;&nbsp;ImgLabeling&lt;&nbsp;Integer,&nbsp;IntType&nbsp;&gt;(&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;img&lt;/span&gt;&nbsp;);&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Helvetica;&nbsp;font-size:&nbsp;12px;&quot;&gt;by&nbsp;this:&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;Helvetica;&nbsp;font-size:&nbsp;12px;&quot;&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(147,&nbsp;26,&nbsp;104);&quot;&gt;final&lt;/span&gt;&nbsp;Img&lt;&nbsp;FloatType&nbsp;&gt;&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;img2&lt;/span&gt;&nbsp;=&nbsp;ImageJFunctions.convertFloat(&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;labelMap&lt;/span&gt;&nbsp;);&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(147,&nbsp;26,&nbsp;104);&quot;&gt;final&lt;/span&gt;&nbsp;Dimensions&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;dims&lt;/span&gt;&nbsp;=&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;img2&lt;/span&gt;;&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(147,&nbsp;26,&nbsp;104);&quot;&gt;final&lt;/span&gt;&nbsp;IntType&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;t&lt;/span&gt;&nbsp;=&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(147,&nbsp;26,&nbsp;104);&quot;&gt;new&lt;/span&gt;&nbsp;IntType();&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(147,&nbsp;26,&nbsp;104);&quot;&gt;final&lt;/span&gt;&nbsp;RandomAccessibleInterval&lt;&nbsp;IntType&nbsp;&gt;&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;img&lt;/span&gt;&nbsp;=&nbsp;Util.getArrayOrCellImgFactory(&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;dims&lt;/span&gt;,&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;t&lt;/span&gt;&nbsp;).create(&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;dims&lt;/span&gt;,&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;t&lt;/span&gt;&nbsp;);&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(147,&nbsp;26,&nbsp;104);&quot;&gt;final&lt;/span&gt;&nbsp;ImgLabeling&lt;&nbsp;Integer,&nbsp;IntType&nbsp;&gt;&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;labeling&lt;/span&gt;&nbsp;=&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(147,&nbsp;26,&nbsp;104);&quot;&gt;new&lt;/span&gt;&nbsp;ImgLabeling&lt;&nbsp;Integer,&nbsp;IntType&nbsp;&gt;(&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;img&lt;/span&gt;&nbsp;);&lt;/div&gt;&lt;div&gt;Then&nbsp;it&nbsp;works.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;For&nbsp;transfering&nbsp;the&nbsp;labeling&nbsp;you&nbsp;do&nbsp;not&nbsp;have&nbsp;to&nbsp;loop&nbsp;over&nbsp;all&nbsp;the&nbsp;labels.&nbsp;you&nbsp;could&nbsp;just&nbsp;do&nbsp;this:&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(147,&nbsp;26,&nbsp;104);&quot;&gt;final&lt;/span&gt;&nbsp;Cursor&lt;&nbsp;LabelingType&lt;&nbsp;Integer&nbsp;&gt;&nbsp;&gt;&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;labelCursor&lt;/span&gt;&nbsp;=&nbsp;Views.flatIterable(&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;labeling&lt;/span&gt;&nbsp;).cursor();&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(147,&nbsp;26,&nbsp;104);&quot;&gt;for&lt;/span&gt;&nbsp;(&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(147,&nbsp;26,&nbsp;104);&quot;&gt;final&lt;/span&gt;&nbsp;UnsignedByteType&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;input&lt;/span&gt;&nbsp;:&nbsp;Views.flatIterable(&nbsp;ImageJFunctions.wrapByte(&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;labelMap&lt;/span&gt;&nbsp;)&nbsp;)&nbsp;)&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;{&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(147,&nbsp;26,&nbsp;104);&quot;&gt;final&lt;/span&gt;&nbsp;LabelingType&lt;&nbsp;Integer&nbsp;&gt;&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;element&lt;/span&gt;&nbsp;=&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;labelCursor&lt;/span&gt;.next();&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(147,&nbsp;26,&nbsp;104);&quot;&gt;if&lt;/span&gt;&nbsp;(&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;input&lt;/span&gt;.get()&nbsp;!=&nbsp;0&nbsp;)&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;element&lt;/span&gt;.add(&nbsp;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(126,&nbsp;80,&nbsp;79);&quot;&gt;input&lt;/span&gt;.get()&nbsp;);&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&quot;&gt;&lt;span&nbsp;class=&quot;Apple-tab-span&quot;&nbsp;style=&quot;white-space:&nbsp;pre;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;}&lt;/div&gt;&lt;/div&gt;&lt;div&gt;(This&nbsp;assumes&nbsp;that&nbsp;in&nbsp;labelMap&nbsp;the&nbsp;value&nbsp;0&nbsp;means&nbsp;“no&nbsp;label”).&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;principle,&nbsp;if&nbsp;your&nbsp;labelMap&nbsp;has&nbsp;values&nbsp;0,&nbsp;1,&nbsp;2,&nbsp;...&nbsp;without&nbsp;big&nbsp;gaps,&nbsp;and&nbsp;0&nbsp;means&nbsp;“no&nbsp;label”&nbsp;you&nbsp;could&nbsp;just&nbsp;use&nbsp;it&nbsp;directly&nbsp;as&nbsp;backing&nbsp;image&nbsp;and&nbsp;produce&nbsp;a&nbsp;fitting&nbsp;LabelingMapping,&nbsp;like&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&nbsp;color:&nbsp;rgb(78,&nbsp;144,&nbsp;114);&quot;&gt;&nbsp;0&nbsp;-&gt;&nbsp;{}&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&nbsp;color:&nbsp;rgb(78,&nbsp;144,&nbsp;114);&quot;&gt;&nbsp;1&nbsp;-&gt;&nbsp;{1}&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&nbsp;color:&nbsp;rgb(78,&nbsp;144,&nbsp;114);&quot;&gt;&nbsp;2&nbsp;-&gt;&nbsp;{2}&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&nbsp;color:&nbsp;rgb(78,&nbsp;144,&nbsp;114);&quot;&gt;&nbsp;3&nbsp;-&gt;&nbsp;{3}&lt;/div&gt;&lt;div&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;font-size:&nbsp;11px;&nbsp;font-family:&nbsp;Monaco;&nbsp;color:&nbsp;rgb(78,&nbsp;144,&nbsp;114);&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;etc&nbsp;yourself.&nbsp;But&nbsp;that&nbsp;involves&nbsp;diving&nbsp;much&nbsp;deeper&nbsp;into&nbsp;the&nbsp;details,&nbsp;basically&nbsp;reading&nbsp;through&nbsp;the&nbsp;code&nbsp;of&nbsp;ImgLabeling&nbsp;and&nbsp;LabelingMapping.&lt;/div&gt;&lt;div&gt;I&nbsp;would&nbsp;recommend&nbsp;above&nbsp;solution&nbsp;for&nbsp;now.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;best&nbsp;regards,&lt;/div&gt;&lt;div&gt;Tobias&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;On&nbsp;08&nbsp;Sep&nbsp;2015,&nbsp;at&nbsp;09:11,&nbsp;Robert&nbsp;Haase&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:rhaase@mpi-cbg.de&quot;&gt;rhaase@mpi-cbg.de&lt;/a&gt;&gt;&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Hi&nbsp;All,&lt;br&gt;&lt;br&gt;I'm&nbsp;quite&nbsp;new&nbsp;in&nbsp;developing&nbsp;imagej-plugins&nbsp;using&nbsp;imglib2.&nbsp;I&nbsp;ran&nbsp;in&nbsp;some&nbsp;issues&nbsp;working&nbsp;with&nbsp;Labeling&nbsp;and&nbsp;Regions&nbsp;in&nbsp;imglib2.&nbsp;Hopefully,&nbsp;somebody&nbsp;of&nbsp;you&nbsp;can&nbsp;help&nbsp;me.&nbsp;This&nbsp;is&nbsp;what&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;do:&lt;br&gt;&lt;br&gt;I&nbsp;have&nbsp;an&nbsp;image(Plus)&nbsp;where&nbsp;pixel&nbsp;values&nbsp;correspond&nbsp;to&nbsp;the&nbsp;desired&nbsp;labeling.&nbsp;Thus,&nbsp;all&nbsp;pixels&nbsp;with&nbsp;value&nbsp;1&nbsp;belong&nbsp;to&nbsp;label&nbsp;1,&nbsp;all&nbsp;pixels&nbsp;with&nbsp;value&nbsp;2&nbsp;belong&nbsp;to&nbsp;label&nbsp;2&nbsp;and&nbsp;so&nbsp;on.&nbsp;Labelled&nbsp;regions&nbsp;cannot&nbsp;overlap.&nbsp;Now,&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;create&nbsp;an&nbsp;ImgLabeling&nbsp;from&nbsp;the&nbsp;given&nbsp;ImagePlus&nbsp;to&nbsp;manage&nbsp;the&nbsp;corresponding&nbsp;regions&nbsp;of&nbsp;interest&nbsp;in&nbsp;imglib2&nbsp;and&nbsp;to&nbsp;do&nbsp;the&nbsp;analysis&nbsp;using&nbsp;this&nbsp;library.&lt;br&gt;I&nbsp;was&nbsp;able&nbsp;to&nbsp;create&nbsp;some&nbsp;functions&nbsp;which&nbsp;appear&nbsp;to&nbsp;do&nbsp;the&nbsp;transformation,&nbsp;however,&nbsp;the&nbsp;results&nbsp;are&nbsp;not&nbsp;fully&nbsp;understandable&nbsp;for&nbsp;me.&nbsp;On&nbsp;bottom&nbsp;of&nbsp;this&nbsp;email&nbsp;you&nbsp;find&nbsp;&quot;minimal&quot;&nbsp;example&nbsp;code&nbsp;(which&nbsp;runs&nbsp;fine&nbsp;in&nbsp;eclipse&nbsp;set&nbsp;up&nbsp;for&nbsp;ImageJ-development)&nbsp;which&nbsp;creates&nbsp;a&nbsp;labelmap-ImagePlus,&nbsp;transforms&nbsp;it&nbsp;into&nbsp;ImgLabeling&nbsp;and&nbsp;displays&nbsp;binary&nbsp;images&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;regions.&nbsp;However,&nbsp;when&nbsp;I&nbsp;input&nbsp;a&nbsp;label&nbsp;with&nbsp;100&nbsp;pixels,&nbsp;the&nbsp;corresponding&nbsp;output&nbsp;region&nbsp;may&nbsp;or&nbsp;may&nbsp;not&nbsp;have&nbsp;the&nbsp;same&nbsp;number&nbsp;of&nbsp;pixels.&nbsp;So&nbsp;the&nbsp;output&nbsp;of&nbsp;the&nbsp;program&nbsp;is:&lt;br&gt;&lt;br&gt;Number&nbsp;of&nbsp;input&nbsp;pixels&nbsp;in&nbsp;label&nbsp;0:&nbsp;9400&lt;br&gt;Number&nbsp;of&nbsp;input&nbsp;pixels&nbsp;in&nbsp;label&nbsp;1:&nbsp;100&lt;br&gt;Number&nbsp;of&nbsp;input&nbsp;pixels&nbsp;in&nbsp;label&nbsp;2:&nbsp;200&lt;br&gt;Number&nbsp;of&nbsp;input&nbsp;pixels&nbsp;in&nbsp;label&nbsp;3:&nbsp;300&lt;br&gt;Number&nbsp;of&nbsp;input&nbsp;pixels&nbsp;in&nbsp;label&nbsp;4:&nbsp;0&lt;br&gt;Number&nbsp;of&nbsp;out&nbsp;pixels&nbsp;in&nbsp;region:&nbsp;10000&lt;br&gt;Number&nbsp;of&nbsp;out&nbsp;pixels&nbsp;in&nbsp;region:&nbsp;600&lt;br&gt;Number&nbsp;of&nbsp;out&nbsp;pixels&nbsp;in&nbsp;region:&nbsp;500&lt;br&gt;Number&nbsp;of&nbsp;out&nbsp;pixels&nbsp;in&nbsp;region:&nbsp;300&lt;br&gt;&lt;br&gt;As&nbsp;you&nbsp;can&nbsp;see,&nbsp;the&nbsp;number&nbsp;of&nbsp;read-in&nbsp;pixels&nbsp;is&nbsp;not&nbsp;equal&nbsp;to&nbsp;the&nbsp;number&nbsp;of&nbsp;pixels&nbsp;which&nbsp;are&nbsp;positive&nbsp;afterwards&nbsp;in&nbsp;the&nbsp;corresponding&nbsp;region.&nbsp;The&nbsp;program&nbsp;visualises&nbsp;the&nbsp;images&nbsp;as&nbsp;well.&nbsp;The&nbsp;mistake&nbsp;in&nbsp;the&nbsp;result&nbsp;is&nbsp;obvious.&nbsp;My&nbsp;mistake&nbsp;in&nbsp;the&nbsp;code&nbsp;is&nbsp;not&nbsp;that&nbsp;obvious&nbsp;to&nbsp;me.&lt;br&gt;&lt;br&gt;I&nbsp;guess,&nbsp;I&nbsp;interpret&nbsp;the&nbsp;meaning&nbsp;of&nbsp;regions&nbsp;and/or&nbsp;labels&nbsp;wrong.&nbsp;Hopefully&nbsp;somebody&nbsp;of&nbsp;you&nbsp;may&nbsp;point&nbsp;me&nbsp;in&nbsp;the&nbsp;right&nbsp;direction&nbsp;to&nbsp;do&nbsp;the&nbsp;above&nbsp;mentioned&nbsp;transformation&nbsp;properly.&lt;br&gt;&lt;br&gt;Thanks&nbsp;a&nbsp;lot&nbsp;in&nbsp;advance!&lt;br&gt;Robert&lt;br&gt;&lt;br&gt;LabelingExample.java&nbsp;----------------------------&lt;br&gt;&lt;br&gt;&lt;br&gt;import&nbsp;ij.ImagePlus;&lt;br&gt;import&nbsp;ij.gui.NewImage;&lt;br&gt;import&nbsp;ij.process.ImageProcessor;&lt;br&gt;&lt;br&gt;import&nbsp;java.awt.Rectangle;&lt;br&gt;import&nbsp;java.io.IOException;&lt;br&gt;import&nbsp;java.util.Set;&lt;br&gt;&lt;br&gt;import&nbsp;net.imglib2.Cursor;&lt;br&gt;import&nbsp;net.imglib2.RandomAccess;&lt;br&gt;import&nbsp;net.imglib2.RandomAccessibleInterval;&lt;br&gt;import&nbsp;net.imglib2.img.Img;&lt;br&gt;import&nbsp;net.imglib2.img.array.ArrayImgs;&lt;br&gt;import&nbsp;net.imglib2.img.display.imagej.ImageJFunctions;&lt;br&gt;import&nbsp;net.imglib2.roi.labeling.ImgLabeling;&lt;br&gt;import&nbsp;net.imglib2.roi.labeling.LabelRegion;&lt;br&gt;import&nbsp;net.imglib2.roi.labeling.LabelRegionCursor;&lt;br&gt;import&nbsp;net.imglib2.roi.labeling.LabelRegions;&lt;br&gt;import&nbsp;net.imglib2.roi.labeling.LabelingType;&lt;br&gt;import&nbsp;net.imglib2.type.logic.BitType;&lt;br&gt;import&nbsp;net.imglib2.type.logic.BoolType;&lt;br&gt;import&nbsp;net.imglib2.type.numeric.integer.IntType;&lt;br&gt;import&nbsp;net.imglib2.type.numeric.real.FloatType;&lt;br&gt;&lt;br&gt;public&nbsp;class&nbsp;LabelingExample&nbsp;{&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;LabelingExample()&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;{&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;ij.ImageJ();&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//Create&nbsp;and&nbsp;show&nbsp;a&nbsp;simple&nbsp;test&nbsp;image,&nbsp;100x100&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ImagePlus&nbsp;imp&nbsp;=&nbsp;createTestImage();&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imp.show();&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//Create&nbsp;an&nbsp;ImgLabeling&nbsp;from&nbsp;the&nbsp;ImagePlus&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ImgLabeling&lt;Integer,&nbsp;IntType&gt;&nbsp;labeling&nbsp;=&nbsp;getIntIntImgLabellingFromLabelMapImagePlus(imp);&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//Read&nbsp;out&nbsp;regions&nbsp;and&nbsp;labelNames&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LabelRegions&lt;Integer&gt;&nbsp;regions&nbsp;=&nbsp;new&nbsp;LabelRegions&lt;Integer&gt;(labeling);&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set&lt;Integer&gt;&nbsp;labelNames&nbsp;=&nbsp;labeling.getMapping().getLabels();&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//Visualise&nbsp;the&nbsp;labels&nbsp;as&nbsp;binary&nbsp;images.&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(Integer&nbsp;labelName&nbsp;:&nbsp;labelNames&nbsp;)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LabelRegion&lt;Integer&gt;&nbsp;lr&nbsp;=&nbsp;regions.getLabelRegion(labelName);&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ImageJFunctions.show(labelRegionToBinaryImage(lr,&nbsp;(Img&lt;IntType&gt;)labeling.getIndexImg()));&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;//Create&nbsp;an&nbsp;image&nbsp;with&nbsp;three&nbsp;labels&nbsp;(+background)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;//The&nbsp;three&nbsp;labels&nbsp;have&nbsp;an&nbsp;area&nbsp;of&nbsp;100,&nbsp;200&nbsp;and&nbsp;300.&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;ImagePlus&nbsp;createTestImage()&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;{&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ImagePlus&nbsp;imp&nbsp;=&nbsp;NewImage.createByteImage(&quot;Test&nbsp;iamge&quot;,&nbsp;100,&nbsp;100,&nbsp;1,&nbsp;NewImage.FILL_BLACK);&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ImageProcessor&nbsp;ip&nbsp;=&nbsp;imp.getProcessor();&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip.setRoi(new&nbsp;Rectangle(10,&nbsp;10,&nbsp;10,&nbsp;10));&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip.setColor(1);&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip.fill();&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip.setRoi(new&nbsp;Rectangle(20,&nbsp;20,&nbsp;10,&nbsp;20));&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip.setColor(2);&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip.fill();&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip.setRoi(new&nbsp;Rectangle(40,&nbsp;40,&nbsp;10,&nbsp;30));&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip.setColor(3);&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ip.fill();&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;imp;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;//Transform&nbsp;an&nbsp;ImagePlus&nbsp;to&nbsp;a&nbsp;Labeling&nbsp;Imp.&nbsp;The&nbsp;original&nbsp;pixel&nbsp;value&nbsp;should&nbsp;be&nbsp;the&nbsp;label&nbsp;afterwards.&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;ImgLabeling&lt;Integer,&nbsp;IntType&gt;&nbsp;getIntIntImgLabellingFromLabelMapImagePlus(ImagePlus&nbsp;labelMap)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;{&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;RandomAccessibleInterval&lt;&nbsp;IntType&nbsp;&gt;&nbsp;img&nbsp;=&nbsp;ImageJFunctions.wrapNumeric(labelMap);&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Img&lt;&nbsp;FloatType&nbsp;&gt;&nbsp;img2&nbsp;=&nbsp;ImageJFunctions.convertFloat(labelMap);&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;long[]&nbsp;dims&nbsp;=&nbsp;new&nbsp;long[&nbsp;img.numDimensions()&nbsp;];&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ImgLabeling&lt;&nbsp;Integer,&nbsp;IntType&nbsp;&gt;&nbsp;labeling&nbsp;=&nbsp;new&nbsp;ImgLabeling&lt;&nbsp;Integer,&nbsp;IntType&nbsp;&gt;(&nbsp;img&nbsp;);&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cursor&lt;LabelingType&lt;Integer&gt;&gt;&nbsp;labelCursor&nbsp;=&nbsp;labeling.cursor();&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RandomAccess&lt;FloatType&gt;&nbsp;imageRA&nbsp;=&nbsp;img2.randomAccess();&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Go&nbsp;through&nbsp;the&nbsp;whole&nbsp;image&nbsp;again&nbsp;and&nbsp;again&nbsp;for&nbsp;every&nbsp;single&nbsp;label,&nbsp;until&nbsp;no&nbsp;more&nbsp;label&nbsp;is&nbsp;found.&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;If&nbsp;you&nbsp;know&nbsp;a&nbsp;more&nbsp;efficient&nbsp;way&nbsp;to&nbsp;do&nbsp;this,&nbsp;tell&nbsp;me...&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;currentLabel&nbsp;=&nbsp;0;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;boolean&nbsp;anythingFound&nbsp;=&nbsp;true;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(anythingFound)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;anythingFound&nbsp;=&nbsp;false;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;labelCursor.reset();&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//Go&nbsp;through&nbsp;the&nbsp;whole&nbsp;image&nbsp;and&nbsp;add&nbsp;every&nbsp;pixel,&nbsp;that&nbsp;belongs&nbsp;to&nbsp;the&nbsp;currently&nbsp;processed&nbsp;label&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;count&nbsp;=&nbsp;0;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(labelCursor.hasNext())&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LabelingType&lt;Integer&gt;&nbsp;element&nbsp;=&nbsp;labelCursor.next();&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imageRA.setPosition(labelCursor);&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;i&nbsp;=&nbsp;(int)(imageRA.get().get());&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(i&nbsp;==&nbsp;currentLabel)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;element.add(i);&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;anythingFound&nbsp;=&nbsp;true;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count&nbsp;++;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(&quot;Number&nbsp;of&nbsp;input&nbsp;pixels&nbsp;in&nbsp;label&nbsp;&quot;&nbsp;+&nbsp;currentLabel&nbsp;+&nbsp;&quot;:&nbsp;&quot;&nbsp;+&nbsp;count);&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;currentLabel++;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ImageJFunctions.show(labeling.getIndexImg());&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;labeling;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;//Transform&nbsp;a&nbsp;Region&nbsp;to&nbsp;a&nbsp;binary&nbsp;image,&nbsp;which&nbsp;can&nbsp;be&nbsp;displayed&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;&lt;&nbsp;T,&nbsp;F&nbsp;&gt;&nbsp;Img&lt;BitType&gt;&nbsp;labelRegionToBinaryImage(LabelRegion&lt;T&gt;&nbsp;region,&nbsp;Img&lt;F&gt;&nbsp;img)&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;{&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;long[]&nbsp;pos&nbsp;=&nbsp;new&nbsp;long[&nbsp;img.numDimensions()&nbsp;];&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;long[]&nbsp;dims&nbsp;=&nbsp;new&nbsp;long[&nbsp;img.numDimensions()&nbsp;];&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;img.dimensions(&nbsp;dims&nbsp;);&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;final&nbsp;Img&lt;&nbsp;BitType&nbsp;&gt;&nbsp;newImage&nbsp;=&nbsp;ArrayImgs.bits(&nbsp;dims&nbsp;);&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RandomAccess&lt;BitType&gt;&nbsp;imageRA&nbsp;=&nbsp;newImage.randomAccess();&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LabelRegionCursor&nbsp;regionCursor&nbsp;=&nbsp;region.cursor();&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;count&nbsp;=&nbsp;0;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(regionCursor.hasNext())&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//Read&nbsp;yes/no&nbsp;from&nbsp;region&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BoolType&nbsp;regionElement&nbsp;=&nbsp;regionCursor.next();&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regionCursor.localize(pos);&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imageRA.setPosition(pos);&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BitType&nbsp;imageElement&nbsp;=&nbsp;imageRA.get();&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//Draw&nbsp;binary&nbsp;image&nbsp;pixel&nbsp;by&nbsp;pixel&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(regionElement.get())&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count++;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imageElement.set(true);&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imageElement.set(false);&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(&quot;Number&nbsp;of&nbsp;output&nbsp;pixels&nbsp;in&nbsp;region:&nbsp;&quot;&nbsp;+&nbsp;count);&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;newImage;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;//Just&nbsp;to&nbsp;run&nbsp;it&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;void&nbsp;main(final&nbsp;String...&nbsp;args)&nbsp;throws&nbsp;IOException&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;{&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new&nbsp;LabelingExample();&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&gt;}&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;--&nbsp;&lt;br&gt;Robert&nbsp;Haase&lt;br&gt;Bio-Image&nbsp;informatics,&nbsp;Scientific&nbsp;Computing&nbsp;Facility&lt;br&gt;&lt;br&gt;Max&nbsp;Planck&nbsp;Institute&nbsp;CBG&lt;br&gt;Pfotenhauer&nbsp;Str.&nbsp;108,&nbsp;01307&nbsp;Dresden&lt;br&gt;room:&nbsp;106&nbsp;(s)&lt;br&gt;phone:&nbsp;+49&nbsp;351&nbsp;210&nbsp;2972&lt;br&gt;fax:&nbsp;&nbsp;&nbsp;+49&nbsp;351&nbsp;210&nbsp;1689&lt;br&gt;&lt;br&gt;&lt;br&gt;_______________________________________________&lt;br&gt;ImageJ-devel&nbsp;mailing&nbsp;list&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:ImageJ-devel@imagej.net&quot;&gt;ImageJ-devel@imagej.net&lt;/a&gt;&lt;br&gt;http://imagej.net/mailman/listinfo/imagej-devel&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
