<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;&quot;&gt;&lt;div&gt;Hi&nbsp;all&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;I&nbsp;cc'ed&nbsp;the&nbsp;imagej-devel&nbsp;list,&nbsp;because&nbsp;this&nbsp;should&nbsp;be&nbsp;of&nbsp;wider&nbsp;interest.&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;The&nbsp;gist&nbsp;of&nbsp;the&nbsp;mails&nbsp;quoted&nbsp;below&nbsp;is&nbsp;that&nbsp;we&nbsp;(Christian&nbsp;Dietz,&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Jean-Yves&nbsp;Tinevez)&nbsp;are&nbsp;trying&nbsp;to&nbsp;unify&nbsp;the&nbsp;LocalNeighborhood&nbsp;(-Cursors)&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;that&nbsp;have&nbsp;been&nbsp;popping&nbsp;up&nbsp;in&nbsp;different&nbsp;places&nbsp;in&nbsp;ImgLib2.&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Currently,&nbsp;most&nbsp;of&nbsp;the&nbsp;relevant&nbsp;source&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;package&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;net.imglib2.algorithm.region.localneighborhood&nbsp;in&nbsp;algorithms-gpl.&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Maybe&nbsp;Jean-Yves&nbsp;and&nbsp;Christian&nbsp;could&nbsp;provide&nbsp;some&nbsp;more&nbsp;information&nbsp;on&nbsp;the&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;individual&nbsp;neighborhoods&nbsp;that&nbsp;are&nbsp;implemented.&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;BufferedRectangularNeighborhood&nbsp;is&nbsp;a&nbsp;very&nbsp;simple&nbsp;ring-buffer&nbsp;implementation,&nbsp;to&nbsp;reduce&nbsp;the&nbsp;number&nbsp;of&nbsp;pixel-accesses&nbsp;(yes&nbsp;there&nbsp;is&nbsp;a&nbsp;speed-up).&lt;br&gt;Additionaly&nbsp;I&nbsp;wrapped&nbsp;the&nbsp;HyperSphere&nbsp;stuff&nbsp;of&nbsp;Stephan&nbsp;Preibisch&nbsp;(HyperSphereNeighborhood).&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;I&nbsp;think&nbsp;there&nbsp;is&nbsp;no&nbsp;need&nbsp;for&nbsp;that:&nbsp;there&nbsp;is&nbsp;already&nbsp;a&nbsp;HyperSphere&nbsp;class&nbsp;which&nbsp;has&nbsp;the&nbsp;role&nbsp;of&nbsp;the&nbsp;neighborhood.&nbsp;We&nbsp;need&nbsp;to&nbsp;convince&nbsp;Stephan&nbsp;to&nbsp;tweak&nbsp;it&nbsp;to&nbsp;fit&nbsp;into&nbsp;the&nbsp;hierarchy.&nbsp;&lt;/div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;1.)&nbsp;Factory&nbsp;vs.&nbsp;CopyOn()&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;A&nbsp;factory&nbsp;could&nbsp;be&nbsp;constructed&nbsp;with&nbsp;parameters,&nbsp;for&nbsp;instance&nbsp;the&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;CellContainerFactory&nbsp;is&nbsp;constructed&nbsp;with&nbsp;cell&nbsp;dimensions.&nbsp;So&nbsp;a&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;HypersphereNeighborhood&nbsp;could&nbsp;be&nbsp;constructed&nbsp;with&nbsp;the&nbsp;radius&nbsp;for&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;example.&nbsp;However,&nbsp;I&nbsp;don't&nbsp;see&nbsp;much&nbsp;harm&nbsp;in&nbsp;adding&nbsp;the&nbsp;copyOn()&nbsp;method.&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Having&nbsp;only&nbsp;updateSource()&nbsp;would&nbsp;be&nbsp;too&nbsp;little,&nbsp;as&nbsp;we&nbsp;might&nbsp;want&nbsp;to&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;change&nbsp;the&nbsp;type&nbsp;T&nbsp;of&nbsp;the&nbsp;Neighborhood&nbsp;in&nbsp;copyOn()&nbsp;and&nbsp;only&nbsp;keep&nbsp;the&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;structure.In&nbsp;general,&nbsp;I&nbsp;don't&nbsp;like&nbsp;the&nbsp;updateSource()&nbsp;very&nbsp;much.&nbsp;For&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;instance,what&nbsp;happens&nbsp;if&nbsp;the&nbsp;new&nbsp;source&nbsp;has&nbsp;a&nbsp;different&nbsp;number&nbsp;of&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;dimensions?&lt;br&gt;&lt;/blockquote&gt;I&nbsp;agree.&nbsp;As&nbsp;long&nbsp;as&nbsp;one&nbsp;can&nbsp;simulate&nbsp;the&nbsp;updateSource()&nbsp;behaviour&nbsp;(maybe&nbsp;with&nbsp;copyOn)&nbsp;everything&nbsp;is&nbsp;fine.&lt;br&gt;But&nbsp;as&nbsp;you&nbsp;mentoined,&nbsp;how&nbsp;would&nbsp;we&nbsp;handle&nbsp;sources&nbsp;with&nbsp;more&nbsp;dimensions&nbsp;in&nbsp;copyOn?&nbsp;For&nbsp;instance&nbsp;copyOn&nbsp;on&nbsp;a&nbsp;RectangularNeighborhood&nbsp;(with&nbsp;3,5,7&nbsp;spans)&nbsp;is&nbsp;called&nbsp;with&nbsp;a&lt;br&gt;4-d&nbsp;source.&nbsp;What&nbsp;would&nbsp;be&nbsp;the&nbsp;span&nbsp;in&nbsp;this&nbsp;dimension?&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;suggest&nbsp;by&nbsp;contract:&nbsp;0.&nbsp;We&nbsp;would&nbsp;copy&nbsp;the&nbsp;span&nbsp;array&nbsp;to&nbsp;the&nbsp;new&nbsp;copy,&nbsp;and&nbsp;take&nbsp;the&nbsp;smallest&nbsp;array&nbsp;size&nbsp;as&nbsp;a&nbsp;limit.&nbsp;So&nbsp;that&nbsp;has&nbsp;soon&nbsp;as&nbsp;the&nbsp;numDimensions()&nbsp;are&nbsp;not&nbsp;equal,&nbsp;0s&nbsp;are&nbsp;fed&nbsp;to&nbsp;the&nbsp;span.&nbsp;It&nbsp;is&nbsp;the&nbsp;role&nbsp;of&nbsp;the&nbsp;concrete&nbsp;implementation&nbsp;to&nbsp;ensure&nbsp;it&nbsp;makes&nbsp;sense.&nbsp;&lt;i&gt;E.g.:&nbsp;&lt;/i&gt;copying&nbsp;a&nbsp;sphere&nbsp;to&nbsp;a&nbsp;2D&nbsp;image&nbsp;should&nbsp;make&nbsp;it&nbsp;a&nbsp;disc.&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;color=&quot;#000000&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;2.)&nbsp;Neighborhood&nbsp;interface&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;In&nbsp;addition&nbsp;to&nbsp;Positionable&nbsp;and&nbsp;IterableInterval,&nbsp;it&nbsp;could&nbsp;extend&nbsp;Localizable&nbsp;to&nbsp;get&nbsp;the&nbsp;position&nbsp;of&nbsp;the&nbsp;center.&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;Yap.&nbsp;Perfect.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;setSpan(long[]&nbsp;span);&lt;/div&gt;&lt;div&gt;span(long[]&nbsp;span);&lt;/div&gt;&lt;div&gt;copyOn(RandomAccessible&lt;T&gt;&nbsp;target)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;would&nbsp;like&nbsp;also&nbsp;to&nbsp;have&nbsp;a&nbsp;mother&nbsp;interface&nbsp;for&nbsp;the&nbsp;cursor,&nbsp;that&nbsp;would&nbsp;allow&nbsp;methods&nbsp;like&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;relativeDistance(int&nbsp;dim);&nbsp;//&nbsp;from&nbsp;the&nbsp;neighborhood&nbsp;center&lt;/div&gt;&lt;div&gt;relativeSquareDistance();&lt;/div&gt;&lt;div&gt;etc...&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;3.)&nbsp;IN&nbsp;extends&nbsp;RandomAccessibleInterval&lt;T&gt;&nbsp;parameter&nbsp;in&nbsp;AbstractNeighborhood,&nbsp;etc&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;I&nbsp;think&nbsp;all&nbsp;the&nbsp;Neighborhoods&nbsp;should&nbsp;be&nbsp;constructed&nbsp;on&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;RandomAccessible&lt;T&gt;&nbsp;instead&nbsp;of&nbsp;RandomAccessibleInterval&lt;T&gt;.&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;If&nbsp;interval&nbsp;extension&nbsp;is&nbsp;required&nbsp;then&nbsp;this&nbsp;should&nbsp;be&nbsp;done&nbsp;outside&nbsp;of&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;the&nbsp;Neighborhood.&nbsp;If&nbsp;we&nbsp;do&nbsp;this,&nbsp;then&nbsp;the&nbsp;IN&nbsp;parameter&nbsp;is&nbsp;no&nbsp;longer&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;required,&nbsp;right?&nbsp;The&nbsp;Neighborhood&nbsp;is&nbsp;just&nbsp;constructed&nbsp;with&nbsp;any&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;RandomAccessible&lt;T&gt;.&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;Agree.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;Tobias&nbsp;also&nbsp;suggest&nbsp;to&nbsp;make&nbsp;a&nbsp;double&nbsp;type&nbsp;to&nbsp;be&nbsp;more&nbsp;generic&nbsp;than&nbsp;just&nbsp;ExtendedRI&nbsp;etc…&nbsp;Could&nbsp;you&nbsp;do&nbsp;it?&nbsp;I&nbsp;am&nbsp;not&nbsp;strong&nbsp;enough&nbsp;with&nbsp;the&nbsp;generics&nbsp;to&nbsp;make&nbsp;it&nbsp;right.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;4.)&nbsp;move&nbsp;to&nbsp;imglib2&nbsp;core&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Eventually,&nbsp;the&nbsp;neighborhood&nbsp;should&nbsp;be&nbsp;moved&nbsp;to&nbsp;the&nbsp;core,&nbsp;maybe&nbsp;with&nbsp;the&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;exception&nbsp;of&nbsp;rather&nbsp;special-case&nbsp;stuff&nbsp;like&nbsp;DiscNeighborhood.&lt;br&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;Or&nbsp;is&nbsp;ops&nbsp;a&nbsp;better&nbsp;place?&nbsp;What&nbsp;do&nbsp;you&nbsp;think?&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;From&nbsp;my&nbsp;point&nbsp;of&nbsp;view&nbsp;it&nbsp;should&nbsp;be&nbsp;in&nbsp;the&nbsp;core,&nbsp;as&nbsp;these&nbsp;are&nbsp;basic&nbsp;data-structures.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;When&nbsp;the&nbsp;first&nbsp;3&nbsp;concrete&nbsp;implementations&nbsp;are&nbsp;done&nbsp;ok?&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Also&nbsp;i&nbsp;plan&nbsp;on&nbsp;removing&nbsp;DiscNeighborhood&nbsp;and&nbsp;SphereNeighborhood&nbsp;from&nbsp;imglib2:&nbsp;they&nbsp;are&nbsp;too&nbsp;specific&nbsp;and&nbsp;clumsy&nbsp;and&nbsp;do&nbsp;not&nbsp;fit&nbsp;what&nbsp;we&nbsp;are&nbsp;designing&nbsp;here.&nbsp;They&nbsp;are&nbsp;related&nbsp;to&nbsp;the&nbsp;ability&nbsp;to&nbsp;position&nbsp;a&nbsp;neighborhood&nbsp;using&nbsp;calibrated,&nbsp;real&nbsp;coordinates,&nbsp;as&nbsp;is&nbsp;x&nbsp;=&nbsp;6.5&nbsp;µm,&nbsp;etc..&nbsp;taking&nbsp;advantage&nbsp;of&nbsp;the&nbsp;calibration&nbsp;in&nbsp;IngPlus&lt;T&gt;&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;neighborhood&nbsp;hierarchy&nbsp;we&nbsp;are&nbsp;designing&nbsp;deal&nbsp;with&nbsp;pixel&nbsp;coordinates&nbsp;only&nbsp;and&nbsp;this&nbsp;is&nbsp;right.&nbsp;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Cheers&lt;/div&gt;&lt;div&gt;jy&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
