<tt>
&lt;div&gt;Thanks&nbsp;for&nbsp;your&nbsp;comments,&nbsp;Lee.&nbsp;I&nbsp;am&nbsp;forwarding&nbsp;this&nbsp;thread&nbsp;to&nbsp;imagej-devel,&nbsp;since&nbsp;the&nbsp;discussion&nbsp;is&nbsp;of&nbsp;general&nbsp;interest.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;----------&nbsp;Forwarded&nbsp;message&nbsp;----------&lt;br&gt;<br>
<br>
From:&nbsp;&lt;b&nbsp;class=&quot;gmail_sendername&quot;&gt;Lee&nbsp;Kamentsky&lt;/b&gt;&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:leek@broadinstitute.org&quot;&gt;leek@broadinstitute.org&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;Date:&nbsp;Mon,&nbsp;Jun&nbsp;18,&nbsp;2012&nbsp;at&nbsp;3:41&nbsp;PM&lt;br&gt;Subject:&nbsp;Re:&nbsp;CompositeOverlay&lt;br&gt;<br>
<br>
To:&nbsp;Barry&nbsp;DeZonia&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:bdezonia@gmail.com&quot;&gt;bdezonia@gmail.com&lt;/a&gt;&gt;&lt;br&gt;Cc:&nbsp;Curtis&nbsp;Rueden&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:ctrueden@wisc.edu&quot;&gt;ctrueden@wisc.edu&lt;/a&gt;&gt;,&nbsp;Lee&nbsp;Kamentsky&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:leek@broadinstitute.org&quot;&gt;leek@broadinstitute.org&lt;/a&gt;&gt;&lt;br&gt;<br>
<br>
&lt;br&gt;&lt;br&gt;Hi&nbsp;Barry,&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
On&nbsp;6/18/2012&nbsp;4:06&nbsp;PM,&nbsp;Barry&nbsp;DeZonia&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
Hey&nbsp;guys,&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;am&nbsp;wondering&nbsp;if&nbsp;the&nbsp;current&nbsp;CompositeOverlays&nbsp;approach&nbsp;is&nbsp;broken.&nbsp;Originally&nbsp;we&nbsp;had&nbsp;CompositeOverlay&nbsp;only&nbsp;be&nbsp;defined&nbsp;by&nbsp;a&nbsp;CompositeRegionOfInterest&nbsp;(defined&nbsp;in&nbsp;Imglib).&nbsp;This&nbsp;makes&nbsp;sense&nbsp;but&nbsp;we&nbsp;want&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;serialize&nbsp;overlays&nbsp;and&nbsp;in&nbsp;order&nbsp;to&nbsp;serialize&nbsp;CompositeOverlays&nbsp;we&nbsp;need&nbsp;to&nbsp;either&nbsp;push&nbsp;the&nbsp;serializing&nbsp;code&nbsp;down&nbsp;into&nbsp;Imglib&#39;s&nbsp;RegionOfInterest&nbsp;code&nbsp;or&nbsp;we&nbsp;need&nbsp;to&nbsp;have&nbsp;CompositeOverlays&nbsp;maintain&nbsp;the&nbsp;state&nbsp;of&nbsp;multiple&nbsp;overlays.&lt;br&gt;<br>
<br>
<br>
&lt;br&gt;<br>
Currently&nbsp;we&#39;ve&nbsp;started&nbsp;down&nbsp;the&nbsp;second&nbsp;road.&nbsp;But&nbsp;looking&nbsp;at&nbsp;the&nbsp;API&nbsp;for&nbsp;Overlay&nbsp;I&nbsp;can&nbsp;see&nbsp;things&nbsp;that&nbsp;are&nbsp;tricky&nbsp;to&nbsp;deal&nbsp;with.&nbsp;For&nbsp;instance&nbsp;getting&nbsp;well&nbsp;defined&nbsp;axes&nbsp;and&nbsp;ranges&nbsp;from&nbsp;the&nbsp;Overlays&nbsp;making&nbsp;up&nbsp;a&nbsp;Composite&nbsp;(e.g.&nbsp;what&nbsp;if&nbsp;axes&nbsp;of&nbsp;two&nbsp;overlays&nbsp;are&nbsp;different?).&lt;br&gt;<br>
<br>
<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;br&gt;&lt;/div&gt;<br>
I&nbsp;think&nbsp;the&nbsp;problem&nbsp;here&nbsp;is&nbsp;similar&nbsp;to&nbsp;the&nbsp;issues&nbsp;we&nbsp;have&nbsp;when&nbsp;combining&nbsp;any&nbsp;two&nbsp;objects&nbsp;-&nbsp;the&nbsp;EuclideanSpace&nbsp;of&nbsp;the&nbsp;objects&nbsp;might&nbsp;be&nbsp;different&nbsp;and&nbsp;the&nbsp;&quot;meaning&quot;&nbsp;of&nbsp;the&nbsp;composite&nbsp;is&nbsp;ambiguous:&nbsp;does&nbsp;a&nbsp;2-d&nbsp;overlay&nbsp;select&nbsp;a&nbsp;plane&nbsp;in&nbsp;a&nbsp;3-d&nbsp;space&nbsp;or&nbsp;does&nbsp;it&nbsp;project&nbsp;through&nbsp;all&nbsp;of&nbsp;the&nbsp;planes?&nbsp;So&nbsp;part&nbsp;of&nbsp;the&nbsp;problem&nbsp;with&nbsp;the&nbsp;overlays&nbsp;as&nbsp;I&nbsp;wrote&nbsp;them&nbsp;was&nbsp;that&nbsp;they&nbsp;only&nbsp;handled&nbsp;the&nbsp;trivial&nbsp;case&nbsp;and&nbsp;they&nbsp;made&nbsp;assumptions&nbsp;about&nbsp;the&nbsp;user&#39;s&nbsp;intent&nbsp;when&nbsp;mapping&nbsp;onto&nbsp;higher-dimension&nbsp;spaces.&lt;div&nbsp;class=&quot;im&quot;&gt;<br>
<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
We&nbsp;could&nbsp;make&nbsp;and(),&nbsp;or(),&nbsp;not(),&nbsp;etc.&nbsp;check&nbsp;that&nbsp;the&nbsp;referenced&nbsp;overlay&nbsp;is&nbsp;compatible&nbsp;with&nbsp;the&nbsp;current&nbsp;definition.&nbsp;But&nbsp;before&nbsp;I&nbsp;write&nbsp;a&nbsp;bunch&nbsp;of&nbsp;code&nbsp;I&#39;d&nbsp;like&nbsp;to&nbsp;see&nbsp;what&nbsp;you&nbsp;guys&nbsp;think&nbsp;the&nbsp;best&nbsp;approach&nbsp;is.&nbsp;Any&nbsp;suggestions?&lt;br&gt;<br>
<br>
<br>
&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;br&gt;&lt;/div&gt;<br>
In&nbsp;Barcelona,&nbsp;we&nbsp;talked&nbsp;briefly&nbsp;about&nbsp;strategies&nbsp;for&nbsp;melding&nbsp;objects&nbsp;in&nbsp;different&nbsp;spaces&nbsp;using&nbsp;space-space&nbsp;mappings&nbsp;to&nbsp;project&nbsp;everything&nbsp;into&nbsp;a&nbsp;common&nbsp;space.&nbsp;That&#39;s&nbsp;useful&nbsp;not&nbsp;only&nbsp;for&nbsp;overlays,&nbsp;but&nbsp;for&nbsp;multi-image&nbsp;alignment&nbsp;and&nbsp;other&nbsp;problems.&nbsp;My&nbsp;gut&nbsp;reaction&nbsp;is&nbsp;that&nbsp;this&nbsp;is&nbsp;another&nbsp;flavor&nbsp;of&nbsp;the&nbsp;same&nbsp;problem.&nbsp;When&nbsp;creating&nbsp;a&nbsp;composite,&nbsp;you&nbsp;need&nbsp;both&nbsp;the&nbsp;overlay&nbsp;and&nbsp;a&nbsp;mapping&nbsp;object&nbsp;that&nbsp;translates&nbsp;the&nbsp;coordinates&nbsp;of&nbsp;the&nbsp;composite&nbsp;space&nbsp;into&nbsp;those&nbsp;of&nbsp;the&nbsp;overlay&nbsp;space&nbsp;(or&nbsp;that&nbsp;executes&nbsp;an&nbsp;out-of-bounds&nbsp;strategy&nbsp;for&nbsp;coordinates&nbsp;that&nbsp;don&#39;t&nbsp;map).&nbsp;We&nbsp;talked&nbsp;about&nbsp;drawing&nbsp;overlays&nbsp;in&nbsp;a&nbsp;3-d&nbsp;viewer&nbsp;where&nbsp;the&nbsp;view&nbsp;plane&nbsp;might&nbsp;not&nbsp;be&nbsp;X-Y&nbsp;plane&nbsp;-&nbsp;there,&nbsp;the&nbsp;space-space&nbsp;mapping&nbsp;lets&nbsp;you&nbsp;rotate&nbsp;our&nbsp;2-d&nbsp;overlays&nbsp;in&nbsp;the&nbsp;3-d&nbsp;space.&lt;br&gt;<br>
<br>
<br>
&lt;br&gt;<br>
I&nbsp;think&nbsp;there&#39;s&nbsp;a&nbsp;lot&nbsp;of&nbsp;value&nbsp;in&nbsp;making&nbsp;the&nbsp;composite&nbsp;manage&nbsp;individual&nbsp;overlays.&nbsp;I&nbsp;have&nbsp;a&nbsp;feeling&nbsp;people&nbsp;will&nbsp;want&nbsp;to&nbsp;ungroup&nbsp;the&nbsp;composites&nbsp;and&nbsp;adjust&nbsp;the&nbsp;individual&nbsp;shapes,&nbsp;then&nbsp;group&nbsp;them&nbsp;again.&nbsp;I&#39;m&nbsp;also&nbsp;guessing&nbsp;that&nbsp;people&nbsp;might&nbsp;want&nbsp;each&nbsp;of&nbsp;the&nbsp;sub-objects&nbsp;to&nbsp;have&nbsp;its&nbsp;own&nbsp;line&nbsp;and&nbsp;fill.&lt;br&gt;<br>
<br>
<br>
&lt;br&gt;<br>
Pragmatically,&nbsp;it&#39;s&nbsp;possible&nbsp;to&nbsp;take&nbsp;baby&nbsp;steps.&nbsp;You&nbsp;could&nbsp;create&nbsp;a&nbsp;single&nbsp;identity&nbsp;mapping&nbsp;and&nbsp;have&nbsp;the&nbsp;current&nbsp;code&nbsp;either&nbsp;throw&nbsp;an&nbsp;exception&nbsp;if&nbsp;axes&nbsp;didn&#39;t&nbsp;match&nbsp;or&nbsp;use&nbsp;the&nbsp;identity&nbsp;mapping&nbsp;if&nbsp;they&nbsp;did.&nbsp;Then,&nbsp;you&nbsp;could&nbsp;add&nbsp;different&nbsp;flavors&nbsp;of&nbsp;and(),&nbsp;or()...&nbsp;to&nbsp;take&nbsp;both&nbsp;an&nbsp;overlay&nbsp;and&nbsp;a&nbsp;mapping.&nbsp;The&nbsp;mappings&nbsp;themselves&nbsp;would&nbsp;need&nbsp;to&nbsp;be&nbsp;serializable&nbsp;and&nbsp;the&nbsp;serialization&nbsp;of&nbsp;the&nbsp;composite&nbsp;would&nbsp;wrap&nbsp;the&nbsp;serializations&nbsp;of&nbsp;the&nbsp;overlay&nbsp;/&nbsp;mapping&nbsp;pairs.&lt;br&gt;<br>
<br>
<br>
&lt;br&gt;<br>
Hope&nbsp;this&nbsp;helps,&lt;br&gt;<br>
--Lee&lt;br&gt;<br>
&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
