<tt>
Hi&nbsp;everyone,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Today&nbsp;Barry&nbsp;and&nbsp;I&nbsp;had&nbsp;a&nbsp;brief&nbsp;meeting&nbsp;about&nbsp;the&nbsp;ImageJ2&nbsp;menuing&nbsp;system.&nbsp;(For&nbsp;a&nbsp;brief&nbsp;description&nbsp;of&nbsp;how&nbsp;it&nbsp;works,&nbsp;I&nbsp;posted&nbsp;a&nbsp;write-up&nbsp;on&nbsp;the&nbsp;ImageJ2&nbsp;site&nbsp;at: &lt;a&nbsp;href=&quot;http://developer.imagej.net/menuing-system&quot;&gt;http://developer.imagej.net/menuing-system&lt;/a&gt;).&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;There&nbsp;are&nbsp;currently&nbsp;three&nbsp;issues&nbsp;with&nbsp;it:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;1)&nbsp;Correctness.&nbsp;There&nbsp;are&nbsp;currently&nbsp;bugs&nbsp;syncing&nbsp;multiple&nbsp;copies&nbsp;of&nbsp;a&nbsp;menu&nbsp;bar&nbsp;linked&nbsp;to&nbsp;the&nbsp;same&nbsp;ShadowMenu,&nbsp;as&nbsp;well&nbsp;as&nbsp;with&nbsp;checkbox&nbsp;menu&nbsp;items;&nbsp;see&nbsp;&lt;a&nbsp;href=&quot;http://trac.imagej.net/ticket/1162&quot;&gt;http://trac.imagej.net/ticket/1162&lt;/a&gt;&nbsp;for&nbsp;details.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;2)&nbsp;Performance.&nbsp;Currently,&nbsp;on&nbsp;Mac&nbsp;OS&nbsp;X,&nbsp;we&nbsp;maintain&nbsp;one&nbsp;copy&nbsp;of&nbsp;the&nbsp;menus&nbsp;(i.e.,&nbsp;one&nbsp;JMenuBar)&nbsp;per&nbsp;UI&nbsp;window.&nbsp;Constructing&nbsp;these&nbsp;copies&nbsp;is&nbsp;slow&nbsp;enough&nbsp;that&nbsp;there&nbsp;is&nbsp;a&nbsp;noticeable&nbsp;delay&nbsp;when&nbsp;a&nbsp;new&nbsp;image&nbsp;window&nbsp;pops&nbsp;up.&nbsp;We&nbsp;have&nbsp;a&nbsp;potential&nbsp;solution&nbsp;using&nbsp;the&nbsp;Application&nbsp;default&nbsp;menu&nbsp;bar&nbsp;(see&nbsp;&lt;a&nbsp;href=&quot;http://trac.imagej.net/ticket/1161&quot;&gt;http://trac.imagej.net/ticket/1161&lt;/a&gt;)&nbsp;on&nbsp;the&nbsp;fix-menus&nbsp;branch,&nbsp;which&nbsp;avoids&nbsp;making&nbsp;these&nbsp;copies.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;3)&nbsp;Capabilities.&nbsp;The&nbsp;current&nbsp;philosophy&nbsp;is&nbsp;that&nbsp;each&nbsp;menu&nbsp;root&nbsp;exists&nbsp;only&nbsp;once&nbsp;with&nbsp;all&nbsp;of&nbsp;its&nbsp;state,&nbsp;including&nbsp;which&nbsp;menu&nbsp;items&nbsp;are&nbsp;checked,&nbsp;grayed&nbsp;out,&nbsp;etc.&nbsp;This&nbsp;could&nbsp;be&nbsp;a&nbsp;problem&nbsp;in&nbsp;certain&nbsp;circumstances,&nbsp;if&nbsp;the&nbsp;menu&nbsp;is&nbsp;supposed&nbsp;to&nbsp;reflect&nbsp;a&nbsp;different&nbsp;context&nbsp;per&nbsp;image,&nbsp;per&nbsp;script&nbsp;editor&nbsp;window,&nbsp;etc.&nbsp;For&nbsp;example,&nbsp;if&nbsp;the&nbsp;Image&nbsp;&gt;&nbsp;Type&nbsp;&gt;&nbsp;8-bit&nbsp;menu&nbsp;item&nbsp;is&nbsp;supposed&nbsp;to&nbsp;be&nbsp;checked&nbsp;for&nbsp;an&nbsp;8-bit&nbsp;image,&nbsp;but&nbsp;the&nbsp;16-bit&nbsp;menu&nbsp;item&nbsp;should&nbsp;be&nbsp;checked&nbsp;for&nbsp;a&nbsp;16-bit&nbsp;image,&nbsp;only&nbsp;one&nbsp;of&nbsp;those&nbsp;items&nbsp;will&nbsp;*really*&nbsp;be&nbsp;checked&nbsp;at&nbsp;any&nbsp;given&nbsp;time.&nbsp;Something&nbsp;(in&nbsp;this&nbsp;case,&nbsp;the&nbsp;TypeChangeService)&nbsp;must&nbsp;react&nbsp;to&nbsp;the&nbsp;active&nbsp;image&nbsp;being&nbsp;changed,&nbsp;updating&nbsp;the&nbsp;selection&nbsp;state&nbsp;for&nbsp;the&nbsp;modules&nbsp;in&nbsp;the&nbsp;Image&nbsp;&gt;&nbsp;Type&nbsp;menu,&nbsp;and&nbsp;then&nbsp;*all*&nbsp;copies&nbsp;of&nbsp;the&nbsp;menu&nbsp;change&nbsp;over&nbsp;accordingly.&nbsp;For&nbsp;non-top-level&nbsp;menu&nbsp;items,&nbsp;the&nbsp;user&nbsp;is&nbsp;blissfully&nbsp;ignorant&nbsp;of&nbsp;this&nbsp;process,&nbsp;but&nbsp;they&nbsp;would&nbsp;notice&nbsp;if&nbsp;e.g.&nbsp;a&nbsp;top-level&nbsp;menu&nbsp;item&nbsp;needed&nbsp;to&nbsp;be&nbsp;enabled&nbsp;or&nbsp;disabled&nbsp;based&nbsp;on&nbsp;the&nbsp;current&nbsp;context.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Barry&nbsp;&amp;&nbsp;I&nbsp;agreed&nbsp;that&nbsp;solving&nbsp;issue&nbsp;#2&nbsp;above&nbsp;is&nbsp;good&nbsp;enough&nbsp;for&nbsp;beta3,&nbsp;especially&nbsp;since&nbsp;it&nbsp;&quot;papers&nbsp;over&quot;&nbsp;the&nbsp;main&nbsp;issues&nbsp;with&nbsp;#1.&nbsp;That&nbsp;is,&nbsp;by&nbsp;avoiding&nbsp;clones&nbsp;of&nbsp;the&nbsp;menu&nbsp;bar,&nbsp;it&nbsp;matters&nbsp;less&nbsp;whether&nbsp;syncing&nbsp;between&nbsp;copies&nbsp;of&nbsp;the&nbsp;menu&nbsp;is&nbsp;working&nbsp;completely&nbsp;correctly—because&nbsp;we&nbsp;won&#39;t&nbsp;ever&nbsp;have&nbsp;copies&nbsp;of&nbsp;the&nbsp;menu&nbsp;to&nbsp;sync.&nbsp;But&nbsp;at&nbsp;some&nbsp;point,&nbsp;we&nbsp;should&nbsp;reconsider&nbsp;the&nbsp;issues&nbsp;mentioned&nbsp;in&nbsp;#3&nbsp;above,&nbsp;and&nbsp;decide&nbsp;on&nbsp;whether&nbsp;the&nbsp;current&nbsp;approach&nbsp;is&nbsp;sufficient&nbsp;for&nbsp;everyone&#39;s&nbsp;needs.&nbsp;Two&nbsp;good&nbsp;candidates&nbsp;for&nbsp;testing&nbsp;the&nbsp;limits&nbsp;of&nbsp;the&nbsp;menuing&nbsp;system&nbsp;are&nbsp;the&nbsp;script&nbsp;editor,&nbsp;and&nbsp;context&nbsp;(i.e.,&nbsp;right-click)&nbsp;menus.&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards,&lt;/div&gt;&lt;div&gt;Curtis&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
