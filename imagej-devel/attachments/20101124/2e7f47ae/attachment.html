<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&lt;head&gt;<br>
<br>
&lt;meta&nbsp;http-equiv=&quot;content-type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=ISO-8859-1&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;bgcolor=&quot;#ffffff&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
I&nbsp;also&nbsp;just&nbsp;sent&nbsp;this&nbsp;to&nbsp;ImageJX,&nbsp;forgot&nbsp;to&nbsp;cc:&nbsp;them&nbsp;originally.&lt;br&gt;<br>
&lt;br&gt;<br>
--------&nbsp;Original&nbsp;Message&nbsp;--------<br>
&lt;table&nbsp;class=&quot;moz-email-headers-table&quot;&nbsp;border=&quot;0&quot;&nbsp;cellpadding=&quot;0&quot;<br>
&nbsp;cellspacing=&quot;0&quot;&gt;<br>
&nbsp;&nbsp;&lt;tbody&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&nbsp;align=&quot;RIGHT&quot;&nbsp;nowrap=&quot;nowrap&quot;&nbsp;valign=&quot;BASELINE&quot;&gt;Subject:&nbsp;&lt;/th&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;IJ2&nbsp;Plugin&nbsp;Proposal&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&nbsp;align=&quot;RIGHT&quot;&nbsp;nowrap=&quot;nowrap&quot;&nbsp;valign=&quot;BASELINE&quot;&gt;Date:&nbsp;&lt;/th&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;Wed,&nbsp;24&nbsp;Nov&nbsp;2010&nbsp;15:16:14&nbsp;-0600&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&nbsp;align=&quot;RIGHT&quot;&nbsp;nowrap=&quot;nowrap&quot;&nbsp;valign=&quot;BASELINE&quot;&gt;From:&nbsp;&lt;/th&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;Aivar&nbsp;Grislis&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:grislis@wisc.edu&quot;&gt;&amp;lt;grislis@wisc.edu&amp;gt;&lt;/a&gt;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th&nbsp;align=&quot;RIGHT&quot;&nbsp;nowrap=&quot;nowrap&quot;&nbsp;valign=&quot;BASELINE&quot;&gt;To:&nbsp;&lt;/th&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td&gt;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:imagej-devel@imagejdev.org&quot;&gt;imagej-devel@imagejdev.org&lt;/a&gt;&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br>
&nbsp;&nbsp;&lt;/tbody&gt;<br>
&lt;/table&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;pre&gt;I'm&nbsp;proposing&nbsp;a&nbsp;more&nbsp;dynamic&nbsp;way&nbsp;of&nbsp;running&nbsp;plugins&nbsp;and&nbsp;sending&nbsp;images&nbsp;<br>
from&nbsp;one&nbsp;plugin&nbsp;to&nbsp;another&nbsp;that&nbsp;would&nbsp;lend&nbsp;itself&nbsp;to&nbsp;workflows&nbsp;and&nbsp;<br>
pipelines.&nbsp;&nbsp;This&nbsp;could&nbsp;also&nbsp;be&nbsp;used&nbsp;within&nbsp;plugins&nbsp;and&nbsp;within&nbsp;IJ2&nbsp;as&nbsp;an&nbsp;<br>
architectural&nbsp;building&nbsp;block&nbsp;to&nbsp;chain&nbsp;chunks&nbsp;of&nbsp;image&nbsp;processing&nbsp;code&nbsp;<br>
together.<br>
<br>
Basically&nbsp;I&nbsp;propose&nbsp;that&nbsp;a&nbsp;plugin&nbsp;can&nbsp;have&nbsp;multiple&nbsp;named&nbsp;input&nbsp;and&nbsp;<br>
output&nbsp;images&nbsp;and&nbsp;that&nbsp;whenever&nbsp;an&nbsp;output&nbsp;image&nbsp;is&nbsp;ready&nbsp;it&nbsp;is&nbsp;passed&nbsp;on&nbsp;<br>
to&nbsp;become&nbsp;the&nbsp;input&nbsp;image&nbsp;to&nbsp;the&nbsp;next&nbsp;plugin&nbsp;in&nbsp;the&nbsp;chain.<br>
<br>
IMPETUS<br>
<br>
I&nbsp;feel&nbsp;the&nbsp;need&nbsp;for&nbsp;this&nbsp;from&nbsp;a&nbsp;couple&nbsp;of&nbsp;plugins&nbsp;I&nbsp;have&nbsp;worked&nbsp;on&nbsp;<br>
(actually&nbsp;my&nbsp;only&nbsp;plugins!).<br>
<br>
I&nbsp;worked&nbsp;on&nbsp;a&nbsp;Deep&nbsp;Zoom&nbsp;plugin.&nbsp;&nbsp;This&nbsp;takes&nbsp;a&nbsp;huge&nbsp;image,&nbsp;tiles&nbsp;it,&nbsp;then&nbsp;<br>
the&nbsp;tiles&nbsp;are&nbsp;written&nbsp;out&nbsp;in&nbsp;a&nbsp;particular&nbsp;directory/file&nbsp;name&nbsp;<br>
structure.&nbsp;&nbsp;Next&nbsp;we&nbsp;halve&nbsp;the&nbsp;original&nbsp;image&nbsp;and&nbsp;repeat,&nbsp;until&nbsp;the&nbsp;image&nbsp;<br>
gets&nbsp;halved&nbsp;to&nbsp;a&nbsp;miniscule&nbsp;size.<br>
<br>
While&nbsp;working&nbsp;on&nbsp;this&nbsp;plugin&nbsp;I&nbsp;thought&nbsp;about&nbsp;writing&nbsp;the&nbsp;code&nbsp;to&nbsp;halve&nbsp;<br>
the&nbsp;image&nbsp;and&nbsp;to&nbsp;tile&nbsp;it&nbsp;in&nbsp;the&nbsp;most&nbsp;general-purpose,&nbsp;reusable&nbsp;way.&nbsp;&nbsp;<br>
Also&nbsp;I&nbsp;wanted&nbsp;to&nbsp;be&nbsp;memory-efficient:&nbsp;I&nbsp;didn't&nbsp;want&nbsp;to&nbsp;just&nbsp;make&nbsp;all&nbsp;the&nbsp;<br>
halves,&nbsp;then&nbsp;go&nbsp;through&nbsp;them&nbsp;and&nbsp;make&nbsp;all&nbsp;the&nbsp;tiles,&nbsp;then&nbsp;go&nbsp;throughout&nbsp;<br>
those&nbsp;and&nbsp;write&nbsp;out&nbsp;all&nbsp;the&nbsp;files.<br>
<br>
What&nbsp;I&nbsp;came&nbsp;up&nbsp;with&nbsp;at&nbsp;that&nbsp;time&nbsp;was&nbsp;a&nbsp;chainable&nbsp;plugin.&nbsp;&nbsp;In&nbsp;pseudo-code:<br>
<br>
interface&nbsp;IChainablePlugin&nbsp;{<br>
<br>
&nbsp;&nbsp;//&nbsp;chains&nbsp;one&nbsp;plugin&nbsp;to&nbsp;next;&nbsp;called&nbsp;from&nbsp;outside&nbsp;the&nbsp;plugin<br>
&nbsp;&nbsp;public&nbsp;chain(IChainablePlugin&nbsp;plugin);<br>
<br>
&nbsp;&nbsp;//&nbsp;gets&nbsp;the&nbsp;input&nbsp;image;&nbsp;called&nbsp;from&nbsp;within&nbsp;plugin<br>
&nbsp;&nbsp;Image&nbsp;get();<br>
<br>
&nbsp;&nbsp;//&nbsp;puts&nbsp;the&nbsp;output&nbsp;image;&nbsp;called&nbsp;from&nbsp;within&nbsp;plugin<br>
&nbsp;&nbsp;put(Image&nbsp;image);<br>
}<br>
<br>
An&nbsp;abstract&nbsp;base&nbsp;class&nbsp;kept&nbsp;track&nbsp;of&nbsp;the&nbsp;next,&nbsp;chained&nbsp;plugin&nbsp;instance&nbsp;<br>
and&nbsp;handed&nbsp;off&nbsp;the&nbsp;output&nbsp;image&nbsp;to&nbsp;that&nbsp;next&nbsp;plugin,&nbsp;using&nbsp;the&nbsp;same&nbsp;thread.<br>
<br>
I&nbsp;wrote&nbsp;a&nbsp;chainable&nbsp;plugin&nbsp;class&nbsp;to&nbsp;halve&nbsp;the&nbsp;image,&nbsp;one&nbsp;to&nbsp;tile&nbsp;it,&nbsp;and&nbsp;<br>
had&nbsp;a&nbsp;third&nbsp;one&nbsp;that&nbsp;was&nbsp;just&nbsp;an&nbsp;inner&nbsp;class&nbsp;to&nbsp;my&nbsp;Deep&nbsp;Zoom&nbsp;plugin&nbsp;that&nbsp;<br>
handled&nbsp;the&nbsp;specifics&nbsp;of&nbsp;writing&nbsp;out&nbsp;the&nbsp;tiled&nbsp;image&nbsp;files.&nbsp;&nbsp;Presumably&nbsp;<br>
the&nbsp;first&nbsp;two&nbsp;classes&nbsp;would&nbsp;be&nbsp;reusable&nbsp;code&nbsp;and&nbsp;the&nbsp;third&nbsp;was&nbsp;just&nbsp;<br>
specific&nbsp;to&nbsp;Deep&nbsp;Zoom.<br>
<br>
Obviously&nbsp;as-is&nbsp;this&nbsp;is&nbsp;limited&nbsp;to&nbsp;one&nbsp;input&nbsp;and&nbsp;one&nbsp;output.&nbsp;&nbsp;I&nbsp;started&nbsp;<br>
thinking&nbsp;about&nbsp;having&nbsp;an&nbsp;image&nbsp;dispatcher&nbsp;class&nbsp;that&nbsp;would&nbsp;keep&nbsp;track&nbsp;of&nbsp;<br>
which&nbsp;images&nbsp;a&nbsp;plugin&nbsp;required&nbsp;and&nbsp;hand&nbsp;them&nbsp;off&nbsp;from&nbsp;one&nbsp;plugin&nbsp;to&nbsp;another.<br>
<br>
I'll&nbsp;just&nbsp;briefly&nbsp;mention&nbsp;the&nbsp;SLIM&nbsp;plugin&nbsp;I&nbsp;am&nbsp;working&nbsp;on.&nbsp;&nbsp;Since&nbsp;the&nbsp;<br>
SLIM&nbsp;fitting&nbsp;process&nbsp;is&nbsp;time&nbsp;consuming&nbsp;I&nbsp;display&nbsp;a&nbsp;very&nbsp;coarse&nbsp;colorized&nbsp;<br>
version&nbsp;of&nbsp;the&nbsp;fitted&nbsp;results&nbsp;that&nbsp;is&nbsp;refined&nbsp;as&nbsp;the&nbsp;fit&nbsp;progresses.&nbsp;&nbsp;So&nbsp;<br>
there&nbsp;I&nbsp;want&nbsp;to&nbsp;pass&nbsp;on&nbsp;my&nbsp;output&nbsp;image&nbsp;before&nbsp;the&nbsp;plugin&nbsp;finishes&nbsp;and&nbsp;I&nbsp;<br>
want&nbsp;to&nbsp;put&nbsp;out&nbsp;successive&nbsp;versions&nbsp;of&nbsp;this&nbsp;image.&nbsp;&nbsp;This&nbsp;is&nbsp;similar&nbsp;to&nbsp;<br>
my&nbsp;wanting&nbsp;to&nbsp;process&nbsp;the&nbsp;individual&nbsp;tiles&nbsp;before&nbsp;the&nbsp;whole&nbsp;image&nbsp;is&nbsp;tiled.<br>
<br>
PROPOSAL<br>
<br>
We&nbsp;could&nbsp;label&nbsp;the&nbsp;input&nbsp;and&nbsp;output&nbsp;images&nbsp;using&nbsp;Java&nbsp;annotations.&nbsp;&nbsp;<br>
(Note&nbsp;that&nbsp;the&nbsp;current&nbsp;Declarative&nbsp;Plugin&nbsp;annotations&nbsp;allow&nbsp;one&nbsp;to&nbsp;label&nbsp;<br>
input&nbsp;and&nbsp;output&nbsp;image&nbsp;member&nbsp;variables&nbsp;but&nbsp;the&nbsp;outputs&nbsp;are&nbsp;harvested&nbsp;<br>
only&nbsp;once&nbsp;the&nbsp;plugin&nbsp;is&nbsp;finished.&nbsp;There&nbsp;is&nbsp;no&nbsp;way&nbsp;to&nbsp;put&nbsp;out&nbsp;an&nbsp;output&nbsp;<br>
image&nbsp;within&nbsp;the&nbsp;plugin&nbsp;code.)<br>
<br>
Here&nbsp;is&nbsp;some&nbsp;sample&nbsp;code&nbsp;for&nbsp;what&nbsp;I'm&nbsp;proposing:<br>
<br>
&quot;@Input<br>
@Output({&nbsp;@Img(Plugin1.BLUE),&nbsp;@Img(Plugin1.GREEN)&nbsp;})<br>
public&nbsp;class&nbsp;Plugin1&nbsp;extends&nbsp;AbstractPlugin&nbsp;{<br>
&nbsp;&nbsp;public&nbsp;static&nbsp;final&nbsp;String&nbsp;BLUE&nbsp;=&nbsp;&quot;Blue&quot;;<br>
&nbsp;&nbsp;public&nbsp;static&nbsp;final&nbsp;String&nbsp;GREEN&nbsp;=&nbsp;&quot;Green&quot;;<br>
<br>
&nbsp;&nbsp;void&nbsp;process()&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Image&nbsp;image&nbsp;=&nbsp;get();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;put(BLUE,&nbsp;image);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;put(GREEN,&nbsp;image);<br>
&nbsp;&nbsp;}<br>
}&quot;<br>
<br>
Here&nbsp;the&nbsp;annotations&nbsp;result&nbsp;in&nbsp;an&nbsp;input&nbsp;name&nbsp;set&nbsp;of&nbsp;[&quot;Default&quot;]&nbsp;and&nbsp;an&nbsp;<br>
output&nbsp;set&nbsp;of&nbsp;[&quot;Blue&quot;,&quot;Green&quot;].&nbsp;&nbsp;(If&nbsp;there&nbsp;are&nbsp;no&nbsp;parameters&nbsp;the&nbsp;default&nbsp;<br>
name&nbsp;is&nbsp;used.)&nbsp;&nbsp;Of&nbsp;course,&nbsp;there&nbsp;could&nbsp;also&nbsp;be&nbsp;named&nbsp;input&nbsp;images&nbsp;(i.e.&nbsp;<br>
&quot;get(ORANGE)&quot;)&nbsp;or&nbsp;default&nbsp;output&nbsp;images&nbsp;(i.e.&nbsp;&quot;put()&quot;).<br>
<br>
Instances&nbsp;of&nbsp;plugins&nbsp;such&nbsp;as&nbsp;these&nbsp;could&nbsp;be&nbsp;chained&nbsp;together:<br>
&nbsp;&nbsp;plugin1.chain(Plugin1.BLUE,&nbsp;plugin2);&nbsp;&nbsp;//&nbsp;named&nbsp;output&nbsp;goes&nbsp;to&nbsp;<br>
default&nbsp;input<br>
&nbsp;&nbsp;plugin1.chain(Plugin1.GREEN,&nbsp;plugin2,&nbsp;Plugin2.ORANGE);&nbsp;//&nbsp;named&nbsp;<br>
output&nbsp;goes&nbsp;to&nbsp;named&nbsp;input<br>
&nbsp;&nbsp;plugin2.chain(plugin3);&nbsp;//&nbsp;default&nbsp;output&nbsp;goes&nbsp;to&nbsp;default&nbsp;input<br>
&nbsp;&nbsp;plugin2.chain(plugin4,&nbsp;Plugin4.PURPLE);&nbsp;//&nbsp;default&nbsp;output&nbsp;goes&nbsp;to&nbsp;<br>
named&nbsp;input<br>
<br>
Using&nbsp;strings&nbsp;as&nbsp;identifiers&nbsp;might&nbsp;seem&nbsp;less&nbsp;than&nbsp;ideal.&nbsp;&nbsp;However,&nbsp;the&nbsp;<br>
strings&nbsp;are&nbsp;unique&nbsp;to&nbsp;the&nbsp;plugin&nbsp;they&nbsp;belong&nbsp;to.&nbsp;&nbsp;If&nbsp;they&nbsp;are&nbsp;specified&nbsp;<br>
as&nbsp;static&nbsp;constants,&nbsp;as&nbsp;above,&nbsp;that&nbsp;would&nbsp;prevent&nbsp;spelling&nbsp;mismatches.&nbsp;&nbsp;<br>
Once&nbsp;a&nbsp;chain&nbsp;of&nbsp;plugins&nbsp;is&nbsp;established&nbsp;and&nbsp;before&nbsp;we&nbsp;run&nbsp;it&nbsp;we&nbsp;could&nbsp;<br>
make&nbsp;sure&nbsp;that&nbsp;all&nbsp;of&nbsp;the&nbsp;inputs&nbsp;have&nbsp;been&nbsp;chained&nbsp;to.&nbsp;&nbsp;We&nbsp;can&nbsp;detect&nbsp;if&nbsp;<br>
a&nbsp;plugin&nbsp;asks&nbsp;for&nbsp;an&nbsp;input&nbsp;or&nbsp;output&nbsp;that&nbsp;has&nbsp;not&nbsp;been&nbsp;annotated&nbsp;and&nbsp;<br>
warn&nbsp;the&nbsp;plugin&nbsp;programmer.<br>
<br>
Of&nbsp;course,&nbsp;once&nbsp;we&nbsp;have&nbsp;named&nbsp;input&nbsp;and&nbsp;output&nbsp;images&nbsp;we&nbsp;could&nbsp;build&nbsp;on&nbsp;<br>
that&nbsp;and&nbsp;give&nbsp;the&nbsp;IJ&nbsp;end-user&nbsp;ways&nbsp;to&nbsp;link&nbsp;up&nbsp;plugins&nbsp;in&nbsp;workflows&nbsp;or&nbsp;<br>
pipelines,&nbsp;a&nbsp;la&nbsp;CellProfiler.<br>
<br>
I&nbsp;have&nbsp;a&nbsp;prototype&nbsp;implementation&nbsp;of&nbsp;this,&nbsp;so&nbsp;the&nbsp;sample&nbsp;code&nbsp;above&nbsp;<br>
works,&nbsp;details&nbsp;upon&nbsp;request.<br>
<br>
Aivar<br>
<br>
(P.S.&nbsp;It's&nbsp;the&nbsp;Thanksgiving&nbsp;holiday&nbsp;in&nbsp;the&nbsp;U.S.&nbsp;so&nbsp;you&nbsp;might&nbsp;not&nbsp;hear&nbsp;<br>
from&nbsp;us&nbsp;until&nbsp;Monday.&nbsp;&nbsp;Happy&nbsp;Thanksgiving!)<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;/pre&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
