<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [ImageJ-devel] [fiji-devel] Re:  New imglib2-algorithms-legacy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:imagej-devel%40imagej.net?Subject=Re%3A%20%5BImageJ-devel%5D%20%5Bfiji-devel%5D%20Re%3A%20%20New%20imglib2-algorithms-legacy&In-Reply-To=%3C002C3F27-B718-4072-8C90-0DC5F9A2419D%40mpi-cbg.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001054.html">
   <LINK REL="Next"  HREF="001056.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[ImageJ-devel] [fiji-devel] Re:  New imglib2-algorithms-legacy</H1>
    <B>Stephan Preibisch</B> 
    <A HREF="mailto:imagej-devel%40imagej.net?Subject=Re%3A%20%5BImageJ-devel%5D%20%5Bfiji-devel%5D%20Re%3A%20%20New%20imglib2-algorithms-legacy&In-Reply-To=%3C002C3F27-B718-4072-8C90-0DC5F9A2419D%40mpi-cbg.de%3E"
       TITLE="[ImageJ-devel] [fiji-devel] Re:  New imglib2-algorithms-legacy">preibisch at mpi-cbg.de
       </A><BR>
    <I>Tue Jul 10 13:28:25 CDT 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001054.html">[ImageJ-devel] [fiji-devel] Re:  New imglib2-algorithms-legacy
</A></li>
        <LI>Next message: <A HREF="001056.html">[ImageJ-devel] [fiji-devel] Re:  New imglib2-algorithms-legacy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1055">[ date ]</a>
              <a href="thread.html#1055">[ thread ]</a>
              <a href="subject.html#1055">[ subject ]</a>
              <a href="author.html#1055">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Johannes,

this is very useful, could you put maybe onto the Fiji wiki that when searching for &quot;Maven&quot; this would shop up? I guess I will know if I really got it once I try to make a new src-plugins plugin ...

It definitely made into my &quot;GIT &amp; Maven HowTo&quot; directory ...

Thanks a lot,
Steffi

On Jul 10, 2012, at 13:50 , Johannes Schindelin wrote:

&gt;<i> Hi Curtis,
</I>&gt;<i> 
</I>&gt;<i> On Tue, 10 Jul 2012, Curtis Rueden wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> On Tue, Jul 10, 2012 at 11:21 AM, Johannes Schindelin
</I>&gt;<i> &lt;
</I>&gt;&gt;<i> <A HREF="http://imagej.net/mailman/listinfo/imagej-devel">Johannes.Schindelin at gmx.de</A>&gt; wrote:
</I>&gt;&gt;&gt;<i> I will make a branch with a simple pom and will be on Skype later.
</I>&gt;&gt;&gt;<i> Fair ennough?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I have done this for imglib2-algorithms-legacy and pushed to master.
</I>&gt;<i> 
</I>&gt;<i> Darn, you beat me to it! ;-)
</I>&gt;<i> 
</I>&gt;<i> But that gives me more time to explain what it takes to make a new Maven
</I>&gt;<i> project.
</I>&gt;<i> 
</I>&gt;<i> All it really takes is a pom.xml file and a certain directory structure.
</I>&gt;<i> Technically, you can override the default directory layout in the pom.xml,
</I>&gt;<i> but why do so? It only breaks expectations and is more hassle than it is
</I>&gt;<i> worth, really.
</I>&gt;<i> 
</I>&gt;<i> So the directory structure is: you put your .java files under
</I>&gt;<i> src/main/java/ and the other files you need to be included into
</I>&gt;<i> src/main/resources/. Should you want to apply the best practices called
</I>&gt;<i> &quot;regression tests&quot; or even &quot;test-driven development&quot;: your tests' .java
</I>&gt;<i> files go to src/test/java/ and the non-.java files you might require
</I>&gt;<i> unsurprisingly into src/test/resources/.
</I>&gt;<i> 
</I>&gt;<i> So what does a pom.xml look like? This is a very simple example:
</I>&gt;<i> 
</I>&gt;<i> 	&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
</I>&gt;<i> 	&lt;project xmlns=&quot;<A HREF="http://maven.apache.org/POM/4.0.0">http://maven.apache.org/POM/4.0.0</A>&quot;
</I>&gt;<i> 			xmlns:xsi=&quot;<A HREF="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</A>&quot;
</I>&gt;<i> 			xsi:schemaLocation=&quot;<A HREF="http://maven.apache.org/POM/4.0.0">http://maven.apache.org/POM/4.0.0</A>
</I>&gt;<i> 			<A HREF="http://maven.apache.org/xsd/maven-4.0.0.xsd">http://maven.apache.org/xsd/maven-4.0.0.xsd</A>&quot;&gt;
</I>&gt;<i> 		&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
</I>&gt;<i> 
</I>&gt;<i> 		&lt;groupId&gt;sc.fiji&lt;/groupId&gt;
</I>&gt;<i> 		&lt;artifactId&gt;my-uber-library&lt;/artifactId&gt;
</I>&gt;<i> 		&lt;version&gt;2.0.0-SNAPSHOT&lt;/version&gt;
</I>&gt;<i> 	&lt;/project&gt;
</I>&gt;<i> 
</I>&gt;<i> The first 6 lines are of course just a way to say &quot;Hi, Maven? How are you
</I>&gt;<i> today? This is what I would like you to do:&quot;.
</I>&gt;<i> 
</I>&gt;<i> The only relevant parts are the groupId, which by convention is something
</I>&gt;<i> like the inverted domain name (similar to the Java package convention),
</I>&gt;<i> the name of the artifact to build (it will be put into target/, under the
</I>&gt;<i> name &lt;artifactId&gt;-&lt;version&gt;.jar). And of course the version.
</I>&gt;<i> 
</I>&gt;<i> Now, why did I bother so much with Mavenization of Fiji? The real reason
</I>&gt;<i> is that Maven is not only a build tool but first and foremost a dependency
</I>&gt;<i> management tool. Maven has so-called Maven repositories where it stores
</I>&gt;<i> compiled artifacts. ImageJ2's Maven repository lives here:
</I>&gt;<i> <A HREF="http://maven.imagej.net:8081/">http://maven.imagej.net:8081/</A> (most functions can be accessed via
</I>&gt;<i> <A HREF="http://maven.imagej.net/">http://maven.imagej.net/</A> just as well). It is like Fiji's precompiled/
</I>&gt;<i> directory, but done right.
</I>&gt;<i> 
</I>&gt;<i> Next, for Maven to know what you are looking for, you typically have to
</I>&gt;<i> add the dependencies into the pom.xml file. For example, every ImageJ 1.x
</I>&gt;<i> plugin will depend on ImageJ 1.x. So let's add that (before the final
</I>&gt;<i> &lt;/project&gt; line):
</I>&gt;<i> 
</I>&gt;<i> 	&lt;dependencies&gt;
</I>&gt;<i> 		&lt;dependency&gt;
</I>&gt;<i> 			&lt;groupId&gt;net.imagej&lt;/groupId&gt;
</I>&gt;<i> 			&lt;artifactId&gt;ij&lt;/artifactId&gt;
</I>&gt;<i> 			&lt;version&gt;1.45b&lt;/version&gt;
</I>&gt;<i> 		&lt;/dependency&gt;
</I>&gt;<i> 	&lt;/dependencies&gt;
</I>&gt;<i> 
</I>&gt;<i> As you can see, dependencies are referenced under the same groupId,
</I>&gt;<i> artifactId and version triplet (also known as GAV parameters) that you had
</I>&gt;<i> to declare for the current project.
</I>&gt;<i> 
</I>&gt;<i> For Maven to find the dependencies, it has to know about the location of
</I>&gt;<i> the repositories. As you know, we are strong proponents of collaboration
</I>&gt;<i> within the scientific community, so we started the scijava effort last
</I>&gt;<i> hackathon in December. To this end, Curtis began the scijava &quot;super POM&quot;
</I>&gt;<i> which is supposed to declare repositories we use (and other metadata as
</I>&gt;<i> well, such as current artifact versions we provide). To benefit from this
</I>&gt;<i> in your project, add this to your pom.xml:
</I>&gt;<i> 
</I>&gt;<i> 	&lt;parent&gt;
</I>&gt;<i> 		&lt;groupId&gt;org.scijava&lt;/groupId&gt;
</I>&gt;<i> 		&lt;artifactId&gt;pom-scijava&lt;/artifactId&gt;
</I>&gt;<i> 		&lt;version&gt;1.15&lt;/version&gt;
</I>&gt;<i> 	&lt;/parent&gt;
</I>&gt;<i> 
</I>&gt;<i> 	&lt;!-- NB: for project parent --&gt;
</I>&gt;<i> 	&lt;repositories&gt;
</I>&gt;<i> 		&lt;repository&gt;
</I>&gt;<i> 			&lt;id&gt;imagej.releases&lt;/id&gt;
</I>&gt;<i> 			&lt;url&gt;<A HREF="http://maven.imagej.net/content/repositories/releases&lt;/url">http://maven.imagej.net/content/repositories/releases&lt;/url</A>&gt;
</I>&gt;<i> 		&lt;/repository&gt;
</I>&gt;<i> 		&lt;repository&gt;
</I>&gt;<i> 			&lt;id&gt;imagej.snapshots&lt;/id&gt;
</I>&gt;<i> 			&lt;url&gt;<A HREF="http://maven.imagej.net/content/repositories/snapshots&lt;/url">http://maven.imagej.net/content/repositories/snapshots&lt;/url</A>&gt;
</I>&gt;<i> 		&lt;/repository&gt;
</I>&gt;<i> 	&lt;/repositories&gt;
</I>&gt;<i> 
</I>&gt;<i> You will see that there are two different repository types: releases and
</I>&gt;<i> snapshots. The snapshot versions are &quot;in-progress&quot; versions. If you
</I>&gt;<i> declare a dependency with a &quot;-SNAPSHOT&quot; suffix in the version, Maven will
</I>&gt;<i> look once a day for new artifacts of the same versions; otherwise, Maven
</I>&gt;<i> will look whether it has that version already and not bother
</I>&gt;<i> re-downloading.
</I>&gt;<i> 
</I>&gt;<i> So what if you have multiple .jar files you want to build in the same
</I>&gt;<i> project? Then these need to live in their own subdirectories and there
</I>&gt;<i> needs to be a common parent POM, a so-called &quot;aggregator&quot; POM. For an
</I>&gt;<i> example, look at Fiji's src-plugins/pom.xml. Basically, it is adding the
</I>&gt;<i> &lt;packaging&gt;pom&lt;/packaging&gt; entry as well as a couple of subdirectory names
</I>&gt;<i> to the &lt;modules&gt; section.
</I>&gt;<i> 
</I>&gt;<i> There are many more things you can do with Maven, but chances are you will
</I>&gt;<i> not need them.
</I>&gt;<i> 
</I>&gt;<i> The simplicity of the pom.xml you need comes from the fact that Maven
</I>&gt;<i> defines implicit defaults. It calls that &quot;convention over configuration&quot;.
</I>&gt;<i> But since we are not converting projects (or at least since we are
</I>&gt;<i> flexible enough to adapt), I would strongly recommend staying with the
</I>&gt;<i> defaults as much as possible. It also makes your project more accessible,
</I>&gt;<i> something that I think we excel at.
</I>&gt;<i> 
</I>&gt;<i> Now, in the context of scijava, you will most likely never write a pom.xml
</I>&gt;<i> from scratch. You will rather more likely edit an existing one, possibly
</I>&gt;<i> after having copied it.
</I>&gt;<i> 
</I>&gt;<i> Ciao,
</I>&gt;<i> Dscho
</I>

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001054.html">[ImageJ-devel] [fiji-devel] Re:  New imglib2-algorithms-legacy
</A></li>
	<LI>Next message: <A HREF="001056.html">[ImageJ-devel] [fiji-devel] Re:  New imglib2-algorithms-legacy
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1055">[ date ]</a>
              <a href="thread.html#1055">[ thread ]</a>
              <a href="subject.html#1055">[ subject ]</a>
              <a href="author.html#1055">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://imagej.net/mailman/listinfo/imagej-devel">More information about the ImageJ-devel
mailing list</a><br>
</body></html>
