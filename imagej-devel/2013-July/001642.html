<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [ImageJ-devel] Testing the HelloWorld Plugin
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:imagej-devel%40imagej.net?Subject=Re%3A%20%5BImageJ-devel%5D%20Testing%20the%20HelloWorld%20Plugin&In-Reply-To=%3Calpine.DEB.1.00.1307032017170.28957%40s15462909.onlinehome-server.info%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001678.html">
   <LINK REL="Next"  HREF="001644.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[ImageJ-devel] Testing the HelloWorld Plugin</H1>
    <B>Johannes Schindelin</B> 
    <A HREF="mailto:imagej-devel%40imagej.net?Subject=Re%3A%20%5BImageJ-devel%5D%20Testing%20the%20HelloWorld%20Plugin&In-Reply-To=%3Calpine.DEB.1.00.1307032017170.28957%40s15462909.onlinehome-server.info%3E"
       TITLE="[ImageJ-devel] Testing the HelloWorld Plugin">Johannes.Schindelin at gmx.de
       </A><BR>
    <I>Wed Jul  3 13:57:25 CDT 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="001678.html">[ImageJ-devel] cell-serialisation
</A></li>
        <LI>Next message: <A HREF="001644.html">[ImageJ-devel] Copy Plugin directly to Plugins folder.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1642">[ date ]</a>
              <a href="thread.html#1642">[ thread ]</a>
              <a href="subject.html#1642">[ subject ]</a>
              <a href="author.html#1642">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Mohamed,

On Wed, 3 Jul 2013, Mohamed Tleis wrote:

&gt;<i> On 07/02/2013 07:49 PM, Johannes Schindelin wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On Tue, 2 Jul 2013, Johannes Schindelin wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; On Tue, 2 Jul 2013, Mohamed Tleis wrote:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; I wanted to test the HelloWorld Plugin from the tutorials. I named
</I>&gt;<i> &gt; &gt; &gt; it HelloWorld_Plugin and copied the compiled class to the plugins
</I>&gt;<i> &gt; &gt; &gt; folder.  I have Hello World Plugin in the Plugins Menu now, but it
</I>&gt;<i> &gt; &gt; &gt; does nothing upon clicking.
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; [...]
</I>&gt;<i> &gt; &gt; &gt;
</I>&gt;<i> &gt; &gt; &gt; 2. Why Hello World dialog message doens't display upon accessing
</I>&gt;<i> &gt; &gt; &gt; from the menu?
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Did you have a look at the console output?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Just to make sure that nothing silly is happening, I did this (you
</I>&gt;<i> &gt; might want to explain in as much detail what you did in the future):
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 1) I made sure that my imagej-tutorials is up-to-date
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 2) I used Maven to build (this is by far the easiest thing to do):
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;  mvn
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;     You could use your development environment of choice (Eclipse,
</I>&gt;<i> &gt;     Netbeans, IntelliJ, etc) to build it, too.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 3) I copied the generated .jar file (which is called
</I>&gt;<i> &gt;     simple-command-1.0.0-SNAPSHOT.jar) from simple-command/target/ to my
</I>&gt;<i> &gt;     ImageJ.app/plugins/
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 4) I started ImageJ2 via ImageJ.app/ImageJ-linux64
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 5) I started the command launcher by hitting the 'L' key
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 6) I typed &quot;Hello&quot; in the search box
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 7) I called the &quot;Hello, World!&quot; plugin
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; It did show a message box, greeting the whole world. So basically I have
</I>&gt;<i> &gt; no clue what went wrong on your side, but I am sure we can find out
</I>&gt;<i> &gt; together if you provide every bit of useful information you can extract
</I>&gt;<i> &gt; from your trial.
</I>
FWIW in the future you could spare everyone reading your reply a couple of
minutes by culling the part from the quoted mail that you did not address
in your reply. If you think about the number of readers, multiply that by
those couple of minutes, you get the idea how much time you asked others
to spend on your mail. If you can spend less than that to reduce that
overall time, well, maybe you want to do that?

&gt;<i> I followed the exact steps as you did, and noticed the path of
</I>&gt;<i> HelloWorldPlugin is in the Help Menu. and it is working fine now,
</I>
Good.

&gt;<i> although I am wondering how to change the menu path.
</I>
As so often, the answer is in the source code. Asking the web browser to
search for &quot;Help&quot; in the page on GitHub found me this gem:

	<A HREF="https://github.com/imagej/imagej-tutorials/blob/master/simple-command/src/main/java/HelloWorldPlugin.java#L39">https://github.com/imagej/imagej-tutorials/blob/master/simple-command/src/main/java/HelloWorldPlugin.java#L39</A>

It is the &quot;menuPath&quot; attribute of the @Plugin annotation.

&gt;<i> Building the HelloWorldPlugin.java alone, and copying the
</I>&gt;<i> HelloWorldPlugin.class into the Plugins folder did nothing.
</I>
Yes. ImageJ2 does not support bare .class files in the plugins/ folder
(except insofar necessary for backwards-compatibility).

Allowing that encourages sloppy development, and it is all-too-easy for
infrequent programmers to forget the intricacies: the name must contain an
underscore, the class must be in the default package, or in a one-level
package and the file in a subdirectory, but not two-level package, or the
class must be in the default package and the file in a one-level
subdirectory of plugins/, but not in a two-level directory, etc.

Also, it was quite often the case that you got single .class files that
were missing crucial other .class files to run. A completely inefficient
and annoying back-and-forth had to ensue until everything was in place to
finally run the plugin. This is particularly true for .java files
defining more than one class. I am not talking about theoretical problems
here, have a look at famous plugins such as TurboReg.

Therefore, ImageJ2 only supports fully self-contained .jar files. They
contain everything that you need to run the plugin, can contain resources
such as icons, information that is put there at compile time, and a lot
more. Also, .jar files are much more space-efficient than unpacked .class
files will ever be.

And once you have more than two plugins in your plugins/ folder, it should
be a no-brainer to see that two .jar files are much easier to organize
than a couple of possibly-interrelated .class files, possibly scattered
over multiple directories (because you cannot import classes from the
default package).

&gt;<i> However compiling it as HelloWorld_Plugin.class did indeed show the
</I>&gt;<i> HelloWorld Plugin in the Plugins Menu but clicking it performs nothing,
</I>&gt;<i> and not even in the console output (by running ImageJ-linux64 from
</I>&gt;<i> terminal).
</I>
Well, ImageJ 1.x does not look at the contents of the .class file -- ever!
-- to determine whether it is a plugin or not. All it does is to look at
the underscore. If it is present, it must be a plugin, right?

And since ImageJ2 aims to be as backwards-compatible as possible, it
inherits that plugin via the legacy layer.

Now, there is some very, very obscure feature in ImageJ 1.x: if you have a
class whose name contains an underscore but which does not implement the
PlugInFilter nor the PlugIn interface, it is *still* constructed. In fact,
quite a few &quot;plugins&quot; use that feature to perform all their computation in
the constructor!

So ImageJ2 handed off to ImageJ 1.x in your case, which faithfully applied
that obscure feature and constructed the plugin. And that was that. It
just constructed it and then did nothing with it.

It is safe to say that this feature -- encouraging all the computation of
the plugin to happen in the constructor (which is intended to *initialize*
the plugin in preparation for the computation) -- contradicts pretty much
everything you will learn about object-oriented programming and best
practices, and for a very good reason: it opens a can of problems such as
the absence of proper error handling (there is only one way the plugin can
fail: it throws an exception, but of course from then on every internal
state of the plugin is lost!), the plugin's complete inability to
interact with the ImageJ core (once the constructor is done, it cannot
tell ImageJ what it did, and the plugin cannot do anything else from now
on), ImageJ's complete absence of knowledge what the plugin is expected to
do (Does it work on images? Does it create new windows? Is it supposed to
perform a computation?), basically every technique developed in the
object-oriented paradigm to help establishing a structure that helps
develop robust software, fast, cannot be applied.

Another problem it causes is that you cannot tell whether the plugin
did something or not because the constructor's purpose is to *prepare* the
plugin for execution, not to execute it.

Needless to say, it is not our intention to encourage such bad practices
(because after all, we will be stuck with helping scientists debug their
code which gets really boring really fast when the code makes exactly that
debugging hard).

Another rather big down-side of bare class files in plugins/ is that you
could not easily put it into a different location (for example, to
unclutter the already overloaded Plugins menu). Sure, you could put it
into a submenu of Plugins, but not, say, into Help. This is different with
ImageJ2 plugins where the @Plugin annotation determines the menuPath, but
it is easy to see how confused people would be if the menu location did
not change when they moved a .class into a subdirectory of plugins/, no?

Your case is probably the best demonstration for yet another reason why it
would be a bad idea to support ImageJ2 plugins as bare .class files in the
plugins/ directory: Due to above-mentioned obscure ImageJ 1.x' feature,
ImageJ2 would have to spend an substantial amount of time at startup to
determine whether it is an ImageJ2 or ImageJ1 plugin.

Let's keep things simple and easy instead: all ImageJ2 plugins require are
@Plugin annotations, and that they are bundled in .jar files. That's it.

Ciao,
Johannes

</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001678.html">[ImageJ-devel] cell-serialisation
</A></li>
	<LI>Next message: <A HREF="001644.html">[ImageJ-devel] Copy Plugin directly to Plugins folder.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1642">[ date ]</a>
              <a href="thread.html#1642">[ thread ]</a>
              <a href="subject.html#1642">[ subject ]</a>
              <a href="author.html#1642">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://imagej.net/mailman/listinfo/imagej-devel">More information about the ImageJ-devel
mailing list</a><br>
</body></html>
